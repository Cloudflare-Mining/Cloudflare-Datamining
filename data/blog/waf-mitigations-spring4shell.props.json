{
	"initialReadingTime": "1",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Michael Tremante",
				"slug": "michael-tremante",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/61VxyepuDMgPc2YC1SLjzq/9c78b998d374520b5ed7435b88659dc6/michael-tremante.jpg",
				"location": null,
				"website": null,
				"twitter": "@MichaelTremante",
				"facebook": null
			},
			{
				"name": "Himanshu Anand",
				"slug": "himanshu",
				"bio": "Making internet secure one bit at a time.",
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/5K3sXDpPy3yP7oGm32tCJi/2eeeefbf8114bae20ba4ab471c91a03a/himanshu.png",
				"location": null,
				"website": "https://himanshuanand.com",
				"twitter": "@anand_himanshu",
				"facebook": null
			}
		],
		"excerpt": "Cloudflare Managed Ruleset updates for the recent vulnerabilities affecting the Java Spring framework and related software components",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/Rxpi0npr9Ob2qVUZCZ7yX/98ed477315429f87e652d8afe7fd1e6b/waf-mitigations-spring4shell.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/60I8tBJ3ZxetL6brwvSI6W/444454c90486db7c5d95d6e125e27327/image1-113.png\" alt=\"WAF mitigations for Spring4Shell\" class=\"kg-image\" width=\"1200\" height=\"628\" loading=\"lazy\"/>\n            \n            </figure><p>This post was updated on 5th April 2022 to include toggled rules and new rules for CVE-2022-22965</p><p>A set of high profile vulnerabilities have been identified affecting the popular <a href=\"https://spring.io/\">Java Spring Framework</a> and related software components - generally being referred to as Spring4Shell.</p><p>Four CVEs (Common Vulnerabilities and Exposures) have been released so far and are being actively updated as new information emerges. These vulnerabilities can result, in the worst case, in full remote code execution (RCE) compromise:</p><ul><li><p><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22947\">CVE-2022-22947</a> - [<a href=\"https://tanzu.vmware.com/security/cve-2022-22947\">official VMware post</a>]</p></li><li><p><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22950\">CVE-2022-22950</a> - [<a href=\"https://tanzu.vmware.com/security/cve-2022-22950\">official VMware post</a>]</p></li><li><p><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22963\">CVE-2022-22963</a> - [<a href=\"https://spring.io/blog/2022/03/29/cve-report-published-for-spring-cloud-function\">official Spring project post</a>]</p></li><li><p><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965\">CVE-2022-22965</a> - [<a href=\"https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement\">official Spring project post</a>]</p></li></ul><p>Customers using Java Spring and related software components, such as the Spring Cloud Gateway, should immediately review their software and update to the latest versions by following the official Spring project guidance.</p><p>The <a href=\"https://www.cloudflare.com/waf/\">Cloudflare WAF</a> team is actively monitoring these CVEs and has already deployed a number of new managed mitigation rules. Customers should review the rules listed below to ensure they are enabled while also patching the underlying Java Spring components.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"cve-2022-22947\">CVE-2022-22947</h3>\n            <a href=\"#cve-2022-22947\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>A new rule has been developed and deployed for this CVE with an <a href=\"https://developers.cloudflare.com/waf/change-log/2022-03-29-emergency-release/\">emergency release on March 29,</a> which started blocking the vulnerability since the <a href=\"https://developers.cloudflare.com/waf/change-log/2022-04-04-emergency-release/\">emergency release on the 4th, April Â 2022</a>:</p><p>Managed Rule <b><i><b>Spring - CVE:CVE-2022-22947</b></i></b></p><ul><li><p>WAF rule ID: <code>e777f95584ba429796856007fbe6c869</code></p></li><li><p>Legacy rule ID: <code>100522</code></p></li></ul>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"cve-2022-22950-and-cve-2022-22963\">CVE-2022-22950 and CVE-2022-22963</h3>\n            <a href=\"#cve-2022-22950-and-cve-2022-22963\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Currently, available PoCs are blocked by the following rule:</p><p>Managed <i>Rule </i><b><i>PHP - Code Injection</i></b></p><ul><li><p>WAF rule ID: <code>55b100786189495c93744db0e1efdffb</code></p></li><li><p>Legacy rule ID: <code>PHP100011</code></p></li></ul>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"cve-2022-22963-and-cve-2022-22965\">CVE-2022-22963 and CVE-2022-22965</h3>\n            <a href=\"#cve-2022-22963-and-cve-2022-22965\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Currently, available PoCs are blocked by the following rule:</p><p>Managed Rule <b><i>Plone - Dangerous File Extension</i></b></p><ul><li><p>WAF rule ID: <code>aa3411d5505b4895b547d68950a28587</code></p></li><li><p>Legacy WAF ID: <code>PLONE0001</code></p></li></ul><p>We also deployed a new rule via an <a href=\"https://developers.cloudflare.com/waf/change-log/2022-03-31-emergency-release/\">emergency release on March 31</a> (today at time of writing) to cover additional variations attempting to exploit this vulnerability, which started blocking since the <a href=\"https://developers.cloudflare.com/waf/change-log/2022-04-04-emergency-release/\">emergency release on the 4th, April, 2022</a></p><p>Managed Rule <b><i>Spring - Code Injection</i></b></p><ul><li><p>WAF rule ID: <code>d58ebf5351d843d3a39a4480f2cc4e84</code></p></li><li><p>Legacy WAF ID: <code>100524</code></p></li></ul><p>Additionally, customers can receive protection against this CVE by deploying the Cloudflare OWASP Core Ruleset with default or better settings on our new WAF. Customers using our legacy WAF will have to configure a high OWASP sensitivity level.</p>",
		"id": "5x1vBdk7Ot4xN3MXd1ShuK",
		"localeList": {
			"name": "WAF mitigations for Spring4Shell Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "Cloudflare Managed Ruleset updates for the recent vulnerabilities affecting the Java Spring framework and related software components.",
		"metadata": {
			"title": "WAF mitigations for Spring4Shell",
			"description": "Cloudflare Managed Ruleset updates for the recent vulnerabilities affecting the Java Spring framework and related software components.",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/5S3YscJHIuTaE4uy5108R9/4f5c0520a8fb85e55ae6d457e4a51641/waf-mitigations-spring4shell-m3djI2.png"
		},
		"primary_author": {},
		"published_at": "2022-03-31T16:13:13.000+01:00",
		"slug": "waf-mitigations-spring4shell",
		"tags": [
			{
				"id": "lGCLqAT2SMojMzw5b6aio",
				"name": "WAF",
				"slug": "waf"
			},
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			},
			{
				"id": "mc0IiHhdcsCq82cDdpVdb",
				"name": "CVE",
				"slug": "cve"
			},
			{
				"id": "2pFyOCtANFB5qS6nbtQbVp",
				"name": "Vulnerabilities",
				"slug": "vulnerabilities"
			}
		],
		"title": "WAF mitigations for Spring4Shell",
		"updated_at": "2024-08-27T01:33:13.407Z",
		"url": "https://blog.cloudflare.com/waf-mitigations-spring4shell"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}