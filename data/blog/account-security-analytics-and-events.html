<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/Account-level-Security-Analytics-and-Security-Events_-better-visibility-and-control-over-all-account-zones-at-once.png" class="kg-image" alt="Account Security Analytics and Events: better visibility over all domains"></figure>
	<p>Cloudflare offers many security features like <a href="https://developers.cloudflare.com/waf/" target="_blank">WAF</a>, <a href="https://developers.cloudflare.com/bots/" target="_blank">Bot management</a>, <a href="https://developers.cloudflare.com/ddos-protection/" target="_blank">DDoS</a>, <a href="https://developers.cloudflare.com/cloudflare-one/" target="_blank">Zero Trust</a>, and more! This suite of products are offered in the form of rules to give basic protection against common vulnerability attacks. These rules are usually configured and monitored per domain, which is very simple when we talk about one, two, maybe three domains (or what we call in Cloudflare’s terms, “zones”).</p>
	<h3 id="the-zone-level-overview-sometimes-is-not-time-efficient">The zone-level overview sometimes is not time efficient</h3>
	<p>If you’re a Cloudflare customer with tens, hundreds, or even thousands of domains under your control, you’d spend hours going through these domains one by one, monitoring and configuring all security features. We know that’s a pain, especially for our Enterprise customers. That’s why last September we announced the <a href="https://blog.cloudflare.com/account-waf/">Account WAF</a>, where you can create one security rule and have it applied to the configuration of all your zones at once! </p>
	<p>Account WAF makes it easy to deploy security configurations. Following the same philosophy, we want to empower our customers by providing visibility over these configurations, or even better, visibility on all HTTP traffic.</p>
	<p>Today, Cloudflare is offering holistic views on the security suite by launching Account Security Analytics and Account Security Events. Now, across all your domains, you can monitor traffic, get insights quicker, and save hours of your time.</p>
	<h3 id="how-do-customers-get-visibility-over-security-traffic-today">How do customers get visibility over security traffic today?</h3>
	<p>Before today, to view account analytics or events, customers either used to access each zone individually to check the events and analytics dashboards, or used zone <a href="https://developers.cloudflare.com/analytics/graphql-api/" target="_blank">GraphQL Analytics API</a> or logs to collect data and send them to their preferred storage provider where they could collect, aggregate, and plot graphs to get insights for all zones under their account — in case ready-made dashboards were not provided.</p>
	<h3 id="introducing-account-security-analytics-and-events">Introducing Account Security Analytics and Events</h3>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/Screenshot-2023-03-17-at-9.57.13-AM.png" class="kg-image" alt="Snapshot highlighting Security Analytics and Events location in the dashboard sidebar"></figure>
	<p>The new views are security focused, data-driven dashboards — similar to zone-level views, both have &nbsp;similar data like: sampled logs and the top filters over many source dimensions (for example, IP addresses, Host, Country, ASN, etc.).</p>
	<p>The main difference between them is that Account Security Events focuses on the current configurations on every zone you have, which makes reviewing mitigated requests (rule matches) easy. This step is essential in distinguishing between actual threats from false positives, along with maintaining optimal security configuration.</p>
	<p>Part of the Security Events power is showing Events “by service” listing the security-related activity per security feature (for example, WAF, Firewall Rules, API Shield) and Events “by Action” (for example, allow, block, challenge).</p>
	<p>On the other hand, Account Security Analytics view shows a wider angle with all HTTP traffic on all zones under the account, whether this traffic is mitigated, i.e., the security configurations took an action to prevent the request from reaching your zone, or not mitigated. This is essential in fine-tuning your security configuration, finding possible false negatives, or onboarding new zones.</p>
	<p>The view also provides quick filters or insights of what we think are interesting cases worth exploring for ease of use. Many of the view components are similar to zone level <a href="https://blog.cloudflare.com/security-analytics/">Security Analytics</a> that we introduced recently.</p>
	<p>To get to know the components and how they interact, let’s have a look at an actual example.</p>
	<h3 id="analytics-walk-through-when-investigating-a-spike-in-traffic">Analytics walk-through when investigating a spike in traffic</h3>
	<p>Traffic spikes happen to many customers’ accounts; to investigate the reason behind them, and check what’s missing from the configurations, we recommend starting from Analytics as it shows mitigated and non-mitigated traffic, and to revise the mitigated requests to double check any false positives then Security Events is the go to place. That’s what we’ll do in this walk-through starting with the Analytics, finding a spike, and checking if we need further mitigation action.</p>
	<p><strong>Step 1:</strong> To navigate to the new views, sign into the Cloudflare dashboard and select the account you want to monitor. You will find <strong>Security Analytics</strong> and <strong>Security Events</strong> in the sidebar under <strong>Security Center.</strong></p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/pasted-image-0--8--2.png" class="kg-image" alt="Screenshot displaying the full Account Security Analytics view through the dashboard"></figure>
	<p><strong>Step 2:</strong> In the Analytics dashboard, if you had a big spike in the traffic compared to the usual, there’s a big chance it's a layer 7 DDoS attack. Once you spot one, zoom into the time interval in the graph.</p><!--kg-card-begin: html-->
	<div style="position: relative; padding-top: 32.967032967032964%;"><iframe src="https://customer-eq7kiuol0tk9chox.cloudflarestream.com/27f4054c10ca1fa2e39ed7f7c8471b0f/iframe?preload=true&amp;poster=https%3A%2F%2Fcustomer-eq7kiuol0tk9chox.cloudflarestream.com%2F27f4054c10ca1fa2e39ed7f7c8471b0f%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D%26height%3D600" style="border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;" allow="accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;" allowfullscreen="true"></iframe></div>
	<center><i>Zooming into a traffic spike on the timeseries scale</i></center><br><!--kg-card-end: html-->
	<p>By Expanding the top-Ns on top of the analytics page we can see here many observations:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/pasted-image-0--9--1.png" class="kg-image" alt="Screenshot showing Analytics top Ns for traffic spike analysis"></figure>
	<p>We can confirm it’s a DDoS attack as the peak of traffic does not come from one single IP address, It’s distributed over multiple source IPs. The “edge status code” indicates that there’s a rate limiting rule applied on this attack and it’s a GET method over HTTP/2.</p>
	<p>Looking at the right hand side of the analytics we can see “Attack Analysis” indicating that these requests were clean from XSS, SQLi, and common RCE attacks. The Bot Analysis indicates it’s an automated traffic in the Bot Scores distribution; these two products add another layer of intelligence to the investigation process. We can easily deduce here that the attacker is sending clean requests through high volumetric attack from multiple IPs to take the web application down.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/pasted-image-0--10--1.png" class="kg-image" alt="Display of Attack Analysis and Bot Analysis from Security Analytics dashboard"></figure>
	<p><strong>Step 3:</strong> For this attack we can see we have rules in place to mitigate it, with the visibility we get the freedom to fine tune our configurations to have better security posture, if needed. we can filter on this attack fingerprint, for instance: add a filter on the referer `www.example.com` which is receiving big bulk of the attack requests, add filter on path equals `/`, HTTP method, query string, and a filter on the automated traffic with Bot score, we will see the following:<br></p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/pasted-image-0--11-.png" class="kg-image" alt="Using the Analytics’ filters to get to the fingerprint identifying the Attack"></figure>
	<p><strong>Step 4:</strong> Jumping to Security Events to zoom in on our mitigation actions in this case, spike fingerprint is mitigated using two actions: Managed Challenge and Block. </p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/pasted-image-0--12-.png" class="kg-image" alt="Screenshot of the traffic spike distribution in the Security Events"></figure>
	<p>The mitigation happened on: Firewall rules and DDoS configurations, the exact rules are shown in the top events.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/03/pasted-image-0--13-.png" class="kg-image" alt="Mitigation rules used as shown in the top events of the attack"></figure>
	<h3 id="who-gets-the-new-views">Who gets the new views?</h3>
	<p>Starting this week all our customers on Enterprise plans will have access to Account Security Analytics and Security Events. We recommend having Account Bot Management, WAF Attack Score, and Account WAF to have access to the full visibility and actions.</p>
	<h3 id="what-s-next">What’s next?</h3>
	<p>The new Account Security Analytics and Events encompass metadata generated by the Cloudflare network for all domains in one place. In the upcoming period we will be providing a better experience to save our customers' time in a simple way. We're currently in beta, log into the dashboard, check out the views, and let us know your feedback.</p>
</div>