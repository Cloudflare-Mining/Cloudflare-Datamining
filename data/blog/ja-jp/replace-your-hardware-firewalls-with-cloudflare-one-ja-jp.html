<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/12/image2-6.png" class="kg-image" alt="Replace your hardware firewalls with Cloudflare One"></figure>
	<p>本日、お客様がハードウェアのファイアウォール機器から、次世代ネットワーク向けに構築された真のクラウドネイティブファイアウォールへと移行するための新機能を発表でき、嬉しく思います。Cloudflare Oneは、管理者がすべてのユーザーとリソースに一貫したセキュリティポリシーを適用するための、セキュアでパフォーマンスの高い、Zero Trust対応のプラットフォームを提供します。また、Cloudflareのグローバルネットワーク上に構築されているため、エッジセキュリティハードウェアのスケーリング、デプロイメント、メンテナンスを気にする必要がありません。</p>
	<p>この発表の一環として、Cloudflareは、お客様がレガシーハードウェアと決別することができるよう、<a href="https://www.cloudflare.com/ja-jp/oahu/" target="_blank">Oahu（オアフ）</a>プログラムを本日より開始しました。この記事では、前世代のファイアウォールの問題を解決し、ITチームの時間とコストを削減する新機能をご紹介します。</p>
	<h2 id="-"><strong>ここまでの道のり</strong></h2>
	<p>現在の状況を理解するためには、まずIPファイアウォールの歴史を簡単に説明する必要があるでしょう。</p>
	<h3 id="--1"><strong>プライベートネットワーク向けのステートレスなパケットフィルタリング</strong></h3>
	<p>第一世代のネットワークファイアウォールはたいてい、「城と堀」のアーキテクチャ（<a href="https://blog.cloudflare.com/welcome-to-cio-week/">昨日の投稿</a>でジェネレーション1と定義）を出発点とするプライベートネットワークのセキュリティ要件を満たすよう設計されました 。ファイアウォールの管理者は、<a href="https://www.cloudflare.com/ja-jp/learning/ddos/glossary/open-systems-interconnection-model-osi/" target="_blank">OSI参照モデル</a>のレイヤー3および4で受け渡される信号（主にIPとポート）を基にポリシーを設定することができました。これは、たとえばオフィスビルのある階で働く従業員グループが別の階のサーバーにLAN経由でアクセスする場合などには完璧でした。</p>
	<p>従来は、このようなパケットフィルタリング機能で十分だったのです。ところが、インターネットへの接続などでネットワークが複雑化するにつれ、外部の悪意ある者から企業ネットワークを保護する必要が生じ、ITチームはより高度なポリシーを必要とするようになりました。</p>
	<h3 id="--2"><strong>ステートフル&amp;ディープパケットインスペクションによる保護強化</strong></h3>
	<p>ファイアウォールのハードウェアが進化してステートフルパケットインスペクション機能が含まれるようになり、やがてディープパケットインスペクションも始まりました。これにより管理者は、たとえば既存の発信接続に関連しないすべての着信パケットをブロックすることができるようになりました。</p>
	<p>これらの新しい機能により、攻撃者に対してより高度な防御が可能になりました。しかし、これにはデメリットもありました。高いレベルのセキュリティをサポートするには、計算とメモリのリソースがより多く必要になります。そのため、セキュリティチームとネットワークチームは、新しい機器を導入する際に必要容量を的確に見極めて計画し、コストとネットワークの冗長性の間でトレードオフを行う必要がありました。</p>
	<p>コストとの兼ね合いに加え、これらの進化したファイアウォールでも、ネットワークの使用状況はある程度しか把握できないことが問題でした。たとえば、ユーザーがポート80で198.51.100.10にアクセスしていることはわかっても、そのユーザーが何にアクセスしているかをさらに調査するにはIPアドレスの逆引きが必要でした。それでもプロバイダーのフロントページが表示されるだけで、何にアクセスされたのか、ドメインやホストの評判など、「これは、さらなる調査が必要なセキュリティイベントなのか」という問いに答えるための情報は得られません。これだけで送信元を見極めるのは困難で、DHCP経由で配布されたプライベートIPアドレスとデバイス、そしてユーザーを関連付ける必要がありました（リース時間を長く設定し、デバイスを決して共有しなかった場合）。</p>
	<h3 id="--3"><strong>次世代ファイアウォールによるアプリケーション認識</strong></h3>
	<p>これらの課題に対処するために、業界は次世代ファイアウォール（NGFW）を導入しました。NGFWは、長年にわたって企業のエッジセキュリティデバイスとして君臨し、場合によっては今でも業界標準となっています。NGFWは、前世代の機能をすべて搭載した上でアプリケーションの認識機能を追加し、管理者がセキュリティ境界を通過するものをより細かく制御できるようにしました。NGFWは、ベンダーが提供する、あるいは外部から提供されるアプリケーションインテリジェンスという概念を導入しました。アプリケーションインテリジェンスとは、トラフィック特性から個々のアプリケーションを識別する能力をいい、各アプリケーションでユーザーができることとできないことを定義するポリシーに反映されます。</p>
	<p>より多くのアプリケーションがクラウドに移行するにつれ、NGFWベンダーは機器の仮想化バージョンを提供し始めました。これにより、管理者は次のハードウェアバージョンのリードタイムを気にする必要がなくなり、複数の場所に展開する際の柔軟性が高まりました。</p>
	<p>年月を経て脅威の状況が進化し続け、ネットワークが複雑化するにつれ、NGFWには追加のセキュリティ機能が組み込まれるようになり、中には複数機器の統合をサポートするものもありました。ベンダーによって、VPNゲートウェイ、IDS/IPS、Webアプリケーションファイアウォール、さらにはボット管理やDDoS攻撃対策などが含まれていました。しかし、これらの機能を備えていても、NGFWには欠点がありました。管理者は依然、機器（少なくともプライマリ／セカンダリ）の冗長設計・構成や、ファイアウォールの設置場所の選択に時間を費やす必要がありましたし、そこへ他の場所からトラフィックをバックホールすることでパフォーマンスの低下を招きました。さらに、疑似IDを適用するためのポリシーを作成する際には、慎重なIPアドレス管理が必要でした。</p>
	<h3 id="zero-trust-"><strong>Zero Trust導入に向けユーザーレベルの制御を追加</strong></h3>
	<p>ファイアウォールのベンダーがより高度な制御機能を追加するのと並行して、アプリケーションやユーザーが組織の「城」からインターネットに移行する際に生じるセキュリティ上の懸念に対処するため、ネットワークアーキテクチャのパラダイムシフトが始まりました。Zero Trustセキュリティとは、ネットワークの内外を問わず、誰もデフォルトでは信頼せず、ネットワーク上のリソースにアクセスしようとするすべての人について検証を求めることです。ファイアウォールは、アイデンティティプロバイダー（IdP）と統合することで、Zero Trustの原則を取り入れ始めました。また、「給与計算システムにアクセスできるのは、財務と人事だけ」といったユーザーグループに基づくポリシーをユーザーが構築できるようになって、よりきめ細かな制御が可能になり、IPアドレスを頼りに近似アイデンティティを割り出す必要性が減りました。</p>
	<p>これらのポリシーにより、企業はネットワークをロックダウンし、Zero Trustに近づくことができましたが、CIOはまだ問題を抱えています。他の組織のIDプロバイダーを統合する必要がある場合はどうすればいいのか？請負業者に企業リソースへのアクセスを安全に認めるにはどうすればよいのか？といった問題です。また、これらの新しい制御方法は、ハードウェアの管理に関する根本的な問題を解決するものではありません。問題は依然として存在し、拠点の追加や削除、ハイブリッドな業務形態の採用などのビジネス上の変化に伴って一層複雑になっています。CIOは、必要なことの一部しか対応していないソリューションをつなぎ合わせて使うのではなく、企業ネットワークの将来を見据えたソリューションを必要としています。</p>
	<h2 id="--4"><strong>次世代ネットワークのためのクラウドネイティブなファイアウォール</strong></h2>
	<p>Cloudflareは、ネットワーク接続とZero Trustセキュリティを統合することにより、お客様が企業ネットワークの未来を築けるよう支援しています。Cloudflare Oneプラットフォームを採用したお客様は、ハードウェアファイアウォールを廃止してクラウドネイティブなアプローチを採用することができ、前世代の問題を解決することでITチームの生活を楽にすることができます。</p>
	<h3 id="--5"><strong>フレキシブルなオンランプであらゆる送信元と宛先を接続</strong></h3>
	<p>ユースケースによってさまざまに異なるデバイスを管理するのではなく、データセンター、オフィス、クラウドプロパティ、ユーザーデバイスなど、ネットワーク全体のすべてのトラフィックが単一のグローバルファイアウォールを通過できるようにする必要があります。 Cloudflare Oneでは、ネットワーク層（GREまたは<a href="https://blog.cloudflare.com/anycast-ipsec/">IPsec</a>トンネル）や<a href="https://www.cloudflare.com/ja-jp/products/tunnel/" target="_blank">アプリケーション層</a>トンネル、<a href="https://www.cloudflare.com/ja-jp/network-interconnect/" target="_blank">直接接続</a>、<a href="https://blog.cloudflare.com/ja-jp/bringing-your-own-ips-to-cloudflare-byoip-ja-jp/">BYOIP</a>、<a href="https://blog.cloudflare.com/ja-jp/warp-for-desktop-ja-jp/">デバイスクライアント</a>など、柔軟性のあるさまざまなオンランプ(Cloud onRamp)によってCloudflareネットワークに接続することができます。 Cloudflareへの接続は、当社のグローバルネットワーク全体へのアクセスを意味しますから、物理的ハードウェアや仮想化されたハードウェアに関わる課題の多くを排除することができます。</p>
	<ul>
		<li><strong>容量計画は不要</strong>：お客様のファイアウォールの容量は、Cloudflareのグローバルネットワーク（現在100Tbpsを超え、さらに拡大中）の容量です。</li>
		<li><strong>ロケーションプランニングは不要</strong>：Cloudflareのエニーキャストネットワークアーキテクチャにより、トラフィックはソースに最も近い場所に自動的に接続されます。冗長性とフェイルオーバーがデフォルトで組み込まれているため、リージョンを選んだり、プライマリ機器やバックアップ機器の場所を気にする必要はありません。</li>
		<li>メンテナンスによるダウンタイムは無し：Cloudflareのファイアウォール機能の改善は、当社の他の製品と同様に、Cloudflareのグローバルエッジで継続的にデプロイされています。</li>
		<li><strong>DDoS攻撃対策機能を搭載</strong>：Dos攻撃でファイアウォールが圧倒される心配はありません。Cloudflareのネットワークは、攻撃を発生源に近いところで自動的にブロックし、クリーンなトラフィックだけを宛先へ送ります。</li>
	</ul>
	<h3 id="-zero-trust-"><strong>パケットフィルタリングからZero Trustまで、包括的なポリシーの設定</strong></h3>
	<p>Cloudflare Oneのポリシー設定によって、組織のトラフィックを保護し、さまざまなトラフィックランプをルーティングすることができます。これらのポリシーの作成では、従来のNGFWで利用可能なすべての属性を使うことができますが、拡張して<a href="https://developers.cloudflare.com/cloudflare-one/identity" target="_blank">Zero Trust属性</a>も含めることができます。これらのZero Trust属性には、1つまたは複数のIdPやエンドポイントセキュリティプロバイダーを含めることができます。</p>
	<p>OSI参照モデルのレイヤー3〜5に限っていうと、<a href="https://developers.cloudflare.com/magic-firewall/reference/magic-firewall-fields" target="_blank">ステートレス</a>と<a href="https://developers.cloudflare.com/cloudflare-one/policies/filtering/network-policies#expressions" target="_blank">ステートフル</a>の両方で、IP、ポート、プロトコル、その他の属性に基づくポリシーを作成できます。これらの属性は、ID属性およびCloudflareデバイスクライアントのいずれかと組み合わせて使用すると、Cloudflare上にプライベートネットワークを構築する際にも使用できます。</p>
	<p>また、IP許可/ブロックリストを管理する負担を軽減するために、ステートレスポリシーとステートフルポリシーの両方に適用できる管理リストのセットをCloudflareが提供します。さらに、より高度な方法として、<a href="https://developers.cloudflare.com/magic-firewall/reference/magic-firewall-functions" target="_blank">ディープパケットインスペクション</a>を<a href="https://blog.cloudflare.com/programmable-packet-filtering-with-magic-firewall/">実行し、プログラム可能なパケットフィルター</a>を記述して、ポジティブセキュリティモデルを適用し、最大級の攻撃を阻止することもできます。</p>
	<p>レイヤー7ポリシーのアプリケーションとコンテンツのカテゴリーは、Cloudflareのインテリジェンスを基にしており、お客様のユーザーをセキュリティ上の脅威から保護したり、データ流出を阻止したり、企業リソースの利用を監査するために使うことができます。こうした対策の筆頭は、優れたパフォーマンスのコンシューマー向け1.1.1.1サービス上に構築されたプロテクテッドDNSリゾルバーです。DNSの保護によって管理者は、ユーザーが既知または潜在的な<a href="https://developers.cloudflare.com/cloudflare-one/policies/filtering/dns-policies-builder/dns-categories" target="_blank">セキュリティリスク</a>をうまく切り抜けたり解決したりしなくて済むようにすることができます。ドメインが解決されると、管理者はHTTPポリシーを適用してユーザーのトラフィックの傍受、検査、フィルター処理を行うことができます。また、Webアプリケーションがセルフホスト型やSaaS型の場合は、WebベースのIDプロキシとして機能するCloudflareのアクセスポリシーを使用して保護することもできます。</p>
	<p>最後になりましたが、同じように重要なのがデータ流出の阻止で、管理者は<a href="https://developers.cloudflare.com/cloudflare-one/policies/browser-isolation" target="_blank">リモートブラウザ分離</a> を利用して、HTTPを使用する外部アプリケーションへのアクセスをロックダウンすることができます。さらに近々、ユーザーがSSHセッションで実行できるコマンドを記録し、フィルタリングできるようになる予定です。</p>
	<h3 id="--6"><strong>ポリシー管理の簡素化：ワンクリックであらゆる場所にルールを伝播</strong></h3>
	<p>従来のファイアウォールでは、各デバイスにポリシーをデプロイしたり、このプロセスを支援するオーケストレーションツールを設定・維持する必要がありました。対照的に、Cloudflareでは、シンプルなダッシュボードやAPIからネットワーク全体のポリシーを管理したり、Terraformを使ってインフラをコードとしてデプロイしたりすることができます。変更は、当社の<a href="https://blog.cloudflare.com/introducing-quicksilver-configuration-distribution-at-internet-scale/">Quicksilver</a>テクノロジーにより、数秒でエッジ全体に伝わります。ユーザーは、ファイアウォールを通過するトラフィックをログで可視化することができます。ログは<a href="https://blog.cloudflare.com/pii-and-selective-logging-controls-for-cloudflares-zero-trust-platform/">設定可能</a>です。</p>
	<h2 id="-1-"><strong>複数のファイアウォールのユースケースを1つのプラットフォームに統合</strong></h2>
	<p>ファイアウォールは、さまざまなセキュリティニーズを満たすために、無数のトラフィックフローをカバーする必要があります。たとえば、不正なインバウンドトラフィックをブロックしたり、アウトバウンド接続をフィルタリングして従業員やアプリケーションが安全なリソースにのみアクセスしていることを確認したり、内部（「East/West」）のトラフィックフローを検査してZero Trustを確実に適用するといったニーズです。場所によって異なるハードウェアが1つまたは複数のユースケースをカバーしていることがよくあります。使いやすさを向上させ、ファイアウォールポリシーの唯一の真実の情報源を確立するためには、これらを可能な限り統合するのが合理的だと当社では考えています。ここでは、従来ハードウェア型ファイアウォールで対応していたユースケースをいくつか取り上げ、Cloudflare Oneならどのように対応できるかを説明します。</p>
	<h3 id="--7"><strong>支社の保護</strong></h3>
	<p>従来、ITチームはオフィスごとに少なくとも1台のハードウェア型ファイアウォールを用意する必要がありました（冗長化のために複数台）。これには、支社ごとのトラフィック量を予測し、機器の注文、設置、保守を行う必要があったのです。現在は、GREやIPsecをサポートする標準的なルーターであれば、お客様が既にお持ちのハードウェアから支社のトラフィックをCloudflareに接続し、Cloudflareのダッシュボードからすべてのトラフィックのフィルタリングポリシーを制御することができます。</p>
	<p><strong>ステップ1： GREまたはIPsecトンネルの確立</strong><br>主要なハードウェアプロバイダーの大半は、GREやIPsecをトンネリング方式としてサポートしています。Cloudflareは、当社側でトンネルのエンドポイントとして使用するエニーキャストIPアドレスを提供し、お客様は追加ステップなしで標準的なGREまたはIPsecトンネルを構成します。エニーキャストIPアドレスで、Cloudflareの各データセンターへ自動的に接続します。</p>
	<p><strong>ステップ2：ネットワーク層のファイアウォールルールの設定</strong><br>すべてのIPトラフィックはMagic Firewallでフィルタリングすることができます。Magic Firewallには、送信元や宛先のIP、ポート、プロトコル、国、ビットフィールドの一致など、パケットのあらゆる特性に基づいてポリシーを構築する機能があります。Magic Firewallは、<a href="https://blog.cloudflare.com/introducing-ip-lists/"> IPリスト</a>と統合されており、<a href="https://www.cloudflare.com/ja-jp/magic-firewall/" target="_blank">プログラム可能なパケットフィルタリング</a>などの高度な機能も備えています。</p>
	<p><strong>ステップ3：アプリケーションレベルのファイアウォールルール用にトラフィックをアップグレード</strong><br>Magic Firewallを通過した後のTCPおよびUDPトラフィックは、Cloudflare Gatewayを介したきめ細かなフィルタリングのために「アップグレード」することができます。このアップグレードにより、アプリケーションやコンテンツの認識、アイデンティティの適用、SSH/HTTPプロキシ、DLPを含む一連のフィルタリング機能が利用可能になります。</p>
	<figure class="kg-card kg-image-card kg-width-wide"><img src="https://blog.cloudflare.com/content/images/2021/12/unnamed-2.png" class="kg-image" alt="Before: deploying hardware firewalls at every branch; managing different models and sometimes different vendors. After: traffic connected to global Anycast network; firewall policies deployed in one place propagate globally"></figure>
	<h3 id="-vpc-"><strong>トラフィック量の多いデータセンターやVPCの保護</strong></h3>
	<p>トラフィック量の多い本社やデータセンターでのデータ処理で使用されるファイアウォールは、ITチームの予算の中で最も大きな資本支出の一つになります。従来、データセンターの保護には、大容量を軽々処理できる大型機器が使用されていますが、その分コストもかさみます。Cloudflareのアーキテクチャでは、ネットワーク上のすべてのサーバーがお客様のトラフィックを処理する責任を共有できるため、1つのデバイスがボトルネックになったり、高価な専用コンポーネントを必要としたりすることはありません。お客様は、BYOIP、標準的なトンネルメカニズム、またはCloudflare Network Interconnectを使用してトラフィックをCloudflareに流入させ、ファイアウォールルールを通じて毎秒数テラビットものトラフィックをスムーズに処理することができます。</p>
	<figure class="kg-card kg-image-card kg-width-wide"><img src="https://blog.cloudflare.com/content/images/2021/12/unnamed--1--1.png" class="kg-image" alt="Before: traffic through the data center needed to flow through expensive appliance(s) that could keep up with volume. After: traffic balanced across thousands of commodity servers; malicious traffic blocked close to its source"></figure>
	<h3 id="--8"><strong>ローミングやハイブリッドワークフォースの保護</strong></h3>
	<p>企業のリソースに接続したり、インターネットに安全にアクセスしたりするために、従来のネットワークアーキテクチャでは、ユーザーは自分のデバイスからファイアウォールが設置された中央の場所へのVPN接続を確立します。ユーザーのトラフィックはそこで処理されてから最終目的地へ到達します。このようなアーキテクチャはパフォーマンスの低下を招きます。最新のファイアウォールはユーザーレベルの制御が可能ですが、必ずしもZero Trustを実現できるわけではありません。Cloudflareでは、Zero Trustポリシーへのオンランプとしてデバイスクライアントを使用することができます。今週後半に、クライアントの大規模デプロイメントをスムーズに行う方法について最新情報をお届けしますので、お楽しみに。</p>
	<figure class="kg-card kg-image-card kg-width-wide"><img src="https://blog.cloudflare.com/content/images/2021/12/unnamed--2--1.png" class="kg-image" alt="Before: user traffic backhauled to firewall device over VPN; after: policy enforced at the edge location closest to the user."></figure>
	<h2 id="--9"><strong>今後の展開</strong></h2>
	<p>今後もこのプラットフォームを進化させ、新たなユースケースに対応していきたいと考えています。Cloudflare Oneを使ったNATゲートウェイ機能の拡張に興味をお持ちのお客様や、当社のファイアウォール機能すべてについてより充実した分析、レポート、ユーザーエクスペリエンス監視をお求めのお客様、Cloudflareのネットワークを流れるすべてのトラフィックにDLP機能をフルに採用したいとお考えのお客様の声を聞いています。これらの分野に関する最新情報は、近日中に公開される予定です（ご期待ください）。</p>
	<p>Cloudflareの新しいファイアウォール機能は、本日より企業のお客様にご利用いただけます。詳細は<a href="https://www.cloudflare.com/ja-jp/magic-firewall/" target="_blank">こちら</a>。また、ハードウェア型ファイアウォールからZero Trustトへの移行方法については、<a href="https://www.cloudflare.com/ja-jp/oahu/" target="_blank">Oahuプログラム</a>をご確認ください。担当のアカウントチームにご相談いただければ、本日から利用を開始していただけます。</p>
	<p><a href="https://blog.cloudflare.com/tag/cio-week/">CIO Week</a><a href="https://blog.cloudflare.com/tag/cloudflare-one/">Cloudflare One</a><a href="https://blog.cloudflare.com/tag/firewall/">ファイアウォール</a><a href="https://blog.cloudflare.com/tag/gateway/">Cloudflare Gateway</a><a href="https://blog.cloudflare.com/tag/security/">セキュリティ</a></p>
	<p>Twitterでフォロー</p>
	<p>Ankur Aggarwal｜<a href="https://twitter.com/@Encore_Encore" target="_blank"> &nbsp;@Encore_Encore</a></p>
	<p>Annika Garbers |<a href="https://twitter.com/@annikagarbers" target="_blank"> &nbsp;@annikagarbers</a>Cloudflare |<a href="https://twitter.com/Cloudflare" target="_blank">Cloudflare</a></p>
</div>