{
	"footerBlurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
	"initialReadingTime": "5",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Marek Majkowski",
				"slug": "marek-majkowski",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1JuU5qavgwVeqR8BAUrd6U/3a0d0445d41c9a3c42011046efe9c37b/marek-majkowski.jpeg",
				"location": null,
				"website": null,
				"twitter": "@majek04",
				"facebook": null,
				"publiclyIndex": true
			}
		],
		"excerpt": "Every once in a while I run into an obscure computer technology that is a hidden gem, which over the years has become mostly forgotten. This is exactly how I feel about the tcpdump tool and its kernel counterpart the packet filter interface.",
		"feature_image": "https:undefined",
		"featured": false,
		"html": "<p>Every once in a while I run into an obscure computer technology that is a hidden gem, which over the years has become mostly forgotten. This is exactly how I feel about the <code>tcpdump</code> tool and its kernel counterpart the packet filter interface.</p><p>For example, say you run:</p><p>$ tcpdump -ni eth0 ip and udp and port 53</p><p>For most of us this command is pure magic, almost nobody understands what happens behind the scenes. This is understandable, there is little need to know how it works: the tool does its job very well, it&#39;s descriptive and very fast.</p><p>In this article I&#39;ll try to explain how <code>tcpdump</code> works and how we use its spinoffs to help fight the packet floods that hit us every day.</p><p>But first, we need a bit of history.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"historical-context\">Historical context</h3>\n            <a href=\"#historical-context\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Since workstations became interconnected, network administrators had a need to &quot;see&quot; what is flowing on the wires. The ability to sniff the network traffic is necessary when things go wrong, even for the mostbasic debugging.</p><p>For this reason operating systems developed APIs for packet sniffing. But, as there wasn&#39;t any real standard for it every OS had to invent <a href=\"http://www.cs.columbia.edu/~nahum/w6998/lectures/vpk-columbia-nsdi-pf.pdf\">a different API</a>: Sun’s STREAMS NIT, DEC&#39;s Ultrix Packet Filter, SGI’s Snoop and Xerox Alto had CMU/Stanford Packet Filter. This led to many complications. The simpler APIs just copied all the packets to the user space sniffer, which on a busy system resulted in a flood of useless work. The more complex APIs were able to filter packets beforepassing them to userspace, but it was often cumbersome and slow.</p><p>All this changed in 1993 when Steven McCanne and <a href=\"https://en.wikipedia.org/wiki/Van_Jacobson\">Van Jacobson</a> published the paper introducing a better way of filtering packets in the kernel, they called it <a href=\"http://www.tcpdump.org/papers/bpf-usenix93.pdf\">&quot;The BSD Packet Filter&quot; (BPF)</a>.</p><p>Since then <a href=\"https://en.wikipedia.org/wiki/Berkeley_Packet_Filter\">the BPF</a> has taken the world by a storm and along with <code>libpcap</code> and <code>tcpdump</code> become the de-facto standard in network debugging.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"tcpdump-dissected\">Tcpdump dissected</h3>\n            <a href=\"#tcpdump-dissected\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Tcpdump is composed of three logical parts:</p><ul><li><p>Expression parser: Tcpdump first parses a readable filter expression like <code>ip and udp and port 53</code>. The result is a short program in a special minimal bytecode, the BPF bytecode.</p></li><li><p>The BPF bytecode (filter program) is attached to the network tap interface.</p></li><li><p>Finally, tcpdump pretty prints filtered packets received from thenetwork tap. Pretty printing is far from a simple task, tcpdumpneeds to understand many network protocols to do it.</p></li></ul>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"expression-parser\">Expression parser</h3>\n            <a href=\"#expression-parser\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Given a packet filtering expression, tcpdump produces a short program in the BPF bytecode. The easiest way to see the parser in action is to pass a <code>-d</code> flag, which will produce a readable assembly-like program:</p><p>$ sudo tcpdump -p -ni eth0 -d &quot;ip and udp&quot;\n(000) ldh      [12]\n(001) jeq      #0x800           jt 2    jf 5\n(002) ldb      [23]\n(003) jeq      #0x11            jt 4    jf 5\n(004) ret      #65535\n(005) ret      #0</p><p>This program reads like this:</p><ul><li><p>Load a half-word (2 bytes) from the packet at offset 12.</p></li><li><p>Check if the value is 0x0800, otherwise fail. This checks for the IP packet on top of <a href=\"http://www.networksorcery.com/enp/protocol/ethernet.htm\">an Ethernet frame</a>.</p></li><li><p>Load byte from a packet at offset 23. That&#39;s the &quot;protocol&quot; field 9 bytes within <a href=\"http://www.networksorcery.com/enp/protocol/ip.htm\">an IP frame</a>.</p></li><li><p>Check if the value is 0x11, which is the UDP protocol number, otherwise fail.</p></li><li><p>Return success. Packet is matching the rule.</p></li></ul><p>Here you can find <a href=\"https://www.kernel.org/doc/Documentation/networking/filter.txt\">the full documentation of the assembly syntax</a>.</p><p>Less readable compiled bytecode is printed with <code>-ddd</code> option:</p><p>$ sudo tcpdump -p -ni eth0 -ddd &quot;ip and udp&quot;|tr &quot;\\n&quot; &quot;,&quot;\n6,40 0 0 12,21 0 3 2048,48 0 0 23,21 0 1 17,6 0 0 65535,6 0 0 0,</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"kernel-api\">Kernel API</h3>\n            <a href=\"#kernel-api\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Tcpdump can open a network tap by requesting a <code>SOCK_RAW</code> socket and after a few magical <code>setsockopt</code> calls a filter can be set with <code>SO_ATTACH_FILTER</code> option:</p><p>sock = socket(PF_PACKET, SOCK_RAW, htons(ETH_P_ALL))\n...\nsetsockopt(sock, SOL_SOCKET, SO_ATTACH_FILTER, ...)</p><p>From now on the BPF filter will be run against all received packets ona network interface and only packets matching that filter will bepassed to that network tap file descriptor.</p><p>All the gritty details are described in the<a href=\"https://www.kernel.org/doc/Documentation/networking/filter.txt\"><code>Documentation/networking/filter.txt</code></a>file. For the best performance one can use<a href=\"https://www.kernel.org/doc/Documentation/networking/packet_mmap.txt\">a zero-copy <code>PACKET_MMAP</code> / <code>PACKET_RX_RING</code> interface</a>,though most people should probably stick to the<a href=\"http://www.tcpdump.org/manpages/pcap.3pcap.html\">high level <code>libpcap</code> API</a>.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"the-bpf-bytecode\">The BPF bytecode</h3>\n            <a href=\"#the-bpf-bytecode\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>In essence Tcpdump asks the kernel to execute a BPF program within thekernel context. This might sound risky, but actually isn&#39;t. Beforeexecuting the BPF bytecode kernel ensures that it&#39;s safe:</p><ul><li><p>All the jumps are only forward, which guarantees that there aren&#39;t any loops in the BPF program. Therefore it must terminate.</p></li><li><p>All instructions, especially memory reads are valid and within range.</p></li><li><p>The single BPF program has less than 4096 instructions.</p></li></ul><p>All this guarantees that the BPF programs executed within kernel context will run fast and will never infinitely loop. That means the BPF programs are not Turing complete, but in practice they are expressive enough for the job and deal with packet filtering very well.</p><p>The original concepts underlying the BPF were described in a 1993 and didn&#39;t require updates for many years. The Linux implementation on the other hand is steadily evolving: recently a <a href=\"http://lwn.net/Articles/437981/\">new and shiny just-in-time BPF compiler</a> was introduced, and a few months ago an attempt was made to upgrade the <a href=\"https://lwn.net/Articles/584377/\">BPF assembly to a 64-bit form</a>.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"not-only-tcpdump\">Not only tcpdump</h3>\n            <a href=\"#not-only-tcpdump\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>BPF is an absolutely marvelous and flexible way of filtering packets. For years it got reused in more places and now Linux uses BPF filters for:</p><ul><li><p>tcpdump-style packet filtering</p></li><li><p><a href=\"http://lxr.free-electrons.com/source/net/sched/cls_bpf.c\">&quot;cls_bpf&quot;</a> classifier for traffic shaping (QoS)</p></li><li><p><a href=\"https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt\">&quot;seccomp-bpf&quot;</a> syscalls filter to sandbox applications</p></li><li><p>&quot;xt_bpf&quot; iptables module</p></li></ul>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"how-we-use-it\">How we use it</h3>\n            <a href=\"#how-we-use-it\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>CloudFlare deals with massive packet floods on a daily basis. It&#39;s very important for us to be able to drop malicious traffic fast, long before it hits the application.</p><p>Unfortunately matching before the application is not easy. Basic iptables filtering, for example looking just at the source IP, doesn&#39;t work as floods get more sophisticated. The iptables module closest to our needs is<a href=\"http://www.stearns.org/doc/iptables-u32.current.html\">&quot;xt_u32&quot;</a>, but it&#39;s hard to understand and somewhat limited. Though it&#39;s generally <a href=\"https://github.com/smurfmonitor/dns-iptables-rules/blob/master/domain-blacklist.txt\">pretty useful</a>, and to make it easier people wrote <a href=\"http://www.bortzmeyer.org/files/generate-netfilter-u32-dns-rule.py\">rule generators</a>.</p><p>But what works for us best is the &quot;xp_bpf&quot; iptables module by Willem de Bruijn. With it we can match an iptable rule based on any BPF expression.</p><p>Unfortunately, our BPF bytecode became pretty complex and it can&#39;t be written as a usual tcpdump expression any more. Instead we rely on a custom crafted BPF bytecode, for example, this is an &quot;xt_bpf&quot; bytecode that matches a DNS query for &quot;<a href=\"http://www.example.com\">www.example.com</a>&quot;:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">ld #20\nldx 4\\*(\\[0\\]&amp;0xf)\nadd x\ntax</pre></code>\n            <p>lb_0:\n; Match: 076578616d706c6503636f6d00 &#39;\\x07example\\x03com\\x00&#39;\nld [x + 0]\njneq #0x07657861, lb_1\nld [x + 4]\njneq #0x6d706c65, lb_1\nld [x + 8]\njneq #0x03636f6d, lb_1\nldb [x + 12]\njneq #0x00, lb_1\nret #1</p><p>lb_1:\nret #0</p><p>To compile it we use the tools from the <a href=\"https://github.com/torvalds/linux/tree/master/tools/net\"><code>tools/net</code></a> directory:</p><p>$ bpf_asm drop_example_com.bpf\n14,0 0 0 20,177 0 0 0,12 0 0 0,7 0 0 0,64 0 0 0,21 0 7 124090465,64 0 0 4,21 0 5 1836084325,64 0 0 8,21 0 3 56848237,80 0 0 12,21 0 1 0,6 0 0 1,6 0 0 0</p><p>Finally you can apply the rule like so:</p><p>iptables -A INPUT \\\n-p udp --dport 53 \\\n-m bpf --bytecode &quot;14,0 0 0 20,177 0 0 0,12 0 0 0,7 0 0 0,64 0 0 0,21 0 7 124090465,64 0 0 4,21 0 5 1836084325,64 0 0 8,21 0 3 56848237,80 0 0 12,21 0 1 0,6 0 0 1,6 0 0 0,&quot; \\\n-j DROP</p><p>This is a fairly simple rule just looking for a particular bytes in the packet. The same could be achieved using &quot;u32&quot; or quot;string&quot;modules. But &quot;xt_bpf&quot; gives us more flexibility. For example we can make the rule case insensitive:</p><p>...\nlb_0:\n; Match: 076578616d706c6503636f6d00 &#39;\\x07example\\x03com\\x00&#39;\nld [x + 0]\nor #0x00202020\njneq #0x07657861, lb_1\nld [x + 4]\nor #0x20202020\njneq #0x6d706c65, lb_1\nld [x + 8]\nor #0x00202020\njneq #0x03636f6d, lb_1\nldb [x + 12]\njneq #0x00, lb_1\nret #1\n...</p><p>Or match all the subdomains of &quot;example.com&quot;:</p><p>...\nlb_0:\n; Match: *\nldb [x + 0]\nadd x\nadd #1\ntax\n; Match: 076578616d706c6503636f6d00 &#39;\\x07example\\x03com\\x00&#39;\nld [x + 0]\njneq #0x07657861, lb_1\nld [x + 4]\njneq #0x6d706c65, lb_1\nld [x + 8]\njneq #0x03636f6d, lb_1\nldb [x + 12]\njneq #0x00, lb_1\nret #1\n...</p><p>These kind of rules are very useful, they allow us to pinpoint the malicious traffic and drop it early. Just in the last couple of weeks we dropped 870,213,889,941 packets with few BPF rules. Recently during a flood we saw 41 billion packets dropped throughout a night due to a single well placed rule.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"summary\">Summary</h3>\n            <a href=\"#summary\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Just as intended by Steven McCanne and Van Jacobson, the BPF is still very useful and extremely fast. Even without enabling the BPF JIT we don&#39;t see any performance hit of applying complex BPF rules.</p><p>I&#39;m sure we&#39;ll use more BPF filters in the future to shield ourselves from malicious traffic and to have more CPU to deal with legitimate requests.</p><p>Does generating BPF assembly sound like fun? <a href=\"http://www.cloudflare.com/join-our-team\">We&#39;re hiring talented developers</a>, including to our <a href=\"/cloudflare-london-were-hiring\">elite office in London</a>.</p>",
		"id": "3IqJQfNovpBLSBrqsUYacz",
		"localeList": {
			"name": "BPF - the forgotten bytecode Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"publicly_index": true,
		"published_at": "2014-05-21T15:00:00.000+01:00",
		"slug": "bpf-the-forgotten-bytecode",
		"tags": [
			{
				"id": "4HIPcb68qM0e26fIxyfzwQ",
				"name": "Developers",
				"slug": "developers"
			},
			{
				"id": "6lhzEBz2B56RKa4nUEAGYJ",
				"name": "Programming",
				"slug": "programming"
			},
			{
				"id": "5NpgoTJYJjhgjSLaY7Gt3p",
				"name": "TCP",
				"slug": "tcp"
			},
			{
				"id": "48r7QV00gLMWOIcM1CSDRy",
				"name": "Speed & Reliability",
				"slug": "speed-and-reliability"
			}
		],
		"title": "BPF - the forgotten bytecode",
		"updated_at": "2024-10-10T00:40:03.577Z",
		"url": "https://blog.cloudflare.com/bpf-the-forgotten-bytecode"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.icon_aria_label": "Search",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"search.result_stat_empty": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong>",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"search.autocomplete_title": "Insert a query. Press enter to send",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}