<div class="mb2 gray5">6 min read</div>
<div class="mt4">This post is also available in <a href="https://blog.cloudflare.com/zh-cn/amazon-2bn-ipv4-tax-how-avoid-paying">简体中文</a>, <a href="https://blog.cloudflare.com/de-de/amazon-2bn-ipv4-tax-how-avoid-paying">Deutsch</a>, <a href="https://blog.cloudflare.com/ja-jp/amazon-2bn-ipv4-tax-how-avoid-paying">日本語</a>, <a href="https://blog.cloudflare.com/es-es/amazon-2bn-ipv4-tax-how-avoid-paying">Español</a> and <a href="https://blog.cloudflare.com/fr-fr/amazon-2bn-ipv4-tax-how-avoid-paying">Français</a>.</div>
<div class="post-content lh-copy gray1">
	<p></p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5XAwhvgK5l02B9TAvUiy9d/8aed64f222f749b8bc6515e421c624d8/image7-11.png" alt="Amazon’s $2bn IPv4 tax — and how you can avoid paying it" class="kg-image" width="1801" height="1013" loading="lazy">

	</figure>
	<p>One of the wonderful things about the Internet is that, whether as a consumer or producer, the cost has continued to come down. Back in the day, it used to be that you needed a server room, a whole host of hardware, and an army of folks to help keep everything up and running. The cloud changed that, but even with that shift, services like <a href="https://www.cloudflare.com/application-services/products/ssl">SSL</a> or unmetered <a href="https://www.cloudflare.com/ddos">DDoS protection</a> were out of reach for many. We think that the march towards a more accessible Internet — both through ease of use, and reduced cost — is a wonderful thing, and we’re proud to have played a part in making it happen.</p>
	<p>Every now and then, however, the march of progress gets interrupted.</p>
	<p>On July 28, 2023, Amazon Web Services (AWS) announced that they would begin to charge “per IP per hour for all public IPv4 addresses, whether attached to a service or not”, starting February 1, 2024. This change will add at least \$43 extra per year for every IPv4 address Amazon customers use; this may not sound like much, but we’ve seen back of the napkin analysis <a href="https://www.linkedin.com/posts/atoonk_new-aws-public-ipv4-address-charge-public-activity-7091779585368862720-x0zw">that suggests</a> this will result in an approximately \$2bn tax on the Internet.</p>
	<p>In this blog, we’ll explain a little bit more about the technology involved, but most importantly, give you a step-by-step walkthrough of how Cloudflare can help you not only eliminate the need to pay Amazon for something that they shouldn’t be charging you for in the first place, but also if you’re a Pro or Business subscriber, we want to put \$43 in your pocket instead of taking it out. Don’t give Amazon \$43 for IPv4, let us give you \$43 and throw in IPv4 as well.</p>
	<div class="flex anchor relative">
		<h3 id="how-can-cloudflare-help-avoid-aws-ipv4-charges">How can Cloudflare help avoid AWS IPv4 charges?</h3>
		<a href="https://blog.cloudflare.com/#how-can-cloudflare-help-avoid-aws-ipv4-charges" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>The only way to avoid Amazon’s IPv4 tax is to transition to IPv6 with AWS. But we recognize that not everyone is ready to make that shift — it can be an expensive and challenging process, and may present problems with hardware compatibility and network performance. We cover the finer details of these challenges below, so keep reading! Cloudflare can help ease this transition: let us deal with communicating to AWS using IPv6. Not only that, you’ll get all the rest of the benefits of using Cloudflare and our global network — including all the <a href="https://www.cloudflare.com/learning/performance/speed-up-a-website">performance</a> and security that Cloudflare is known for — and a \$43 dollar credit for using us!</p>
	<p>IPv6 services like these are something we’ve been offering at Cloudflare for years - in fact this was first announced during Cloudflare's first birthday week in 2011! We’ve made this process simple to enable as well, so you can set this up as soon as today.</p>
	<figure class="kg-card kg-image-card kg-width-wide">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1UYTukqpByLSMhpLwk7rQK/c47a8e37780e14ab2a26353f10bbf12d/image6-2.png" alt="" class="kg-image" width="1999" height="628" loading="lazy">

	</figure>
	<p>To set this feature up you will need to both enable IPv6 Compatibility and set up your origin for <a href="https://docs.aws.amazon.com/vpc/latest/userguide/aws-ipv6-support.html">AWS to be an IPv6 origin</a>.</p>
	<p>To configure this feature simply follow these steps:</p>
	<p>1. Login to your Cloudflare account.</p>
	<p>2. Select the appropriate domain</p>
	<p>3. Click the Network app.</p>
	<figure class="kg-card kg-image-card kg-width-wide">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/66Te3OO0yjDXrPqmF4YVYq/5ad20b6f21de07cb239ea2ce16185727/Screenshot-2023-09-25-at-17.01.11.png" alt="" class="kg-image" width="1580" height="332" loading="lazy">

	</figure>
	<p>4. Make sure IPv6 Compatibility is toggled on.</p>
	<figure class="kg-card kg-image-card kg-width-wide">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/62DVRA42xpR7KkUFPEqrKt/058d64e5e67472b89732dff7c7debe4b/Screenshot-2023-09-25-at-17.01.24.png" alt="" class="kg-image" width="1590" height="222" loading="lazy">

	</figure>
	<p>To get an IPv6 origin from Amazon you will likely have to follow these steps:</p>
	<ol>
		<li>
			<p>Associate an IPv6 CIDR block with your VPC and subnets</p>
		</li>
		<li>
			<p>Update your route tables</p>
		</li>
		<li>
			<p>Update your security group rules</p>
		</li>
		<li>
			<p>Change your instance type</p>
		</li>
		<li>
			<p>Assign IPv6 addresses to your instances</p>
		</li>
		<li>
			<p>(Optional) Configure IPv6 on your instances</p>
		</li>
	</ol>
	<p>(For more information about this migration, check out <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-migrate-ipv6.html#vpc-migrate-ipv6-example">this link</a>.)</p>
	<p>Once you have your IPv6 origins, you’ll want to update your origins on Cloudflare to use the IPv6 addresses. In the simple example of a single origin at root, this is done by creating a proxied (orange-cloud) <a href="https://www.cloudflare.com/learning/dns/dns-records/dns-aaaa-record">AAAA record</a> in your Cloudflare DNS editor:</p>
	<figure class="kg-card kg-image-card kg-width-wide">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6JN8TolCbQmiAUnzrDhnAX/4e3d75ce7cef9536290118c6344a125b/image2-8.png" alt="" class="kg-image" width="1999" height="532" loading="lazy">

	</figure>
	<p>If you are using <a href="https://www.cloudflare.com/application-services/products/load-balancing">Load Balancers</a>, you will want to <a href="https://developers.cloudflare.com/load-balancing/how-to/create-pool/#edit-a-pool">update the origin(s)</a> there.</p>
	<p>Once that’s done, you can remove the A/IPv4 record(s) and traffic will move over to the v6 address. While this process is easy now, we’re working on how we can make moving to IPv6 on Cloudflare even easier.</p>
	<p>Once you have these features configured and have traffic running through Cloudflare to your origin for at least 6 months, you will be eligible to have a $43 credit deposited right into your Cloudflare account! You can use this credit for your Pro or Biz subscription or even for Workers and <a href="https://www.cloudflare.com/developer-platform/r2">R2</a> usage. See <a href="https://www.cloudflare.com/lp/avoid-amazon-ipv4-tax">here</a> for more information on how to opt in to this offer.</p>
	<p>Through this feature Cloudflare provides the flexibility to manage your IPv6 settings as per your requirements. By leveraging Cloudflare's robust IPv6 support, you can ensure seamless connectivity for your users, while avoiding additional costs associated with public IPv4 addresses.</p>
	<div class="flex anchor relative">
		<h3 id="whats-wrong-with-ipv4">What’s wrong with IPv4?</h3>
		<a href="https://blog.cloudflare.com/#whats-wrong-with-ipv4" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>So if Cloudflare has this solution, why should you even move to IPv6? Well to clearly explain this let's start with the problem with IPv4.</p>
	<p><a href="https://www.cloudflare.com/learning/network-layer/internet-protocol/#:~:text=The%20Internet%20Protocol%20(IP)%20is,Network%20layer">IP addresses</a> are used to identify and reach resources on a network, which could be a private network, like your office's private network, or a complex public network like the Internet. An example of an IPv4 address would be 198.51.100.1 or 198.51.100.50. And there are approximately 4.3 billion unique IPv4 addresses like these for websites, servers, and other destinations on the Internet to use for routing.</p>
	<p>4.3 billion IPv4 addresses may sound like a lot, but it’s not as IPv4 space is running out. In September 2015 ARIN, one of the regional Internet registries that allows people to acquire IP addresses, <a href="https://www.arin.net/resources/guide/ipv4">announced</a> that they had no available space: if you want to buy an IPv4 address you have to go and talk to private companies who are selling them. These companies charge a pretty penny for their IPv4 addresses. It costs about <a href="https://auctions.ipv4.global">$40 per IPv4 address today</a>. To buy a grouping of IPv4 addresses, also known as a prefix of which the minimum required size is 256 IP addresses, costs about \$10,000.</p>
	<p>IP addresses are necessary for having a domain or device on the Internet, but today IPv4 addresses are an increasingly more complicated resource to acquire. Therefore, to facilitate the growth of the Internet there needed to be more unique addresses made available without breaking the bank. That’s where IPv6 comes in.</p>
	<div class="flex anchor relative">
		<h3 id="ipv4-vs-ipv6">IPv4 vs. IPv6</h3>
		<a href="https://blog.cloudflare.com/#ipv4-vs-ipv6" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>In 1995 the IETF (Internet Engineering Task Force) published the <a href="https://datatracker.ietf.org/doc/html/rfc1883">RFC</a> for IPv6, which proposed to solve this problem of the limited IPv4 space. Instead of 32 bits of addressable space, IPv6 expanded to 128 bits of addressable space. <b>This means that instead of 4.3 billion addresses available, there are approximately 340 undecillion IPv6 addresses available</b>. This is roughly equivalent to the number of grains of sand on Earth.</p>
	<p>So this problem is solved, why should you care? &nbsp;The answer is because many networks on the Internet still prefer IPv4, and companies like AWS are starting to charge money for IPv4 usage.</p>
	<p>Let's speak on AWS first: AWS today owns one of the largest chunks of the IPv4 space. During a period of time when IPv4 addresses were on the private market to purchase for dollars per IP address, AWS chose to use its large capital to its advantage and buy up a large amount of the space. Today AWS owns 1.7% of the IPv4 address space which equates to <a href="https://toonk.io/aws-and-their-billions-in-ipv4-addresses/index.html">~100 million IPv4 addresses</a>.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/toRGJVmQp33iZlby5l5vi/2528151de1f1655419f715594f0cb389/image1-11.png" alt="" class="kg-image" width="1934" height="1190" loading="lazy">

	</figure>
	<p>So you would think that moving to IPv6 is the right move, however, for the Internet community it’s proven to be quite a challenge.</p>
	<p>When IPv6 was published in the 90s very few networks had devices that supported IPv6. However, today in 2023, that is not the case: global networks supporting IPv6 has <a href="https://pulse.internetsociety.org/technologies">increased to 46 percent</a>, so the hardware limitations around supporting it are decreasing. Additionally, anti-abuse and security tools initially had no idea how to deal with attacks or traffic that used IPv6 address space, and this still remains an issue for some of these tools. In 2014, we made it even easier for origin tools to convert by creating <a href="https://blog.cloudflare.com/eliminating-the-last-reasons-to-not-enable-ipv6">pseudo IPv4</a> to help bridge the gap to those tools.</p>
	<p>Despite all of this, many networks don’t have good support infrastructure for IPv6 networking since most networks were built on IPv4. At Cloudflare, we have built our network to support both protocols, known as “dual-stack”.</p>
	<p>For a while there were also many networks which had markedly worse performance for IPv6 than IPv4. This is not true anymore, as of today we see only a slight degradation in IPv6 performance across the whole Internet compared to IPv4. The reasons for this include things like legacy hardware, sub-optimal IPv6 connectivity outside our network and high cost for deploying IPv6. You can see in the chart below the additional latency of IPv6 traffic on Cloudflare’s network as compared to IPv4 traffic:</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1gD5CMwSwUA7X2OkYlrLsT/4716cb91db061e660ccbe3ea8c5b3aae/image5-5.png" alt="" class="kg-image" width="1200" height="742" loading="lazy">

	</figure>
	<p>There were many challenges to adopting IPv6, and for some these issues with hardware compatibility and network performance are still worries. This is why still using IPv4 can be useful to folks while transitioning to IPv6, which is what makes AWS’ decision to charge for IPv4 impactful on many websites.</p>
	<div class="flex anchor relative">
		<h3 id="so-dont-pay-for-aws-ipv4-charges">So, don’t pay for AWS IPv4 charges</h3>
		<a href="https://blog.cloudflare.com/#so-dont-pay-for-aws-ipv4-charges" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>At the end of the day the choice is clear: you could pay Amazon more to rent their IPs than to buy them, or move to Cloudflare and use our free service to help with the transition to IPv6 with little overhead.</p>
</div>