{
	"initialReadingTime": "5",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "John Graham-Cumming",
				"slug": "john-graham-cumming",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/5vGNsXzZrtSLn2X30pnpUY/a43660c54db33a4289ab5a7d99d3d414/john-graham-cumming.jpg",
				"location": "Lisbon, Portugal",
				"website": null,
				"twitter": null,
				"facebook": null
			}
		],
		"excerpt": "If you've been following recent news about technical spying by the US National Security Agency and the UK's Government Communications Headquarters you may have come across a claim that the NSA was involved in weakening a random number generator. ",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/5lE44XwKD8pgusOBwD6Z5g/94107d18770c9f2d4c005c3dc5170840/why-randomness-matters.jpg",
		"featured": false,
		"html": "<p>If you&#39;ve been following recent news about technical spying by the US National Security Agency and the UK&#39;s Government Communications Headquarters you may have come across a claim that the NSA was involved in weakening a random number generator. The obvious question to ask is... why mess with random number generation?</p><p>The answer is rather simple: good random numbers are fundemental to almost all secure computer systems. Without them everything from Second World War ciphers like <a href=\"https://en.wikipedia.org/wiki/Lorenz_cipher\">Lorenz</a> to the SSL your browser uses to secure web traffic are in serious trouble.</p><p>To understand why, and the threat that bad random numbers pose, it&#39;s necessary to understand a little about random numbers themselves (such as &quot;what is a good random number anyway?&quot;) and how they are used in secure systems.</p><h3>A Hacker News Hack</h3><p>As an example of how random numbers go wrong I&#39;ll begin with a hack of the popular programming and technology web site <a href=\"http://news.ycombinator.com/\">Hacker News</a>.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/40au0pGr0v0dOjBGBAZqQ9/98ebe84031360717a67f6dfa7ee1068f/hn.png\" alt=\"Hacker News\" class=\"kg-image\" width=\"716\" height=\"33\" loading=\"lazy\"/>\n            \n            </figure><p>Four years ago I <a href=\"https://news.ycombinator.com/item?id=596126\">mentioned</a> on the site that its random number generator was vulnerable to being used to attack the site. Not long after, and entirely independently, another contributor to the site actually <a href=\"https://news.ycombinator.com/item?id=639976\">carried out the attack</a> with the permission of the site owner.</p><p>Here&#39;s how it worked. When you log into a web site you are typically assigned a unique ID for that session (the period you are logged in). That unique ID needs to be unique to you and not guessable by someone else. If someone else can guess it they can impersonate you.</p><p>In the case of Hacker News, the unique ID is a string of randomcharacters such as lBGn0tWMcx7380gZyrUO9B. Each logged in user has adifferent string and the strings should be very, very difficult toguess or figure out.</p><h3>Pseudo-randomness</h3><p>The IDs are generated internally using a pseudo-random numbergenerator. That&#39;s a mathematical function that can be calledrepeatedly to get apparently random numbers. I say apparently because, as the great mathematician John von Neumann said: &quot;Anyone who considers arithmetical methods of producing random digits is, of course, in a state of sin.&quot; The computer scientist Donald Knuth tells a story of inventing a pseudo-random number generator himself only to be shocked at how poor it was.</p><p>Although pseudo-random number generators can generate a sequence of apparently random numbers they have weaknesses.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/5ZlscOxjB28S7q5DKywhvn/a8479800fae1f79c9c2147dc13a5e26e/vonneumann.jpg\" alt=\"The Three\" class=\"kg-image\" width=\"480\" height=\"352\" loading=\"lazy\"/>\n            \n            </figure><p>von Neumann used a simple pseudo-random number generator called the<a href=\"https://en.wikipedia.org/wiki/Middle-square_method\">middle square</a> that works as follows. You start with some number (called a seed) and square it. You take the four middle digits as your random number and square them to get the next random number, and so on.</p><p>For example, if you chose 4181 as a seed the sequence 4807, 1072,1491, 2230, 9279, ... would be generated as follows:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\"> Random number        Its Square    Middle digits\n 4181                 17480761      4807\n 4807                 23107249      1072\n 1072                  1149184      1491\n 1491                  2223081      2230\n 2230                  4972900      9729\n 9279                 94653441      6534\n and so on</pre></code>\n            <p>This particular pseudo-random number has long since been replaced by better ones such as the <a href=\"https://en.wikipedia.org/wiki/Mersenne_twister\">Mersenne Twister</a> whose output is harder to predict. The middle square method is trivial to predict: the next number it generates is entirely determined by the number it last produced. The Mersenne Twister on the other hand is much harder to predict because it has internal state that it uses to produce random numbers.</p><p>In the world of cryptography there are <a href=\"https://en.wikipedia.org/wiki/CSPRNG\">cryptographically secure pseudo-random number generators</a> which are designed to be unpredictable no matter how many random cnumbers you ask it to generate. (The Mersenne Twister isn&#39;t cryptographically secure because it can be predicted if enough of the random numbers it generates are observed.)</p><p>For secure systems it&#39;s vital that the random number generator be unpredictable.</p><h3>Starting With A Seed</h3><p>And all pseudo-random number generators need to start somewhere; they need to be seeded and that&#39;s where Hacker News failed. The random number generator was seeded with the time in milliseconds when the Hacker News software was last started. By some careful work, the attacker managed to make Hacker News crash and could then predict when it restarted within a window of about one minute. From it he was able to predict the unique IDs assigned to users as they logged in and could, therefore, impersonate them. (Similar random number problems enabled one group of people to cheat at <a href=\"http://www.cigital.com/papers/download/developer_gambling.php\">online poker</a>.)</p><p>The full details of how the Hacker News Hack worked are <a href=\"https://news.ycombinator.com/item?id=639976\">here</a>. The attack worked because once Hacker News crashed the attacker would wait for it to start and note the current time. Amusingly, the Hacker News server was willing to give out that information. The attacker then had 60s worth of possible seeds (60,000 seeds since the seed was in milliseconds).</p><p>So, the attacker would log in and look at their own unique ID. It had been generated by random numbers inside Hacker News&#39;s software. He then tried out each of the 60,000 seeds and ran the random number generation algorithm used by Hacker News until he found a match with his own unique ID. That told him which seed had been used, and it let him keep generating further unique IDs by generating the same sequence of random numbers that Hacker News was using. From that he could predict the unique IDs given out to users as they logged in and he could then impersonate them.</p><p>The Hacker News code was changed to use the Linux /dev/urandom source of random numbers which means that today unique IDs are generated with a good random number generator and without the weak seed previously used.</p><p>So, there are two ways in which pseudo-random number generation canfail: the seed could be bad or the algorithm itself could be weak and predictable.</p><h3>Random Numbers Everywhere</h3><p>The Hacker News example isn&#39;t about cryptography itself, but random numbers are vital to cryptographic schemes. For example, any HTTPS session starts as follows:</p><ol><li><p>The web browser sends information to the server about which version of SSL it wants to use and other information.</p></li><li><p>The web server replies with similar information about SSL versions and its SSL certificate.</p></li><li><p>The web browser checks that the certificate is valid. If it is, it generates a random &#39;pre-main secret&#39; that will be used to secure the connection.</p></li></ol><p>After that further exchanges occur all based on the randomly chosen pre-main secret. It needs to be unpredictable for the connection to be secure.</p><p>Here&#39;s part of how a computer using WiFi establishes a secure connection to an access point using the popular <a href=\"https://en.wikipedia.org/wiki/IEEE_802.11i-2004\">WPA2</a> protocol:</p><ol><li><p>The access point generates a random <a href=\"https://en.wikipedia.org/wiki/Cryptographic_nonce\">nonce</a> and sends it to the computer.</p></li><li><p>The computer generates a random nonce and sends it to the access point.</p></li></ol><p>The access point and the computer continue on from there using thoserandom nonce values to secure the connection.</p><p>Similarly, random numbers turn up when logging into web sites (and other systems), creating secure connections to servers using <a href=\"https://www.cloudflare.com/learning/access-management/what-is-ssh/\">SSH</a>, holding Skype video chats, sending encrypted email and more.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/1KwL1vFVT6Od93yDW5X3vv/3a3ff46afeb4c5b469f6089a0f9537d1/otp.jpg\" alt=\"Soviet one-time pad\" class=\"kg-image\" width=\"410\" height=\"586\" loading=\"lazy\"/>\n            \n            </figure><p>And the Achilles&#39; Heel of the only completely secure cryptosystem, the <a href=\"https://en.wikipedia.org/wiki/One_time_pad\">one-time pad</a> is that the pad itself must be completely randomly generated. Any predictability or non-uniformity in the random numbers used can lead to breaking of a one-time pad. (The other problem with one-time pads is reuse: they must be used <a href=\"https://en.wikipedia.org/wiki/VENONA#Breakthrough\">only once</a>.)</p><h3>CloudFlare&#39;s Random Number Source</h3><p>At CloudFlare we need lots of random numbers for cryptographic purposes: we need them to secure SSL connections, <a href=\"/cacheing-the-uncacheable-cloudflares-railgun-73454\">Railgun</a>, generating public/private key pairs, and authentication systems. They are an important part of <a href=\"/staying-on-top-of-tls-attacks\">forward secrecy</a> which we&#39;ve rolled out for all our customers.</p><p>We currently obtain most of our random numbers from either OpenSSL&#39;s random number generation system or from the Linux kernel. Both seed their random number generators from a variety of sources to make them as unpredictable as possible. Sources include things like network data, or the seek time of disks. But we think we can improve on them by adding some truly random data into the system, and, as a result, improve security for our customers.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/Bo57TId78978Kd8s8Dgjz/3a7610396816c48153238008f7d09d8b/neuromancer.jpg\" alt=\"The sky above the port was the color of television, tuned to a dead channel\" class=\"kg-image\" width=\"796\" height=\"574\" loading=\"lazy\"/>\n            \n            </figure><p>We&#39;ve embarked on a project to further improve our random numbers by providing a source of truly random numbers that don&#39;t come from a mathematical process. That can be done using things like <a href=\"http://www.fourmilab.ch/hotbits/\">radioactive decay</a>, the <a href=\"https://en.wikipedia.org/wiki/Lavarand\">motion of fluids</a>, <a href=\"http://www.random.org/\">atmospheric noise</a>, or <a href=\"http://www.lavarnd.org/what/process.html\">other chaos</a>.</p><p>We&#39;ll be posting details of the new system when it&#39;s online.</p>",
		"id": "6D2ij17DcToFvDkYUgxYAU",
		"localeList": {
			"name": "Why secure systems require random numbers Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2013-09-13T07:00:00.000+01:00",
		"slug": "why-randomness-matters",
		"tags": [
			{
				"id": "1HblPaFreDjetoJDJPjTAi",
				"name": "SSL",
				"slug": "ssl"
			},
			{
				"id": "3BWeMuiOShelE7QM48sW9j",
				"name": "Privacy",
				"slug": "privacy"
			},
			{
				"id": "5kIxDMJCg3PXQxVINDL0Cw",
				"name": "Attacks",
				"slug": "attacks"
			}
		],
		"title": "Why secure systems require random numbers",
		"updated_at": "2024-08-27T02:44:49.868Z",
		"url": "https://blog.cloudflare.com/why-randomness-matters"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}