<div class="mb2 gray5">8 min read</div>
<div class="mt4">This post is also available in <a href="https://blog.cloudflare.com/pl-pl/disrupting-flyingyeti-campaign-targeting-ukraine">Polski</a>.</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/3rw5MM4LFMt3oQHaBgSslV/ac0df9aba8452224eea458a26267534a/image1-14.png" alt="Disrupting FlyingYeti's campaign targeting Ukraine" class="kg-image" width="1200" height="675" loading="lazy">

	</figure>
	<p>Cloudforce One is publishing the results of our investigation and real-time effort to detect, deny, degrade, disrupt, and delay threat activity by the Russia-aligned threat actor FlyingYeti during their latest phishing campaign targeting Ukraine. At the onset of Russia’s invasion of Ukraine on February 24, 2022, Ukraine introduced a moratorium on evictions and termination of utility services for unpaid debt. The moratorium ended in January 2024, resulting in significant debt liability and increased financial stress for Ukrainian citizens. The FlyingYeti campaign capitalized on anxiety over the potential loss of access to housing and utilities by enticing targets to open malicious files via debt-themed lures. If opened, the files would result in infection with the PowerShell malware known as <a href="https://cert.gov.ua/article/6277849">COOKBOX</a>, allowing FlyingYeti to support follow-on objectives, such as installation of additional payloads and control over the victim’s system.</p>
	<p>Since April 26, 2024, Cloudforce One has taken measures to prevent FlyingYeti from launching their phishing campaign – a campaign involving the use of Cloudflare Workers and GitHub, as well as exploitation of the WinRAR vulnerability <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-38831">CVE-2023-38831</a>. Our countermeasures included internal actions, such as detections and code takedowns, as well as external collaboration with third parties to remove the actor’s cloud-hosted malware. Our effectiveness against this actor prolonged their operational timeline from days to weeks. For example, in a single instance, FlyingYeti spent almost eight hours debugging their code as a result of our mitigations. By employing proactive defense measures, we successfully stopped this determined threat actor from achieving their objectives.</p>
	<h3>Executive Summary</h3>
	<ul>
		<li>
			<p>On April 18, 2024, Cloudforce One detected the Russia-aligned threat actor FlyingYeti preparing to launch a phishing espionage campaign targeting individuals in Ukraine.</p>
		</li>
		<li>
			<p>We discovered the actor used similar tactics, techniques, and procedures (TTPs) as those detailed in <a href="https://cert.gov.ua/article/6278620">Ukranian CERT's article on UAC-0149</a>, a threat group that has primarily <a href="https://cert.gov.ua/article/6277849">targeted Ukrainian defense entities with COOKBOX malware since at least the fall of 2023</a>.</p>
		</li>
		<li>
			<p>From mid-April to mid-May, we observed FlyingYeti conduct reconnaissance activity, create lure content for use in their phishing campaign, and develop various iterations of their malware. We assessed that the threat actor intended to launch their campaign in early May, likely following Orthodox Easter.</p>
		</li>
		<li>
			<p>After several weeks of monitoring actor reconnaissance and weaponization activity (<a href="https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html">Cyber Kill Chain Stages 1 and 2</a>), we successfully disrupted FlyingYeti’s operation moments after the final COOKBOX payload was built.</p>
		</li>
		<li>
			<p>The payload included an exploit for the WinRAR vulnerability CVE-2023-38831, which FlyingYeti will likely continue to use in their phishing campaigns to infect targets with malware.</p>
		</li>
		<li>
			<p>We offer steps users can take to defend themselves against FlyingYeti phishing operations, and also provide recommendations, detections, and indicators of compromise.</p>
		</li>
	</ul>
	<h2>Who is FlyingYeti?</h2>
	<p>FlyingYeti is the <a href="https://www.merriam-webster.com/dictionary/cryptonym">cryptonym</a> given by <a href="https://blog.cloudflare.com/introducing-cloudforce-one-threat-operations-and-threat-research">Cloudforce One</a> to the threat group behind this phishing campaign, which overlaps with UAC-0149 activity tracked by <a href="https://cert.gov.ua">CERT-UA</a> in <a href="https://cert.gov.ua/article/6277849">February</a> and <a href="https://cert.gov.ua/article/6278620">April</a> 2024. The threat actor uses dynamic DNS (<a href="https://www.cloudflare.com/learning/dns/glossary/dynamic-dns">DDNS</a>) for their infrastructure and leverages cloud-based platforms for hosting malicious content and for malware command and control (C2). Our investigation of FlyingYeti TTPs suggests this is likely a Russia-aligned threat group. The actor appears to primarily focus on targeting Ukrainian military entities. Additionally, we observed Russian-language comments in FlyingYeti’s code, and the actor’s operational hours falling within the UTC+3 time zone.</p>
	<h2>Campaign background</h2>
	<p>In the days leading up to the start of the campaign, Cloudforce One observed FlyingYeti conducting reconnaissance on payment processes for Ukrainian communal housing and utility services:</p>
	<ul>
		<li>
			<p>April 22, 2024 – research into changes made in 2016 that introduced the use of QR codes in payment notices</p>
		</li>
		<li>
			<p>April 22, 2024 – research on current developments concerning housing and utility debt in Ukraine</p>
		</li>
		<li>
			<p>April 25, 2024 – research on the legal basis for restructuring housing debt in Ukraine as well as debt involving utilities, such as gas and electricity</p>
		</li>
	</ul>
	<p>Cloudforce One judges that the observed reconnaissance is likely due to the Ukrainian government’s payment moratorium introduced at the start of the full-fledged invasion in February 2022. Under this moratorium, outstanding debt would not lead to evictions or termination of provision of utility services. However, on January 9, 2024, the <a href="https://en.interfax.com.ua/news/economic/959388.html">government lifted this ban</a>, resulting in increased pressure on Ukrainian citizens with outstanding debt. FlyingYeti sought to capitalize on that pressure, leveraging debt restructuring and payment-related lures in an attempt to increase their chances of successfully targeting Ukrainian individuals.</p>
	<h2>Analysis of the Komunalka-themed phishing site</h2>
	<p>The disrupted phishing campaign would have directed FlyingYeti targets to an actor-controlled GitHub page at hxxps[:]//komunalka[.]github[.]io, which is a spoofed version of the Kyiv Komunalka communal housing site <a href="https://www.komunalka.ua">https://www.komunalka.ua</a>. Komunalka functions as a payment processor for residents in the Kyiv region and allows for payment of utilities, such as gas, electricity, telephone, and Internet. Additionally, users can pay other fees and fines, and even donate to Ukraine’s defense forces.</p>
	<p>Based on past FlyingYeti operations, targets may be directed to the actor’s Github page via a link in a phishing email or an encrypted Signal message. If a target accesses the spoofed Komunalka platform at hxxps[:]//komunalka[.]github[.]io, the page displays a large green button with a prompt to download the document “Рахунок.docx” (“Invoice.docx”), as shown in Figure 1. This button masquerades as a link to an overdue payment invoice but actually results in the download of the malicious archive “Заборгованість по ЖКП.rar” (“Debt for housing and utility services.rar”).</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/22Rnm7YOnwnJocG98RMFDa/14466c9a091580c21521e6941729b842/image4-5.png" alt="" class="kg-image" width="1999" height="868" loading="lazy">

	</figure>
	<p>Figure 1: Prompt to download malicious archive “Заборгованість по ЖКП.rar”</p>
	<p>A series of steps must take place for the download to successfully occur:</p>
	<ul>
		<li>
			<p>The target clicks the green button on the actor’s GitHub page hxxps[:]//komunalka.github[.]io</p>
		</li>
		<li>
			<p>The target’s device sends an HTTP POST request to the Cloudflare Worker worker-polished-union-f396[.]vqu89698[.]workers[.]dev with the HTTP request body set to “user=Iahhdr”</p>
		</li>
		<li>
			<p>The Cloudflare Worker processes the request and evaluates the HTTP request body</p>
		</li>
		<li>
			<p>If the request conditions are met, the Worker fetches the RAR file from hxxps[:]//raw[.]githubusercontent[.]com/kudoc8989/project/main/Заборгованість по ЖКП.rar, which is then downloaded on the target’s device</p>
		</li>
	</ul>
	<p>Cloudforce One identified the infrastructure responsible for facilitating the download of the malicious RAR file and remediated the actor-associated Worker, preventing FlyingYeti from delivering its malicious tooling. In an effort to circumvent Cloudforce One's mitigation measures, FlyingYeti later changed their malware delivery method. Instead of the Workers domain fetching the malicious RAR file, it was loaded directly from GitHub.</p>
	<h2>Analysis of the malicious RAR file</h2>
	<p>During remediation, Cloudforce One recovered the RAR file “Заборгованість по ЖКП.rar” and performed analysis of the malicious payload. The downloaded RAR archive contains multiple files, including a file with a name that contains the unicode character “U+201F”. This character appears as whitespace on Windows devices and can be used to “hide” file extensions by adding excessive whitespace between the filename and the file extension. As highlighted in blue in Figure 2, this cleverly named file within the RAR archive appears to be a PDF document but is actually a malicious CMD file (“Рахунок на оплату.pdf[unicode character U+201F].cmd”).</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/55Vjmg9VLEnAFv3RZQoZ2l/35dd1d82a2570b0e4c4a0c1dd7ac6998/image2-11.png" alt="" class="kg-image" width="1999" height="480" loading="lazy">

	</figure>
	<p>Figure 2: Files contained in the malicious RAR archive “Заборгованість по ЖКП.rar” (“Housing Debt.rar”)</p>
	<p>FlyingYeti included a benign PDF in the archive with the same name as the CMD file but without the unicode character, “Рахунок на оплату.pdf” (“Invoice for payment.pdf”). Additionally, the directory name for the archive once decompressed also contained the name “Рахунок на оплату.pdf”. This overlap in names of the benign PDF and the directory allows the actor to exploit the WinRAR vulnerability <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-38831">CVE-2023-38831</a>. More specifically, when an archive includes a benign file with the same name as the directory, the entire contents of the directory are opened by the WinRAR application, resulting in the execution of the malicious CMD. In other words, when the target believes they are opening the benign PDF “Рахунок на оплату.pdf”, the malicious CMD file is executed.</p>
	<p>The CMD file contains the FlyingYeti PowerShell malware known as <a href="https://cert.gov.ua/article/6277849">COOKBOX</a>. The malware is designed to persist on a host, serving as a foothold in the infected device. Once installed, this variant of COOKBOX will make requests to the DDNS domain postdock[.]serveftp[.]com for C2, awaiting PowerShell <a href="https://learn.microsoft.com/en-us/powershell/scripting/powershell-commands?view=powershell-7.4">cmdlets</a> that the malware will subsequently run.</p>
	<p>Alongside COOKBOX, several decoy documents are opened, which contain hidden tracking links using the <a href="https://canarytokens.com/generate">Canary Tokens</a> service. The first document, shown in Figure 3 below, poses as an agreement under which debt for housing and utility services will be restructured.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/20vFV9kNTMmwxFXvpQoJTc/861fd0b9b4744a3063126e76ef28fa8e/image5-10.png" alt="" class="kg-image" width="1999" height="879" loading="lazy">

	</figure>
	<p>Figure 3: Decoy document Реструктуризація боргу за житлово комунальні послуги.docx</p>
	<p>The second document (Figure 4) is a user agreement outlining the terms and conditions for the usage of the payment platform komunalka[.]ua.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/1VHSTwqfrXWXvoryg8lOcE/aa84387d5471398b7097f11e03441c7e/image3-6.png" alt="" class="kg-image" width="1104" height="646" loading="lazy">

	</figure>
	<p>Figure 4: Decoy document Угода користувача.docx <i>(User Agreement.docx)</i></p>
	<p>The use of relevant decoy documents as part of the phishing and delivery activity are likely an effort by FlyingYeti operators to increase the appearance of legitimacy of their activities.</p>
	<p>The phishing theme we identified in this campaign is likely one of many themes leveraged by this actor in a larger operation to target Ukrainian entities, in particular their defense forces. In fact, the threat activity we detailed in this blog uses many of the same techniques outlined in a <a href="https://cert.gov.ua/article/6278620">recent FlyingYeti campaign</a> disclosed by CERT-UA in mid-April 2024, where the actor leveraged United Nations-themed lures involving Peace Support Operations to target Ukraine’s military. Due to Cloudforce One’s defensive actions covered in the next section, this latest FlyingYeti campaign was prevented as of the time of publication.</p>
	<h2>Mitigating FlyingYeti activity</h2>
	<p>Cloudforce One mitigated FlyingYeti’s campaign through a series of actions. Each action was taken to increase the actor’s cost of continuing their operations. When assessing which action to take and why, we carefully weighed the pros and cons in order to provide an effective active defense strategy against this actor. Our general goal was to increase the amount of time the threat actor spent trying to develop and weaponize their campaign.</p>
	<p>We were able to successfully extend the timeline of the threat actor’s operations from hours to weeks. At each interdiction point, we assessed the impact of our mitigation to ensure the actor would spend more time attempting to launch their campaign. Our mitigation measures disrupted the actor’s activity, in one instance resulting in eight additional hours spent on debugging code.</p>
	<p>Due to our proactive defense efforts, FlyingYeti operators adapted their tactics multiple times in their attempts to launch the campaign. The actor originally intended to have the Cloudflare Worker fetch the malicious RAR file from GitHub. After Cloudforce One interdiction of the Worker, the actor attempted to create additional Workers via a new account. In response, we disabled all Workers, leading the actor to load the RAR file directly from GitHub. Cloudforce One notified GitHub, resulting in the takedown of the RAR file, the GitHub project, and suspension of the account used to host the RAR file. In return, FlyingYeti began testing the option to host the RAR file on the file sharing sites <a href="https://pixeldrain.com">pixeldrain</a> and <a href="https://www.filemail.com">Filemail</a>, where we observed the actor alternating the link on the Komunalka phishing site between the following:</p>
	<ul>
		<li>
			<p>hxxps://pixeldrain[.]com/api/file/ZAJxwFFX?download=one</p>
		</li>
		<li>
			<p>hxxps://1014.filemail[.]com/api/file/get?filekey=e_8S1HEnM5Rzhy_jpN6nL-GF4UAP533VrXzgXjxH1GzbVQZvmpFzrFA&amp;pk_vid=a3d82455433c8ad11715865826cf18f6</p>
		</li>
	</ul>
	<p>We notified GitHub of the actor’s evolving tactics, and in response GitHub removed the Komunalka phishing site. After analyzing the files hosted on pixeldrain and Filemail, we determined the actor uploaded dummy payloads, likely to monitor access to their phishing infrastructure (FileMail logs IP addresses, and both file hosting sites provide view and download counts). At the time of publication, we did not observe FlyingYeti upload the malicious RAR file to either file hosting site, nor did we identify the use of alternative phishing or malware delivery methods.</p>
	<p>A timeline of FlyingYeti’s activity and our corresponding mitigations can be found below.</p>
	<h3>Event timeline</h3><!--kg-card-begin: html-->
	<style type="text/css">
		.tg {
			border-collapse: collapse;
			border-spacing: 0;
			margin: 0px auto;
		}

		.tg td {
			border-color: black;
			border-style: solid;
			border-width: 1px;
			font-family: Arial, sans-serif;
			font-size: 14px;
			overflow: hidden;
			padding: 10px 5px;
			word-break: normal;
		}

		.tg th {
			border-color: black;
			border-style: solid;
			border-width: 1px;
			font-family: Arial, sans-serif;
			font-size: 14px;
			font-weight: normal;
			overflow: hidden;
			padding: 10px 5px;
			word-break: normal;
		}

		.tg .tg-tlx9 {
			background-color: #FFF;
			color: #333;
			text-align: center;
			vertical-align: top
		}

		.tg .tg-citn {
			background-color: #FFF;
			color: #333;
			text-align: left;
			vertical-align: top
		}

		.tg .tg-s1pt {
			background-color: #D9D9D9;
			color: #333;
			font-weight: bold;
			text-align: center;
			vertical-align: top
		}

		@media screen and (max-width: 767px) {
			.tg {
				width: auto !important;
			}

			.tg col {
				width: auto !important;
			}

			.tg-wrap {
				overflow-x: auto;
				-webkit-overflow-scrolling: touch;
				margin: auto 0px;
			}
		}
	</style>
	<div class="tg-wrap">
		<table class="tg" style="undefined;table-layout: fixed; width: 702px">
			<colgroup>
				<col style="width: 200.88889px">
				<col style="width: 500.88889px">
			</colgroup>
			<thead>
				<tr>
					<th class="tg-s1pt"><span style="font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Date</span></th>
					<th class="tg-s1pt"><span style="font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Event Description</span></th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-18 12:18</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Threat Actor (TA) creates a Worker to handle requests from a phishing site</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-18 14:16</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA creates phishing site komunalka[.]github[.]io on GitHub</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-25 12:25</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA creates a GitHub repo to host a RAR file</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-26 07:46</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA updates the first Worker to handle requests from users visiting komunalka[.]github[.]io</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-26 08:24</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA uploads a benign test RAR to the GitHub repo</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-26 13:38</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One identifies a Worker receiving requests from users visiting komunalka[.]github[.]io, observes its use as a phishing page</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-26 13:46</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One identifies that the Worker fetches a RAR file from GitHub (the malicious RAR payload is not yet hosted on the site)</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-26 19:22</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One creates a detection to identify the Worker that fetches the RAR</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-04-26 21:13</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One deploys real-time monitoring of the RAR file on GitHub</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-02 06:35</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA deploys a weaponized RAR (CVE-2023-38831) to GitHub with their COOKBOX malware packaged in the archive</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-06 10:03</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA attempts to update the Worker with link to weaponized RAR, the Worker is immediately blocked</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-06 10:38</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA creates a new Worker, the Worker is immediately blocked</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-06 11:04</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA creates a new account (#2) on Cloudflare</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-06 11:06</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA creates a new Worker on account #2 (blocked)</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-06 11:50</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA creates a new Worker on account #2 (blocked)</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-06 12:22</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA creates a new modified Worker on account #2</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-06 16:05</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One disables the running Worker on account #2</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-07 22:16</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA notices the Worker is blocked, ceases all operations</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-07 22:18</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA deletes original Worker first created to fetch the RAR file from the GitHub phishing page</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-09 19:28</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One adds phishing page komunalka[.]github[.]io to real-time monitoring</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-13 07:36</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA updates the github.io phishing site to point directly to the GitHub RAR link</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-13 17:47</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One adds COOKBOX C2 postdock[.]serveftp[.]com to real-time monitoring for DNS resolution</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-14 00:04</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One notifies GitHub to take down the RAR file</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-15 09:00</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">GitHub user, project, and link for RAR are no longer accessible</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-21 08:23</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA updates Komunalka phishing site on github.io to link to pixeldrain URL for dummy payload (pixeldrain only tracks view and download counts)</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-21 08:25</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">TA updates Komunalka phishing site to link to FileMail URL for dummy payload (FileMail tracks not only view and download counts, but also IP addresses)</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-21 12:21</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One downloads PixelDrain document to evaluate payload</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-21 12:47</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One downloads FileMail document to evaluate payload</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-29 23:59</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">GitHub takes down Komunalka phishing site</span></td>
				</tr>
				<tr>
					<td class="tg-tlx9"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">2024-05-30 13:00</span></td>
					<td class="tg-citn"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Cloudforce One publishes the results of this investigation</span></td>
				</tr>
			</tbody>
		</table>
	</div><!--kg-card-end: html-->
	<h2>Coordinating our FlyingYeti response</h2>
	<p>Cloudforce One leveraged industry relationships to provide advanced warning and to mitigate the actor’s activity. To further protect the intended targets from this phishing threat, Cloudforce One notified and collaborated closely with GitHub’s Threat Intelligence and Trust and Safety Teams. We also notified CERT-UA and Cloudflare industry partners such as CrowdStrike, Mandiant/Google Threat Intelligence, and Microsoft Threat Intelligence.</p>
	<h3>Hunting FlyingYeti operations</h3>
	<p>There are several ways to hunt FlyingYeti in your environment. These include using PowerShell to hunt for WinRAR files, deploying Microsoft Sentinel analytics rules, and running Splunk scripts as detailed below. Note that these detections may identify activity related to this threat, but may also trigger unrelated threat activity.</p>
	<h3>PowerShell hunting</h3>
	<p>Consider running a PowerShell script such as <a href="https://github.com/IR-HuntGuardians/CVE-2023-38831-HUNT/blob/main/hunt-script.ps1">this one</a> in your environment to identify exploitation of CVE-2023-38831. This script will interrogate WinRAR files for evidence of the exploit.</p>
	<pre class="language-bash"><code class="language-bash">CVE-2023-38831
Description:winrar exploit detection 
open suspios (.tar / .zip / .rar) and run this script to check it 

function winrar-exploit-detect(){
$targetExtensions = @(".cmd" , ".ps1" , ".bat")
$tempDir = [System.Environment]::GetEnvironmentVariable("TEMP")
$dirsToCheck = Get-ChildItem -Path $tempDir -Directory -Filter "Rar*"
foreach ($dir in $dirsToCheck) {
    $files = Get-ChildItem -Path $dir.FullName -File
    foreach ($file in $files) {
        $fileName = $file.Name
        $fileExtension = [System.IO.Path]::GetExtension($fileName)
        if ($targetExtensions -contains $fileExtension) {
            $fileWithoutExtension = [System.IO.Path]::GetFileNameWithoutExtension($fileName); $filename.TrimEnd() -replace '\.$'
            $cmdFileName = "$fileWithoutExtension"
            $secondFile = Join-Path -Path $dir.FullName -ChildPath $cmdFileName
            
            if (Test-Path $secondFile -PathType Leaf) {
                Write-Host "[!] Suspicious pair detected "
                Write-Host "[*]  Original File:$($secondFile)" -ForegroundColor Green 
                Write-Host "[*] Suspicious File:$($file.FullName)" -ForegroundColor Red

                # Read and display the content of the command file
                $cmdFileContent = Get-Content -Path $($file.FullName)
                Write-Host "[+] Command File Content:$cmdFileContent"
            }
        }
    }
}
}
winrar-exploit-detect</code></pre>
	<h3></h3>
	<p>Microsoft Sentinel</p>
	<p>In Microsoft Sentinel, consider deploying the rule provided below, which identifies WinRAR execution via cmd.exe. Results generated by this rule may be indicative of attack activity on the endpoint and should be analyzed.</p>
	<pre class="language-bash"><code class="language-bash">DeviceProcessEvents
| where InitiatingProcessParentFileName has @"winrar.exe"
| where InitiatingProcessFileName has @"cmd.exe"
| project Timestamp, DeviceName, FileName, FolderPath, ProcessCommandLine, AccountName
| sort by Timestamp desc</code></pre>
	<h3></h3>
	<p>Splunk</p>
	<p>Consider using <a href="https://research.splunk.com/endpoint/d2f36034-37fa-4bd4-8801-26807c15540f">this script</a> in your Splunk environment to look for WinRAR CVE-2023-38831 execution on your Microsoft endpoints. Results generated by this script may be indicative of attack activity on the endpoint and should be analyzed.</p>
	<pre class="language-bash"><code class="language-bash">| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process_name=winrar.exe `windows_shells` OR Processes.process_name IN ("certutil.exe","mshta.exe","bitsadmin.exe") by Processes.dest Processes.user Processes.parent_process_name Processes.parent_process Processes.process_name Processes.process Processes.process_id Processes.parent_process_id 
| `drop_dm_object_name(Processes)` 
| `security_content_ctime(firstTime)` 
| `security_content_ctime(lastTime)` 
| `winrar_spawning_shell_application_filter`</code></pre>
	<h2>Cloudflare product detections</h2>
	<h3>Cloudflare Email Security</h3>
	<p>Cloudflare Email Security (CES) customers can identify FlyingYeti threat activity with the following detections.</p>
	<ul>
		<li>
			<p>CVE-2023-38831</p>
		</li>
		<li>
			<p>FLYINGYETI.COOKBOX</p>
		</li>
		<li>
			<p>FLYINGYETI.COOKBOX.Launcher</p>
		</li>
		<li>
			<p>FLYINGYETI.Rar</p>
		</li>
	</ul>
	<h2>Recommendations</h2>
	<p>Cloudflare recommends taking the following steps to mitigate this type of activity:</p>
	<ul>
		<li>
			<p>Implement Zero Trust architecture foundations: &nbsp; &nbsp;</p>
		</li>
		<li>
			<p>Deploy Cloud Email Security to ensure that email services are protected against phishing, BEC and other threats</p>
		</li>
		<li>
			<p>Leverage browser isolation to separate messaging applications like LinkedIn, email, and Signal from your main network</p>
		</li>
		<li>
			<p>Scan, monitor and/or enforce controls on specific or sensitive data moving through your network environment with data loss prevention policies</p>
		</li>
		<li>
			<p>Ensure your systems have the latest WinRAR and Microsoft security updates installed</p>
		</li>
		<li>
			<p>Consider preventing WinRAR files from entering your environment, both at your Cloud Email Security solution and your Internet Traffic Gateway</p>
		</li>
		<li>
			<p>Run an Endpoint Detection and Response (EDR) tool such as CrowdStrike or Microsoft Defender for Endpoint to get visibility into binary execution on hosts</p>
		</li>
		<li>
			<p>Search your environment for the FlyingYeti indicators of compromise (IOCs) shown below to identify potential actor activity within your network.</p>
		</li>
	</ul>
	<p>If you’re looking to uncover additional Threat Intelligence insights for your organization or need bespoke Threat Intelligence information for an incident, consider engaging with Cloudforce One by contacting your Customer Success manager or filling out <a href="https://www.cloudflare.com/zero-trust/lp/cloudforce-one-threat-intel-subscription">this form</a>.</p>
	<h2>Indicators of Compromise</h2><!--kg-card-begin: html-->
	<style type="text/css">
		.tg {
			border-collapse: collapse;
			border-spacing: 0;
			margin: 0px auto;
		}

		.tg td {
			border-color: black;
			border-style: solid;
			border-width: 1px;
			font-family: Arial, sans-serif;
			font-size: 14px;
			overflow: hidden;
			padding: 10px 5px;
			word-break: normal;
		}

		.tg th {
			border-color: black;
			border-style: solid;
			border-width: 1px;
			font-family: Arial, sans-serif;
			font-size: 14px;
			font-weight: normal;
			overflow: hidden;
			padding: 10px 5px;
			word-break: normal;
		}

		.tg .tg-jut8 {
			background-color: #CCC;
			font-weight: bold;
			text-align: center;
			vertical-align: top
		}

		.tg .tg-0lax {
			text-align: left;
			vertical-align: top
		}

		@media screen and (max-width: 767px) {
			.tg {
				width: auto !important;
			}

			.tg col {
				width: auto !important;
			}

			.tg-wrap {
				overflow-x: auto;
				-webkit-overflow-scrolling: touch;
				margin: auto 0px;
			}
		}
	</style>
	<div class="tg-wrap">
		<table class="tg" style="undefined;table-layout: fixed; width: 702px">
			<colgroup>
				<col style="width: 500.88889px">
				<col style="width: 200.88889px">
			</colgroup>
			<thead>
				<tr>
					<th class="tg-jut8"><span style="font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Domain / URL</span></th>
					<th class="tg-jut8"><span style="font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Description</span></th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">komunalka[.]github[.]io</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Phishing page</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">hxxps[:]//github[.]com/komunalka/komunalka[.]github[.]io</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Phishing page</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">hxxps[:]//worker-polished-union-f396[.]vqu89698[.]workers[.]dev</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Worker that fetches malicious RAR file</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">hxxps[:]//raw[.]githubusercontent[.]com/kudoc8989/project/main/Заборгованість по ЖКП.rar</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Delivery of malicious RAR file</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">hxxps[:]//1014[.]filemail[.]com/api/file/get?filekey=e_8S1HEnM5Rzhy_jpN6nL-GF4UAP533VrXzgXjxH1GzbVQZvmpFzrFA&amp;pk_vid=a3d82455433c8ad11715865826cf18f6</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Dummy payload</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">hxxps[:]//pixeldrain[.]com/api/file/ZAJxwFFX?download=</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Dummy payload</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">hxxp[:]//canarytokens[.]com/stuff/tags/ni1cknk2yq3xfcw2al3efs37m/payments.js</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Tracking link</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">hxxp[:]//canarytokens[.]com/stuff/terms/images/k22r2dnjrvjsme8680ojf5ccs/index.html</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Tracking link</span></td>
				</tr>
				<tr>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">postdock[.]serveftp[.]com</span></td>
					<td class="tg-0lax"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">COOKBOX C2</span></td>
				</tr>
			</tbody>
		</table>
	</div><!--kg-card-end: html-->
</div>