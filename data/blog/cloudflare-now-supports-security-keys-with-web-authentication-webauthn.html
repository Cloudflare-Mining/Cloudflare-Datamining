<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/03/Harware-security-keys@2x-6.png" class="kg-image"></figure>
	<p>We’re excited to announce that Cloudflare now supports security keys as a two factor authentication (2FA) method for all users. Cloudflare customers now have the ability to use security keys on WebAuthn-supported browsers to log into their user accounts. We strongly suggest users configure multiple security keys and 2FA methods on their account in order to access their apps from various devices and browsers. If you want to get started with security keys, visit your <a href="https://dash.cloudflare.com/profile/authentication" target="_blank">account's 2FA settings</a>.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/03/image4-5.png" class="kg-image"></figure>
	<h3 id="what-is-webauthn">What is WebAuthn?</h3>
	<p>WebAuthn is a standardized protocol for authentication online using public key cryptography. It is part of the <a href="https://fidoalliance.org/fido2/" target="_blank">FIDO2 Project</a> and is backwards compatible with <a href="https://fidoalliance.org/specs/u2f-specs-master/fido-u2f-overview.html" target="_blank">FIDO U2F</a>. Depending on your device and browser, you can use hardware security keys (like YubiKeys) or built-in biometric support (like Apple Touch ID) to authenticate to your Cloudflare user account as a second factor. WebAuthn support is rapidly increasing among browsers and devices, and we’re proud to join the growing list of services that offer this feature.</p>
	<p>To use WebAuthn, a user registers their security key, or “authenticator”, to a supporting application, or “relying party” (in this case Cloudflare). The authenticator then generates and securely stores a public/private keypair on the device. The keypair is scoped to a specific domain and user account. The authenticator then sends the public key to the relying party, who stores it. A user may have multiple authenticators registered with the same relying party. In fact, it’s strongly encouraged for a user to do so in case an authenticator is lost or broken.</p>
	<p>When a user logs into their account, the relying party will issue a randomly generated byte sequence called a “challenge”. The authenticator will prompt the user for “interaction” in the form of a tap, touch or PIN before signing the challenge with the stored private key and sending it back to the relying party. The relying party evaluates the signed challenge against the public key(s) it has stored associated with the user, and if the math adds up the user is authenticated! To learn more about how WebAuthn works, take a look at the <a href="https://www.w3.org/TR/webauthn/" target="_blank">official documentation</a>.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/03/image1-9.png" class="kg-image"></figure>
	<h3 id="how-is-webauthn-different-from-other-2fa-methods">How is WebAuthn different from other 2FA methods?</h3>
	<p>There’s a lot of hype about WebAuthn, and rightfully so. But there are some common misconceptions about how WebAuthn actually works, so I wanted to take some time to explain why it’s so effective against various credential-based attacks.</p>
	<p>First, WebAuthn relies on a “physical thing you have” rather than an app or a phone number, which makes it a lot harder for a remote attacker to impersonate a victim. This assumption prevents common exploits like <a href="https://en.wikipedia.org/wiki/SIM_swap_scam" target="_blank">SIM swapping</a>, which is an attack used to bypass SMS-based verification. In contrast, an attacker physically (and cryptographically) cannot “impersonate” a hardware security key unless they have physical access to a victim’s unlocked device.</p>
	<p>WebAuthn is also simpler and quicker to use compared to mobile app-based 2FA methods. Users often complain about the amount of time it takes to reach for their phone, open an app, and copy over an expiring passcode every time they want to log into an account. By contrast, security keys require a simple touch or tap on a piece of hardware that’s often attached to a device.</p>
	<figure class="kg-card kg-gallery-card kg-width-wide kg-card-hascaption">
		<div class="kg-gallery-container">
			<div class="kg-gallery-row">
				<div class="kg-gallery-image"><img src="https://blog.cloudflare.com/content/images/2020/03/safari-3.png" width="400" height="691"></div>
				<div class="kg-gallery-image"><img src="https://blog.cloudflare.com/content/images/2020/03/brave-3.png" width="400" height="690"></div>
				<div class="kg-gallery-image"><img src="https://blog.cloudflare.com/content/images/2020/03/chrome-3.png" width="400" height="751"></div>
			</div>
		</div>
		<figcaption>Safari | Brave | Chrome for Android</figcaption>
	</figure>
	<p>But where WebAuthn really shines is its particular resistance to phishing attacks. Phishing often requires an attacker to construct a believable fake replica of a target site. For example, an attacker could try to register cloudfare[.]com (notice the typo!) and construct a site that looks similar to the genuine cloudflare[.]com. The attacker might then try to trick a victim into logging into the fake site and disclosing their credentials. Even if the victim has mobile app <a href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm" target="_blank">TOTP</a> authentication enabled, a sophisticated attacker can still proxy requests from the fake site to the genuine site and successfully authenticate as the victim. This is the assumption behind powerful on-path attacker tools like <a href="https://github.com/kgretzky/evilginx2" target="_blank">evilginx</a>.</p>
	<p>WebAuthn prevents users from falling victim to common phishing and on-path attacker attacks because it takes the domain name into consideration when creating user credentials. When an authenticator creates the public/private keypair, it is specifically scoped to a particular account and domain. So let’s say a user with WebAuthn configured navigates to the phishy cloudfare[.]com site. When the phishy site prompts the authenticator to sign its challenge, the authenticator will attempt to find credentials for that phishy site’s domain and, upon failing to find any, will error and prevent the user from logging in. This is why hardware security keys are among the most secure authentication methods in existence today according to <a href="https://security.googleblog.com/2019/05/new-research-how-effective-is-basic.html" target="_blank">research by Google</a>. </p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/03/image3-4.png" class="kg-image"></figure>
	<p>WebAuthn also has <a href="https://www.w3.org/TR/webauthn/#sctn-privacy-considerations" target="_blank">very strict privacy guarantees</a>. &nbsp;If a user authenticates with a biometric key (like Apple TouchID or Windows Hello), the relying party never receives any of that biometric data. The communication between authenticator and client browser is completely separate from the communication between client browser and relying party. WebAuthn also urges relying parties to not disclose user-identifiable information (like email addresses) during registration or authentication. This helps prevent replay or user enumeration attacks. And because credentials are strictly scoped to a particular relying party and domain, a malicious relying party won’t be able to gain information about other relying parties an authenticator has created credentials for in order to track a user’s various accounts.</p>
	<p>Finally, WebAuthn is great for relying parties because they don’t have to store anything additionally sensitive about a user. The relying party simply stores a user’s public key. An attacker who gains access to the public key can’t do much with it because they won’t know the associated private key. This is markedly less risky than TOTP, where a relying party must use proper hygiene to store a TOTP secret seed from which all subsequent time-based user passcodes are generated.</p>
	<h3 id="security-isn-t-always-intuitive">Security isn’t always intuitive</h3>
	<p>Sometimes in the security industry we have the tendency to fixate on new and sophisticated attacks. But often it’s the same old “simple” problems that have the <a href="https://www.rapid7.com/research/report/under-the-hoodie-2019/" target="_blank">highest impact</a>. Two factor authentication is a textbook case where the security industry largely believes a concept is trivial, but the average user still finds it confusing or annoying. WebAuthn addresses this problem because it’s quicker and more secure for the end user compared to other authentication methods. We think the trend towards security key adoption will continue to grow, and we’re looking forward to doing our part to help the effort.</p>
	<p><em>Note: If you login to your Cloudflare user account with Single Sign-On (SSO), you will not have the option to use two factor authentication (2FA). This is because your SSO provider manages your 2FA methods. To learn more about Cloudflare’s 2FA offerings, please visit our </em><a href="https://support.cloudflare.com/hc/en-us/articles/200167906" target="_blank"><em>support center</em></a><em>.</em></p>
</div>