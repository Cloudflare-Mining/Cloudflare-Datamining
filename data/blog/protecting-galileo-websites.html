<div class="post-content lh-copy gray1">
	<p>Yesterday, we celebrated the <a href="https://blog.cloudflare.com/project-galileo-fifth-anniversary/">fifth anniversary of Project Galileo</a>. More than 550 websites are part of this program, and they have something in common: each and every one of them has been subject to attacks in the last month. In this blog post, we will look at the security events we observed between the 23 April 2019 and 23 May 2019.</p>
	<p>Project Galileo sites are protected by the Cloudflare Firewall and Advanced DDoS Protection which contain a number of features that can be used to detect and mitigate different types of attack and suspicious traffic. The following table shows how each of these features contributed to the protection of sites on Project Galileo.</p>
	<p></p>
	<!--kg-card-begin: html-->
	<table class="c58">
		<tbody>
			<tr class="c2">
				<td class="c47" colspan="1" rowspan="1">
					<p class="c29"><span class="c30 c12">Firewall Feature</span></p>
				</td>
				<td class="c53" colspan="1" rowspan="1">
					<p class="c29"><span class="c30 c12">Requests Mitigated</span></p>
				</td>
				<td class="c52" colspan="1" rowspan="1">
					<p class="c29"><span class="c12 c30">Distinct originating IPs</span></p>
				</td>
				<td class="c27" colspan="1" rowspan="1">
					<p class="c29"><span class="c12 c28">Sites Affected</span> <span class="c5">(approx.)</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c25" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://blog.cloudflare.com/announcing-firewall-rules/">Firewall
								Rules</a></span></p>
				</td>
				<td class="c44" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">78.7M</span></p>
				</td>
				<td class="c50" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">396.5K</span></p>
				</td>
				<td class="c42" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 30</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c26" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://support.cloudflare.com/hc/en-us/articles/200170056-What-does-Cloudflare-s-Security-Level-mean" target="_blank">Security
								Level</a></span></p>
				</td>
				<td class="c34" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">41.7M</span></p>
				</td>
				<td class="c32" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">1.8M</span></p>
				</td>
				<td class="c23" colspan="1" rowspan="1">
					<p class="c4"><span class="c28 c12">~ 520</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c25" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://support.cloudflare.com/hc/en-us/articles/217074967-Configuring-IP-Access-Rules" target="_blank">Access
								Rules</a></span></p>
				</td>
				<td class="c41" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">24.0M</span></p>
				</td>
				<td class="c20" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">386.9K</span></p>
				</td>
				<td class="c42" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 200</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c26" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://support.cloudflare.com/hc/en-us/articles/200170086-What-does-the-Browser-Integrity-Check-do" target="_blank">Browser
								Integrity Check</a></span></p>
				</td>
				<td class="c33" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">9.4M</span></p>
				</td>
				<td class="c55" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">32.2K</span></p>
				</td>
				<td class="c23" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 500</span></p>
				</td>
			</tr>
			<tr class="c54">
				<td class="c25" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://www.cloudflare.com/learning/ddos/glossary/web-application-firewall-waf/" target="_blank">WAF</a></span>
					</p>
				</td>
				<td class="c36" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">4.5M</span></p>
				</td>
				<td class="c39" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">163.8K</span></p>
				</td>
				<td class="c42" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 200</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c26" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://support.cloudflare.com/hc/en-us/articles/115001856951-How-do-I-block-malicious-User-Agents-with-Cloudflare" target="_blank">User-Agent
								Blocking</a></span></p>
				</td>
				<td class="c22" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">2.3M</span></p>
				</td>
				<td class="c43" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">1.3K</span></p>
				</td>
				<td class="c23" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 15</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c25" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://support.cloudflare.com/hc/en-us/articles/200170026-What-does-enabling-Cloudflare-Hotlink-Protection-do" target="_blank">Hotlink
								Protection</a></span></p>
				</td>
				<td class="c48" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">2.0M</span></p>
				</td>
				<td class="c15" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">686.7K</span></p>
				</td>
				<td class="c42" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 40</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c26" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://www.cloudflare.com/learning/ddos/ddos-mitigation/" target="_blank">HTTP
								DoS</a></span></p>
				</td>
				<td class="c49" colspan="1" rowspan="1">
					<p class="c4"><span class="c30">1.6M</span></p>
				</td>
				<td class="c57" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">360</span></p>
				</td>
				<td class="c23" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">1</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c25" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://support.cloudflare.com/hc/en-us/articles/235240767-Cloudflare-Rate-Limiting" target="_blank">Rate
								Limit</a></span></p>
				</td>
				<td class="c40" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">623.5K</span></p>
				</td>
				<td class="c46" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">6.6K</span></p>
				</td>
				<td class="c42" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 15</span></p>
				</td>
			</tr>
			<tr class="c2">
				<td class="c26" colspan="1" rowspan="1">
					<p class="c29"><span class="c10"><a class="c21" href="https://support.cloudflare.com/hc/en-us/articles/115001595131-How-do-I-Lockdown-URLs-in-Cloudflare" target="_blank">Zone
								Lockdown</a></span></p>
				</td>
				<td class="c45" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">9.7K</span></p>
				</td>
				<td class="c38" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">2.8K</span></p>
				</td>
				<td class="c23" colspan="1" rowspan="1">
					<p class="c4"><span class="c5">~ 10</span></p>
				</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: html-->
	<p></p>
	<h3 id="waf-web-application-firewall-">WAF (Web Application Firewall)</h3>
	<p>Although not the most impressive in terms of blocked requests, the <a href="https://www.cloudflare.com/learning/ddos/glossary/web-application-firewall-waf/" target="_blank">WAF</a> is the most interesting as it identifies and blocks malicious requests, based on heuristics and rules that are the result of seeing attacks across all of our customers and learning from those. The WAF is available to all of our paying customers, protecting them against 0-days, SQL/XSS exploits and more. For the Project Galileo customers the WAF rules blocked more than <strong>4.5</strong> million requests in the month that we looked at, matching over 130 WAF rules and approximately 150k requests per day.</p>
	<p></p>
	<figure class="kg-card kg-image-card kg-width-full kg-card-hascaption"><img src="https://lh4.googleusercontent.com/AJxk6op83jW6A3LcLLhGJaGFaVpCsBd4ty_K_QhFcnW0_FKXEkJYV6bbIvg7DL-yOtWIfmvlEVChFTmGh8IMjywqn2adoBwb8fmY6-Birvpx43kAgzsjwqx2YmAXb5NFIAAYeOmh" class="kg-image">
		<figcaption>Heat map showing the attacks seen on customer sites (rows) per day (columns)</figcaption>
	</figure>
	<p></p>
	<p>This heat map may initially appear confusing but reading one is easy once you know what to expect so bear with us! It is a table where each line is a website on Project Galileo and each column is a day. The color represents the number of requests triggering WAF rules - on a scale from 0 (white) to a lot (dark red). The darker the cell, the more requests were blocked on this day.</p>
	<p>We observe malicious traffic on a daily basis for most websites we protect. The average Project Galileo site saw malicious traffic for 27 days in the 1 month observed, and for almost 60% of the sites we noticed daily events.</p>
	<p>Fortunately, the vast majority of websites only receive a few malicious requests per day, likely from automated scanners. In some cases, we notice a net increase in attacks against some websites - and a few websites are under a constant influx of attacks.</p>
	<p></p>
	<figure class="kg-card kg-image-card kg-width-full kg-card-hascaption"><img src="https://lh3.googleusercontent.com/KaFgtLheT89hQ073frYp-5DBiBPAESZ93t6FIPYz8t0oo02omlH8sugpKIGJA847c8jh2O0iErKU61Vuf06IAeCNQWn8TT-eETZu-SkgIYCl98GtxVCEqC0hIPWfZ3MdocyEauyn" class="kg-image">
		<figcaption>Heat map showing the attacks blocked for each WAF rule (rows) per day (columns)</figcaption>
	</figure>
	<p></p>
	<p>This heat map shows the WAF rules that blocked requests by day. At first, it seems some rules are useless as they never match malicious requests, but this plot makes it obvious that some attack vectors become active all of a sudden (isolated dark cells). This is especially true for 0-days, malicious traffic starts once an exploit is published and is very active on the first few days. The dark active lines are the most common malicious requests, and these WAF rules protect against things like XSS and SQL injection attacks.</p>
	<h3 id="dos-denial-of-service-">DoS (Denial of Service)</h3>
	<p>A <a href="https://www.cloudflare.com/learning/ddos/ddos-mitigation/" target="_blank"><strong>DoS</strong></a> attack prevents legitimate visitors from accessing a website by flooding it with bad traffic. &nbsp;Due to the way Cloudflare works, websites protected by Cloudflare are immune to many DoS vectors, out of the box. We block layer 3 and 4 attacks, which includes SYN floods and UDP amplifications. DNS nameservers, often described as the Internet’s phone book, are fully managed by Cloudflare, and protected - visitors know how to reach the websites.</p>
	<p></p>
	<figure class="kg-card kg-image-card kg-width-wide kg-card-hascaption"><img src="https://lh4.googleusercontent.com/QKswAfRZDj8yH9Q6c6sWB0x-KokAOFijKoFRwT6lsE9JYmc6hR9SbVgkvjRdbATfczLZ5ZPLtRzZMEuwximdwmKgPgH7Gno9GHZWL27VX3xSPY0CMI7JRCxLe9M-dgRsRDJmIGXJ" class="kg-image">
		<figcaption>Line plot - requests per second to a website under DoS attack</figcaption>
	</figure>
	<p></p>
	<p>Can you spot the attack?</p>
	<p>As for layer 7 attacks (for instance, HTTP floods), we rely on Gatebot, an automated tool to detect, analyse and block DoS attacks, so you can sleep. The graph shows the requests per second we received on a zone, and whether or not it reached the origin server. As you can see, the bad traffic was identified automatically by Gatebot, and more than 1.6 million requests were blocked as a result.</p>
	<h3 id="firewall-rules">Firewall Rules</h3>
	<p>For websites with specific requirements we provide tools to allow customers to block traffic to precisely fit their needs. Customers can easily implement complex logic using Firewall Rules to filter out specific chunks of traffic, block IPs / Networks / Countries using Access Rules and Project Galileo sites have done just that. Let’s see a few examples.</p>
	<p><a href="https://blog.cloudflare.com/announcing-firewall-rules/"><strong>Firewall Rules</strong></a> allows website owners to challenge or block as much or as little traffic as they desire, and this can be done as a surgical tool “block just this request” or as a general tool “challenge every request”.</p>
	<p>For instance, a well-known website used <strong>Firewall Rules</strong> to prevent twenty IPs from fetching specific pages. 3 of these IPs were then used to send a total of 4.5 million requests over a short period of time, and the following chart shows the requests seen for this website. When this happened Cloudflare, mitigated the traffic ensuring that the website remains available.</p>
	<p></p>
	<figure class="kg-card kg-image-card kg-width-wide kg-card-hascaption"><img src="https://lh6.googleusercontent.com/vO5ctEREt3GkkAHbKc3YGsP52-1_G0BEFUgcjL7pvlYGwkjHv5xm5X6QI3yD84bBlArh7hjI-CI2qWZ-pU-DBsF0gBXBMjA0YcLfMVcc2gG__20xRKI86ObNvfjSkV-uIU9LXAg3" class="kg-image">
		<figcaption>Cumulative line plot. Requests per second to a website</figcaption>
	</figure>
	<p></p>
	<p>Another website, built with WordPress, is using Cloudflare to cache their webpages. As POST requests are not cacheable, they always hit the origin machine and increase load on the origin server - that’s why this website is using firewall rules to block POST requests, except on their administration backend. Smart!</p>
	<p>Website owners can also deny or challenge requests based on the visitor’s IP address, Autonomous System Number (ASN) or Country. Dubbed <a href="https://support.cloudflare.com/hc/en-us/articles/217074967-Configuring-IP-Access-Rules" target="_blank"><strong>Access Rules</strong></a>, it is enforced on all pages of a website - hassle-free.</p>
	<p>For example, a news website is using Cloudflare’s Access Rules to challenge visitors from countries outside of their geographic region who are accessing their website. We enforce the rules globally even for cached resources, and take care of GeoIP database updates for them, so they don’t have to.</p>
	<p>The <a href="https://support.cloudflare.com/hc/en-us/articles/115001595131-How-do-I-Lockdown-URLs-in-Cloudflare-" target="_blank"><strong>Zone Lockdown</strong></a> utility restricts a specific URL to specific IP addresses. This is useful to protect an internal but public path being accessed by external IP addresses. A non-profit based in the United Kingdom is using Zone Lockdown to restrict access to their WordPress’ admin panel and login page, hardening their website without relying on non official plugins. Although it does not prevent very sophisticated attacks, it shields them against automated attacks and phishing attempts - as even if their credentials are stolen, they can’t be used as easily.</p>
	<h3 id="rate-limiting">Rate Limiting</h3>
	<p>Cloudflare acts as a CDN, caching resources and happily serving them, reducing bandwidth used by the origin server … and indirectly the costs. Unfortunately, not all requests can be cached and some requests are very expensive to handle. Malicious users may abuse this to increase load on the server, and website owners can rely on our <a href="https://support.cloudflare.com/hc/en-us/articles/235240767-Cloudflare-Rate-Limiting" target="_blank"><strong>Rate Limit</strong></a> to help them: they define thresholds, expressed in requests over a time span, and we make sure to enforce this threshold. A non-profit fighting against poverty relies on rate limits to protect their donation page, and we are glad to help!</p>
	<h3 id="security-level">Security Level</h3>
	<p>Last but not least, one of Cloudflare’s greatest assets is our threat intelligence. With such a wide lens of the threat landscape, Cloudflare uses our Firewall data, combined with machine learning to curate our IP Reputation databases. This data is provided to all Cloudflare customers, and is configured through our <strong>Security Level</strong> feature. Customers then may define their threshold sensitivity, ranging &nbsp;from <strong>Essentially Off</strong> to <strong>I’m Under Attack</strong>. For every incoming request, we ask visitors to complete a challenge if the score is above a customer defined threshold. This system alone is responsible for 25% of the requests we mitigated: it’s extremely easy to use, and it constantly learns from the other protections.</p>
	<h3 id="conclusion">Conclusion</h3>
	<p>When taken together, the Cloudflare Firewall features provide our Project Galileo customers comprehensive and effective security that enables them to ensure their important work is available. The majority of security events were handled automatically, and this is our strength - security that is always on, always available, always learning.</p>
</div>