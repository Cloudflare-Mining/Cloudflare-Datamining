{
	"footerBlurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
	"initialReadingTime": "5",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Cristhian Motoche",
				"slug": "cristhian-motoche",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/EhfFT0wZdO9KhXd8SdyC3/5e470f052053519167a470bd680aa65e/cristhian-motoche.png",
				"location": null,
				"website": "https://www.linkedin.com/in/cristhian-alberto-motoche-macas-706b86127",
				"twitter": "@Camm_v222",
				"facebook": null,
				"publiclyIndex": true
			}
		],
		"excerpt": "Let's combine the power of Haskell and WebAssembly in a Cloudflare Worker!",
		"feature_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1T4sDDntXYb9EWUH82Cx4j/5efeaeedacc972b497c227072f1e0c14/cloudflare-worker-with-webassembly-and-haskell.png",
		"featured": false,
		"html": "<p><i>This is a guest post by Cristhian Motoche of </i><a href=\"https://www.stackbuilders.com/\"><i>Stack Builders</i></a><i>.</i></p><p>At <a href=\"https://www.stackbuilders.com/\">Stack Builders</a>, we believe that Haskell’s system of expressive static types offers many benefits to the software industry and the world-wide community that depends on our services. In order to fully realize these benefits, it is necessary to have proper training and access to an ecosystem that allows for reliable deployment of services. In exploring the tools that help us run our systems based on Haskell, our developer Cristhian Motoche has created a tutorial that shows how to compile Haskell to WebAssembly using Asterius for deployment on Cloudflare.</p>\n    <div class=\"flex anchor relative\">\n      <h3 id=\"\"></h3>\n      <a href=\"#\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>What is a Cloudflare Worker?</p><p><a href=\"https://developers.cloudflare.com/workers/\">Cloudflare Workers</a> is a serverless platform that allows us to run our code on the edge of the Cloudflare infrastructure. It&#39;s built on Google V8, so it’s possible to write functionalities in JavaScript or any other language that targets WebAssembly.</p><p><a href=\"https://webassembly.org/\">WebAssembly</a> is a portable binary instruction format that can be executed fast in a memory-safe sandboxed environment. For this reason, it’s especially useful for tasks that need to perform resource-demanding and self-contained operations.</p>\n    <div class=\"flex anchor relative\">\n      <h3 id=\"why-use-haskell-to-target-webassembly\">Why use Haskell to target WebAssembly?</h3>\n      <a href=\"#why-use-haskell-to-target-webassembly\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>Haskell is a pure functional <a href=\"https://github.com/appcypher/awesome-wasm-langs\">language</a> that can target WebAssembly. As such, It helps developers break down complex tasks into small functions that can later be composed to do complex tasks. Additionally, it’s statically typed and has type inference, so it will complain if there are type errors at compile time. Because of that and <a href=\"https://wiki.haskell.org/Why_Haskell_matters\">much more</a>, Haskell is a good source language for targeting WebAssembly.</p>\n    <div class=\"flex anchor relative\">\n      <h3 id=\"from-haskell-to-webassembly\">From Haskell to WebAssembly</h3>\n      <a href=\"#from-haskell-to-webassembly\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>We’ll use <a href=\"https://asterius.netlify.app/\">Asterius</a> to target WebAssembly from Haskell. It’s a well documented tool that is updated often and supports a lot of Haskell features.</p><p>First, as suggested in the <a href=\"https://asterius.netlify.app/images.html#using-prebuilt-container-images\">documentation</a>, we’ll use podman to pull the Asterius prebuilt container from Docker hub. In this tutorial, we will use Asterius version <a href=\"https://hub.docker.com/layers/terrorjack/asterius/200617/images/sha256-8e6009198c3940d1b4938b0ab6c0b119d4fce3d7ac0f6336214e758f66887b80?context=explore\">200617</a>, which works with GHC 8.8.</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">podman run -it --rm -v $(pwd):/workspace -w /workspace terrorjack/asterius:200617</pre></code>\n            <p>Now we’ll create a Haskell module called <code>fact.hs</code> file that will export a pure function:</p>\n            <pre class=\"language-haskell\"><code class=\"language-haskell\">module Factorial (fact) where\n\nfact :: Int -&gt; Int\nfact n = go n 1\n  where\n    go 0 acc = acc\n    go n acc = go (n - 1) (n*acc)\n\nforeign export javascript &quot;fact&quot; fact :: Int -&gt; Int</pre></code>\n            <p>In this module, we define a pure function called <code>fact</code>, optimized with tail recursion and exported using the <a href=\"https://asterius.netlify.app/jsffi.html\">Asterius JavaScript FFI</a>, so that it can be called when a WebAssembly module is instantiated in JavaScript.</p><p>Next, we’ll create a JavaScript file called <code>fact_node.mjs</code> that contains the following code:</p>\n            <pre class=\"language-javascript\"><code class=\"language-javascript\">import * as rts from &quot;./rts.mjs&quot;;\nimport module from &quot;./fact.wasm.mjs&quot;;\nimport req from &quot;./fact.req.mjs&quot;;\n\nasync function handleModule(m) {\n  const i = await rts.newAsteriusInstance(Object.assign(req, {module: m}));\n  const result = await i.exports.fact(5);\n  console.log(result);\n}\n\nmodule.then(handleModule);</pre></code>\n            <p>This code imports <code>rts.mjs</code> (common runtime), WebAssembly loaders, and the required parameters for the Asterius instance. It creates a new Asterius instance, it calls the exported function <code>fact</code> with the input <code>5</code>, and prints out the result.</p><p>You probably have noted that <code>fact</code> is done <b>asynchronously</b>. This happens with any exported function by Asterius, even if it’s a pure function.</p><p>Next, we’ll compile this code using the Asterius command line interface (CLI) <code>ahc-link</code>, and we’ll run the JavaScript code in Node:</p>\n            <pre class=\"language-sh\"><code class=\"language-sh\">ahc-link \\\n  --input-hs fact.hs \\\n  --no-main \\\n  --export-function=fact \\\n  --run \\\n  --input-mjs fact_node.mjs \\\n  --output-dir=node</pre></code>\n            <p>This command takes <code>fact.hs</code> as a Haskell input file, specifies that no <code>main</code> function is exported, and exports the <code>fact</code> function. Additionally, it takes <code>fact_node.mjs</code> as the entry JavaScript file that replaces the generated file by default, and it places the generated code in a directory called <code>node</code>.</p><p>Running the <code>ahc-link</code> command from above will print the following output in the console:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">[INFO] Compiling fact.hs to WebAssembly\n...\n[INFO] Running node/fact.mjs\n120</pre></code>\n            <p>As you can see, the result is executed in <code>node</code> and it prints out the result of <code>fact</code> in the console.</p>\n    <div class=\"flex anchor relative\">\n      <h3 id=\"push-your-code-to-cloudflare-workers\">Push your code to Cloudflare Workers</h3>\n      <a href=\"#push-your-code-to-cloudflare-workers\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>Now we’ll set everything up for deploying our code to Cloudflare Workers.</p><p>First, let’s add a <code>metadata.json</code> file with the following content:</p>\n            <pre class=\"language-json\"><code class=\"language-json\">{\n  &quot;body_part&quot;: &quot;script&quot;,\n  &quot;bindings&quot;: [\n    {\n      &quot;type&quot;: &quot;wasm_module&quot;,\n      &quot;name&quot;: &quot;WASM&quot;,\n      &quot;part&quot;: &quot;wasm&quot;\n    }\n  ]\n}</pre></code>\n            <p>This file is needed to specify the <code>wasm_module</code> binding. The <code>name</code> value corresponds to the global variable to access the WebAssembly module from your Worker code. In our example, it’s going to have the name <code>WASM</code>.</p><p>Our next step is to define the main point of the Workers script.</p>\n            <pre class=\"language-javascript\"><code class=\"language-javascript\">import * as rts from &quot;./rts.mjs&quot;;\nimport fact from &quot;./fact.req.mjs&quot;;\n\nasync function handleFact(param) {\n  const i = await rts.newAsteriusInstance(Object.assign(fact, { module: WASM }));\n  return await i.exports.fact(param);\n}\n\nasync function handleRequest(req) {\n  if (req.method == &quot;POST&quot;) {\n    const data = await req.formData();\n    const param = parseInt(data.get(&quot;param&quot;));\n    if (param) {\n      const resp = await handleFact(param);\n      return new Response(resp, {status: 200});\n    } else {\n      return new Response(\n        &quot;Expecting &#039;param&#039; in request to be an integer&quot;,\n        {status: 400},\n      );\n    }\n  }\n  return new Response(&quot;Method not allowed&quot;, {status: 405});\n}\n\naddEventListener(&quot;fetch&quot;, event =&gt; {\n  event.respondWith(handleRequest(event.request))\n})</pre></code>\n            <p>There are a few interesting things to point out in this code:</p><ol><li><p>We import <code>rts.mjs</code> and <code>fact.req.mjs</code> to load the exported functions from our WebAssembly module.</p></li><li><p><code>handleFact</code> is an asynchronous function that creates an instance of Asterius with the global <code>WASM</code> module, as a Workers global variable, and calls the exported function <code>fact</code> with some input.</p></li><li><p><code>handleRequest</code> handles the request of the Worker. It expects a <code>POST</code> request, with a parameter called <code>param</code> in the request body. If <code>param</code> is a number, it calls <code>handleFact</code> to respond with the result of <code>fact</code>.</p></li><li><p>Using the Service Workers API, we listen to the <code>fetch</code> event that will respond with the result of <code>handleRequest</code>.</p></li></ol><p>We need to build and bundle our code in a single JavaScript file, because Workers only accepts one script per worker. Fortunately, Asterius comes with Parcel.js, which will bundle all the necessary code in a single JavaScript file.</p>\n            <pre class=\"language-sh\"><code class=\"language-sh\">ahc-link \\\n  --input-hs fact.hs \\\n  --no-main \\\n  --export-function=fact \\\n  --input-mjs fact_cfw.mjs \\\n  --bundle \\\n  --browser \\\n  --output-dir worker</pre></code>\n            <p><code>ahc-link</code> will generate some files inside a directory called <code>worker</code>. For our Workers, we’re only interested in the JavaScript file (<code>fact.js</code>) and the WebAssembly module (<code>fact.wasm</code>). Now, it’s time to submit both of them to Workers. We can do this with the provided REST API.</p><p>Make sure you have an account id (<code>$CF_ACCOUNT_ID</code>), a name for your script (<code>$SCRIPT_NAME</code>), and an API Token (<code>$CF_API_TOKEN</code>):</p>\n            <pre class=\"language-sh\"><code class=\"language-sh\">cd worker\ncurl -X PUT &quot;https://api.cloudflare.com/client/v4/accounts/$CF_ACCOUNT_ID/workers/scripts/$SCRIPT_NAME&quot; \\\n     -H  &quot;Authorization: Bearer $CF_API_TOKEN&quot; \\\n     -F &quot;metadata=@metadata.json;type=application/json&quot; \\\n     -F &quot;script=@fact.js;type=application/javascript&quot; \\\n     -F &quot;wasm=@fact.wasm;type=application/wasm&quot;</pre></code>\n            <p>Now, visit the Workers UI, where you can use the editor to view, edit, and test the script. Also, you can enable it to on a <code>workers.dev</code> subdomain (<code>$CFW_SUBDOMAIN</code>); in that case, you could then simply:</p>\n            <pre class=\"language-sh\"><code class=\"language-sh\">curl -X POST $CFW_SUBDOMAIN \\\n       -H &#039;Content-Type: application/x-www-form-urlencoded&#039; \\\n       --data &#039;param=5&#039;</pre></code>\n            \n    <div class=\"flex anchor relative\">\n      <h3 id=\"beyond-a-simple-haskell-file\">Beyond a simple Haskell file</h3>\n      <a href=\"#beyond-a-simple-haskell-file\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>So far, we’ve created a WebAssembly module that exports a pure Haskell function we ran in Workers. However, we can also create and build a Cabal project using Asterius <code>ahc-cabal</code> CLI, and then use <code>ahc-dist</code> to compile it to WebAssembly.</p><p>First, let’s create the project:</p>\n            <pre class=\"language-sh\"><code class=\"language-sh\">ahc-cabal init -m -p cabal-cfw-example</pre></code>\n            <p>Then, let’s add some dependencies to our cabal project. The cabal file will look like this:</p>\n            <pre class=\"language-sh\"><code class=\"language-sh\">cabal-version:       2.4\nname:                cabal-cfw-example\nversion:             0.1.0.0\nlicense:             NONE\n\nexecutable cabal-cfw-example\n  ghc-options: -optl--export-function=handleReq\n  main-is:             Main.hs\n  build-depends:\n    base,\n    bytestring,\n    aeson &gt;=1.5 &amp;&amp; &lt; 1.6,\n    text\n  default-language:    Haskell2010</pre></code>\n            <p>It’s a simple cabal file, except for the <code>-optl--export-function=handleReq</code> ghc flag. This is <a href=\"https://github.com/tweag/asterius/issues/362#issuecomment-561576162\">necessary</a> when exporting a function from a cabal project.</p><p>In this example, we’ll define a simple <code>User</code> record, and we’ll define its instance automatically using Template Haskell!</p>\n            <pre class=\"language-haskell\"><code class=\"language-haskell\">{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TemplateHaskell   #-}\n\nmodule Main where\n\nimport           Asterius.Types\nimport           Control.Monad\nimport           Data.Aeson                 hiding (Object)\nimport qualified Data.Aeson                 as A\nimport           Data.Aeson.TH\nimport qualified Data.ByteString.Lazy.Char8 as B8\nimport           Data.Text\n\n\nmain :: IO ()\nmain = putStrLn &quot;CFW Cabal&quot;\n\ndata User =\n  User\n    { name :: Text\n    , age  :: Int\n    }\n\n$(deriveJSON defaultOptions &#039;User)</pre></code>\n            <p><b>NOTE:</b> It’s not necessary to create a Cabal project for this example, because the prebuilt container comes with a lot of <a href=\"https://github.com/tweag/asterius/issues/354\">prebuilt packages</a> (aesona included). Nevertheless, it will help us show the potential of <code>ahc-cabal</code> and <code>ahc-dist</code>.</p><p>Next, we’ll define <code>handleReq</code>, which we’ll export using JavaScript FFI just like we did before.</p>\n            <pre class=\"language-haskell\"><code class=\"language-haskell\">handleReq :: JSString -&gt; JSString -&gt; IO JSObject\nhandleReq method rawBody =\n  case fromJSString method of\n    &quot;POST&quot; -&gt;\n      let eitherUser :: Either String User\n          eitherUser = eitherDecode (B8.pack $ fromJSString rawBody)\n       in case eitherUser of\n            Right _  -&gt; js_new_response (toJSString &quot;Success!&quot;) 200\n            Left err -&gt; js_new_response (toJSString err) 400\n    _ -&gt; js_new_response (toJSString &quot;Not a valid method&quot;) 405\n\nforeign export javascript &quot;handleReq&quot; handleReq :: JSString -&gt; JSString -&gt; IO JSObject\n\nforeign import javascript &quot;new Response($1, {\\&quot;status\\&quot;: $2})&quot;\n  js_new_response :: JSString -&gt; Int -&gt; IO JSObject</pre></code>\n            <p>This time, we define <code>js_new_response</code>, a Haskell function that creates a JavaScript object, to create a <code>Response</code>. <code>handleReq</code> takes two string parameters from JavaScript and it uses them to prepare a response.</p><p>Now let’s build and install the binary in the current directory:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">ahc-cabal new-install --installdir . --overwrite-policy=always</pre></code>\n            <p>This will generate a binary for our executable, called <code>cabal-cfw-example</code>. We’re going to use <code>ahc-dist</code> to take that binary and target WebAssembly:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">ahc-dist --input-exe cabal-cfw-example --export-function=handleReq --no-main --input-mjs cabal_cfw_example.mjs --bundle --browser</pre></code>\n            <p><code>cabal_cfw_example.mjs</code> contains the following code:</p>\n            <pre class=\"language-javascript\"><code class=\"language-javascript\">import * as rts from &quot;./rts.mjs&quot;;\nimport cabal_cfw_example from &quot;./cabal_cfw_example.req.mjs&quot;;\n\nasync function handleRequest(req) {\n  const i = await rts.newAsteriusInstance(Object.assign(cabal_cfw_example, { module: WASM }));\n  const body = await req.text();\n  return await i.exports.handleReq(req.method, body);\n}\n\naddEventListener(&quot;fetch&quot;, event =&gt; {\n  event.respondWith(handleRequest(event.request))\n});</pre></code>\n            <p>Finally, we can deploy our code to Workers by defining a <code>metadata.json</code> file and uploading the script and the WebAssembly module using Workers API as we did before.</p>\n    <div class=\"flex anchor relative\">\n      <h3 id=\"caveats\">Caveats</h3>\n      <a href=\"#caveats\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>Workers <a href=\"https://developers.cloudflare.com/workers/about/limits/#script-size\">limits</a> your JavaScript and WebAssembly in file size. Therefore, you need to be careful with any dependencies you add.</p>\n    <div class=\"flex anchor relative\">\n      <h3 id=\"conclusion\">Conclusion</h3>\n      <a href=\"#conclusion\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>Stack Builders builds better software for better living through technologies like expressive static types. We used Asterius to compile Haskell to WebAssembly and deployed it to Cloudflare Workers using the Workers API. Asterius supports a lot of Haskell features (e.g. Template Haskell) and it provides an easy-to-use JavaScript FFI to interact with JavaScript. Additionally, it provides prebuilt containers that contain a lot of Haskell packages, so you can start writing a script right away.</p><p>Following this approach, we can write functional type-safe code in Haskell, target it to WebAssembly, and publish it to Workers, which runs on the edge of the Cloudflare infrastructure.</p><p>For more content check our <a href=\"https://www.stackbuilders.com/news/page/1\">blogs</a> and <a href=\"https://www.stackbuilders.com/tutorials/\">tutorials</a>!</p>",
		"id": "5AVLtoBd5aIK5zHzElyM9s",
		"localeList": {
			"name": "Let's build a Cloudflare Worker with WebAssembly and Haskell Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "Let's combine the power of Haskell and WebAssembly in a Cloudflare Worker!",
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"publicly_index": true,
		"published_at": "2020-10-06T12:00:00.000+01:00",
		"slug": "cloudflare-worker-with-webassembly-and-haskell",
		"tags": [
			{
				"id": "6hbkItfupogJP3aRDAq6v8",
				"name": "Cloudflare Workers",
				"slug": "workers"
			},
			{
				"id": "5ghWZAL0nNGxrphuhWW6G0",
				"name": "WebAssembly",
				"slug": "webassembly"
			},
			{
				"id": "4hhzQ9V5KQE5wXF4VtEcoG",
				"name": "WASM",
				"slug": "wasm"
			},
			{
				"id": "5cye1Bh5KxFh3pKSnX8Dsy",
				"name": "Serverless",
				"slug": "serverless"
			}
		],
		"title": "Let's build a Cloudflare Worker with WebAssembly and Haskell",
		"updated_at": "2024-10-09T23:12:11.790Z",
		"url": "https://blog.cloudflare.com/cloudflare-worker-with-webassembly-and-haskell"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.icon_aria_label": "Search",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"search.result_stat_empty": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong>",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"search.autocomplete_title": "Insert a query. Press enter to send",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}