{
	"initialReadingTime": "6",
	"locale": "en-us",
	"localesAvailable": [
		"id-id",
		"th-th"
	],
	"post": {
		"authors": [
			{
				"name": "Julie A. Sparks",
				"slug": "julie",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1AAloBZONQBUyv8YThHCX8/6795967cd99da7dee887318ef0382001/julie.jpg",
				"location": null,
				"website": null,
				"twitter": null,
				"facebook": null
			}
		],
		"excerpt": "Throughout the day, Cloudflare has published blog posts on products created to secure our customers from credential stuffing bots, detect users with compromised credentials, and block users from proxy services. But what do we do inside Cloudflare to prevent account takeovers on our own applications?",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/6T3XzDV5YLp3iVjiGjJ4rH/28e134c5d001238b96edddb79766612e/account-compromise-security-overview.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/Gczm3aZ3qntPawrGx2tsb/cdd1a854c67390f57d521539ff1076e9/image1-62.png\" alt=\"Inside Cloudflare: Preventing Account Takeovers\" class=\"kg-image\" width=\"1585\" height=\"740\" loading=\"lazy\"/>\n            \n            </figure><p>Over the last week, Cloudflare has published blog posts on products created to secure our customers from <a href=\"/super-bot-fight-mode/\">credential stuffing bots</a>, <a href=\"/account-takeover-protection\">detect users with compromised credentials</a>, and <a href=\"/protecting-apis-from-abuse-and-data-exfiltration/\">block users from proxy services</a>. But what do we do inside Cloudflare to <a href=\"https://www.cloudflare.com/zero-trust/solutions/account-takeover-prevention/\">prevent account takeovers</a> on our own applications? The Security Team uses Cloudflare products to proactively prevent account compromises. In addition, we build detections and automations as a second layer to alert us if an employee account is compromised. This ensures we can catch suspicious behavior, investigate it, and quickly remediate.</p><p>Our goal is to prevent automated and targeted attackers regardless of the account takeover technique: brute force attack, credential stuffing, botnets, social engineering, or phishing.</p><h3>Classic Account Takeover Lifecycle</h3><p>First, let&#39;s walk through a common lifecycle for a compromised account.</p><p>In a typical scenario, a set of passwords and email addresses have been breached. These credentials are reused through credential stuffing in an attempt to gain access to any account (on any platform) where the user may have reused that combination. Once the attacker has initial access, which means the combination worked, they can gain information on that system and pivot to other systems through methods. This is classified as lateral movement. With one password leaked, there is the potential for a completely unrelated company to incur in a breach where an unauthorized user signs in and exfiltrates data.</p><p>Another vector for account takeovers are phishing emails with links that are sent to employees with the aim to harvest credentials. A common tactic used by attackers is Evilginx, a man-in-the-middle attack framework used for phishing credentials and session cookies of any web service. By creating a page similar to the company’s login portal, the attacker can intercept traffic and harvest the credentials put into the page. Once the credentials are captured, they immediately log in as the user, exfiltrate information, and attempt to compromise related systems/accounts. As phishing email filtering has improved, attackers attempt to vish, a method of social engineering over a phone call, employees to get them to visit a malicious website such as the one mentioned above.</p><p>The two most common ways to add additional verification are through using a Time-based One-Time Password (TOTP) or verification code via text message (SMS) as a multi-factor authentication option. TOTP generates a one-time password which uses the current time as a source of uniqueness. These are commonly obtained from a mobile application such as Google Authenticator. Neither of these methods of multi-factor authentication would protect from account takeovers as attackers are able to use social engineering tactics to convince an employee to provide the TOTP or SMS. Additionally, attackers can perform SIM-swapping, a tactic where a phone carrier is tricked into assigning another person’s phone number to a new device, in order to get the verification code sent to a device they have.</p><p>Account takeovers are a real threat to companies and their users. Let’s walk through some tangible examples of compromises and how they can be prevented on multiple levels using Cloudflare.</p><h2>Account Takeover in Action</h2><p>In 2020, an example of the impact of an account takeover was demonstrated when an attacker was able to <a href=\"https://www.wsj.com/articles/the-teenager-behind-the-twitter-hack-and-how-he-did-it-11596563449\">hijack Twitter employee login credentials</a> and then access dozens of verified Twitter accounts. A Florida teenager spoofed an employee’s phone number by SIM-swapping, a tactic where a phone carrier is tricked into assigning another person’s phone number to a new device. Then he social engineered a Twitter employee by pretending to be a member of their IT department. Once the employee was convinced, he guided them to a phishing page that resembled Twitter’s Okta login portal. Once the employee put in their credentials to the seemingly legitimate page, the attacker was able to use them to gain access to Twitter’s systems. This attack was possible due to the use of SMS and/or TOTP for multi-factor authentication. If the Twitter employee had a U2F hardware security token, such as a YubiKey, the attacker would have entered the stolen credentials then been prompted to touch a physical key in order to gain access, which would have been impossible without the employee’s key.</p><p>In this scenario, a company could adopt <a href=\"https://www.cloudflare.com/teams/access\">Cloudflare Access</a> to lock down access to internal systems to company-issued devices and use granular access policies to limit which accounts can be accessed by each user group. The policies can be used to force employees to authenticate with a U2F hardware security token and block all events that use TOTP/SMS.</p><p>In 2018, a data breach compromised MyFitnessPal user data including passwords. Two years later, the breached data was used to coordinate credential stuffing attacks on two insurance companies: <a href=\"https://www.prnewswire.com/news-releases/independence-blue-cross-provides-notice-of-a-privacy-incident-301087638.html\">Independence Blue Cross</a> and <a href=\"https://www.prnewswire.com/news-releases/amerihealth-hmo-inc-and-amerihealth-insurance-company-of-new-jersey-provides-notice-of-a-privacy-incident-301087643.html\">AmeriHealth New Jersey</a>. The credential stuffing attacks resulted in unauthorized access to user insurance information including claims. This example illuminates how any company can be targeted for account takeover tactics.</p><p>Cloudflare’s bot solutions — including <a href=\"/super-bot-fight-mode/\">Super Bot Fight Mode</a>, which launched today — could have been utilized by the insurance companies to block credential stuffing proactively. Internally the insurance companies mentioned could have enabled <a href=\"/account-takeover-protection/\">Exposed Credential Checks in WAF</a> to check for breached user passwords and prompt them to change their password.</p><h3>Using Cloudflare to Secure Cloudflare</h3><p>Through Cloudflare products, many of the typical account takeover vectors are blocked. This helps the Security Team focus our attention on building our internal defenses against Cloudflare-specific attacks.</p><p>For example, <a href=\"https://www.cloudflare.com/teams/gateway/\">Cloudflare Gateway</a> allows us to proactively block potentially malicious domains in a simple UI rule builder. By blocking these categories on corporate endpoints, we lower the risk that an employee will visit a known threat.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2umqTDm7ZeEtHP5ytmjvVR/37a9fe28ccc8c1842e20dda608567771/image2-50.png\" alt=\"img\" class=\"kg-image\" width=\"1600\" height=\"372\" loading=\"lazy\"/>\n            \n            </figure><p>When there is a new domain that the Security Team observes is attempting a credential harvesting attack, we can then proactively block it using a blocklist in Gateway. This prevents the endpoint from resolving the site even if the employee accidentally navigates to it. Many security tools provide the ability to block by IP address; however, in addition to IP blocking, we also block by domain name in order to respond quickly to attacks. By blocking the domain, if an attacker deploys the same site on new IP addresses, we have already mitigated the risk of someone visiting the site.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/3uCG0qcWrByov3chECxZ9M/720bceb2231226ebb3386a51572bf6e7/image3-45.png\" alt=\"\" class=\"kg-image\" width=\"906\" height=\"132\" loading=\"lazy\"/>\n            \n            </figure><p>Internally, all Cloudflare employees are required to use a FIDO2 hardware security token to authenticate to any company resource. This protects internal systems from many of the pitfalls that make account takeover easier.</p><p>In addition to the hardware token requirement, the Security Team is using <a href=\"https://www.cloudflare.com/teams/access\">Cloudflare Access</a> to enforce only <a href=\"/zero-trust-with-managed-devices/\">managed corporate devices</a> are able to connect to internal systems. The managed rules can be configured to allow or block based on a combination of factors such as the multifactor method and the geography of the IP address used. The Security Team is able to switch from a reactive to proactive approach by blocking authentication events from non-corporate devices, countries where we don’t have employees, or events that use SMS/TOTP instead of a U2F hardware security token.</p><h3>Adding an Internal Layer of Protection</h3><p>In addition to Gateway features, the Detection &amp; Response Team exports <a href=\"https://www.cloudflare.com/teams/gateway/\">Gateway</a> &amp; <a href=\"https://www.cloudflare.com/teams/access\">Access</a> logs to further enrich, correlate, and develop detections on the raw events alongside other internal system logs. By combining all of our logs into an internal pipeline we have the opportunity to build custom detections and incident response automation.</p><p>In relation to account takeovers, our team has focused on building detections focused on <a href=\"https://attack.mitre.org/tactics/TA0001/\">initial access techniques</a> as a second layer of protection on employee accounts.</p><p>Some examples of account compromise focused detections are:</p><ul><li><p>A login or other authentication event to an internal system from a VPN.</p></li><li><p>A change in employee&#39;s multi-factor authentication token and use of a new device.</p></li><li><p>A login or authentication event from an unfamiliar IP address.</p></li><li><p>A login or authentication event from an IP address in a located high-risk country.</p></li><li><p>An authentication event with a multi-factor authentication soft-token to an internal system.</p></li><li><p>Any event from an IP address associated with known threat actors.</p></li></ul><p>However, there are many variations of behavior patterns that could signal an account compromise. Instead of using static detection rules for all of them, the Detection &amp; Response Team has prioritized building <a href=\"https://www.cloudflare.com/learning/ai/what-is-machine-learning/\">machine learning models</a> that aid in detecting anomalous authentication behavior for employee accounts.</p><p>Risk signals are patterns that <i>can</i> indicate malicious behavior and are used to determine how likely that behavior is truly malicious. Every company has some of the same security risk signals for detecting account compromises; however, it can differ greatly depending on their infrastructure. Combining Cloudflare&#39;s Security products with our own engineering allows us to have seamless protection for external and internal facing systems.</p><h3>Influencing the Product Roadmap</h3><p>As Cloudflare expands their security suite of products, the Security Team as a whole works closely in influencing the product roadmap. We are able to provide actionable insights into all the controls and detections required to effectively <a href=\"https://www.cloudflare.com/products/zero-trust/threat-defense/\">mitigate and respond to current cyberattacks</a>. Through a feedback loop of communication and collaboration, we share our internal strategies with product teams and then dogfood the products built at Cloudflare to ensure they are helpful in protecting our employee and customer data.</p><p>Cloudflare is a place where new ideas are welcomed and discussed in order to ensure our products are an asset to Security &amp; IT teams that are using them. It&#39;s empowering to be part of that journey!</p><h3>Next Steps</h3><p>Account takeovers are one of the most commonplace cybersecurity attacks, but you can quickly improve the maturity of your security program by putting in place mitigations focused on initial access. These mitigations stop the attacker at the “reconnaissance” stage of the cyber kill chain, an attack phase-model created by Lockheed Martin and expanded on through the <a href=\"https://attack.mitre.org/tactics/enterprise/\">MITRE ATT&amp;CK framework</a>.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/30SwYoSOxuvpFI2q7gHrYd/1894510b2bafcd725623e3bea7379b87/image4-51.png\" alt=\"\" class=\"kg-image\" width=\"1214\" height=\"1730\" loading=\"lazy\"/>\n            \n            </figure><p>So what&#39;s the best strategy you can take to protect your organization’s enterprise security?</p><p><i>Make the account takeover attack as difficult as possible to execute.</i></p><p>At Cloudflare, we enforce security policies focused on account security, these include hardware security token enforcement for multi-factor-authentication, strong password complexity, proactive blocking of known bad domains, and bot protection on external facing sites. Each of these mitigations are aimed to disrupt the beginning phases of the attacker&#39;s kill chain.</p>",
		"id": "5RJ5uFo4YJ0rnXfGKfGfil",
		"localeList": {
			"name": "Inside Cloudflare: Preventing Account Takeovers Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "Translated for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "Translated for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "Throughout the day, Cloudflare has published blog posts on products created to secure our customers from credential stuffing bots, detect users with compromised credentials, and block users from proxy services. But what do we do inside Cloudflare to prevent account takeovers on our own applications?",
		"metadata": {
			"title": "Inside Cloudflare: Preventing Account Takeovers",
			"description": "Throughout the day, Cloudflare has published blog posts on products created to secure our customers from credential stuffing bots, detect users with compromised credentials, and block users from proxy services. But what do we do inside Cloudflare to prevent account takeovers on our own applications?",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/3DKzs6qJlvNJ2FP4sZPpHE/3d66435c4898811214256b3f4a0d2431/account-compromise-security-overview-qR9J9z.png"
		},
		"primary_author": {},
		"published_at": "2021-03-30T14:00:00.000+01:00",
		"slug": "account-compromise-security-overview",
		"tags": [
			{
				"id": "3DmitkNK6euuD5BlhuvOLW",
				"name": "Security Week",
				"slug": "security-week"
			},
			{
				"id": "15qx2Nvwrm4X8zknw3vXgC",
				"name": "Cloudflare Gateway",
				"slug": "gateway"
			},
			{
				"id": "6c9EM6c5poinGKIR6xldFo",
				"name": "Cloudflare Access",
				"slug": "cloudflare-access"
			},
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			}
		],
		"title": "Inside Cloudflare: Preventing Account Takeovers",
		"updated_at": "2024-08-27T01:51:41.253Z",
		"url": "https://blog.cloudflare.com/account-compromise-security-overview"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}