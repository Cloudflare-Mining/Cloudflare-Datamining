<div class="mb2 gray5">2 min read</div><img class="mr2" src="https:undefined" alt="">
<div class="post-content lh-copy gray1">
	<p><i>The following is a guest post from Scott Stender</i></p>
	<p>The Cloudflare <a href="https://blog.cloudflare.com/tls-1-3-explained-by-the-cloudflare-crypto-team-at-33c3">TLS 1.3 beta</a> is run by a Go implementation of the protocol based on the Go standard library, <code>crypto/tls</code>. Starting from that excellent Go codebase allowed us to quickly start experimenting, to be the first wide server deployment of the protocol, and to effectively track the changes to the specification draft.</p>
	<p>Of course, the security of a TLS implementation is critical, so we engaged NCC Group's Cryptography Services to perform an audit at the end of 2016.</p>
	<p>You can find the codebase <a href="https://github.com/cloudflare/tls-tris">on the Cloudflare GitHub</a>. It's a drop-in replacement for <code>crypto/tls</code> and comes with a <code>go</code> wrapper to patch the standard library as needed.</p>
	<p>The code is developed in the open but is currently targeted only at internal use: the repository is frequently rebased and the API is not guaranteed to be stable or fully documented. You can take <a href="https://gist.github.com/FiloSottile/37d6516af411582e2aa35a981bf12102">a sneak peek at the API here</a>.</p>
	<p>The final goal is to upstream the patches to the Go project so that all users of the Go standard library benefit from it. You can <a href="https://go-review.googlesource.com/q/status:open+project:go+branch:dev.tls">follow the process here</a>.</p>
	<p>Below we republish the article about the audit first appeared <a href="https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2017/february/ncc-groups-cryptography-services-complete-an-audit-of-cloudfares-tls13">on the NCC Group's blog</a>.</p>
	<h3>NCC Group's Cryptography Services Complete an Audit of Cloudflare's TLS1.3</h3>
	<p>NCC Group's Cryptography Services practice recently completed a two-week audit of Cloudflare's TLS 1.3 implementation. The audit took place between November 11, 2016 and December 9, 2016.</p>
	<p>The TLS standard was last updated almost ten years ago and this version brings new features and a simplified handshake to the protocol. Many old cryptographic algorithms have been replaced with more modern ones, key exchanges have forward secrecy by default, the handshake phase will be faster, certificates will be able to enjoy security-proven signature schemes, MAC-then-Encrypt constructions are out—the weakest features of older TLS versions have been updated or removed.</p>
	<p>Cryptography Services analyzed Cloudflare's TLS 1.3 implementation for protocol-level flaws and for deviations from the draft specification. The team found a small number of issues during the review—all of which were promptly fixed—and was pleased with the quality of the code.</p>
	<p>Cloudflare built their implementation of TLS 1.3 on the Go programming language's standard TLS library, making use of the existing base to correctly and safely parse TLS packets. While building on top of older versions can be challenging, Cloudflare has added TLS 1.3 code in a safe and segregated way, with new defenses against downgrade attacks being added in the final implementation of the specification. This permits support for older versions of TLS while being free from unexpected conflicts or downgrades.</p>
	<p>Using Go and its standard libraries enables Cloudflare to avoid common implementation issues stemming from vulnerable strcpy and memcpy operations, pointer arithmetic and manual memory management while providing a best-in-class crypto API.</p>
	<p>Cloudflare implemented a conservative subset of the TLS 1.3 specification. State-of-the-art algorithms, such as Curve25519, are given priority over legacy algorithms. Session resumption is limited to the forward secure option. Cloudflare's implementation also considers efficiency, using AES-GCM if it detects accelerated hardware support and the faster-in-software Chacha20-Poly1305 in its absence.</p>
	<p>There is still work to be done before TLS 1.3 enjoys large scale adoption. Cloudflare is paving the way with its reliable server implementation of TLS 1.3, and Firefox and Chrome's client implementations make end-to-end testing of the draft specification possible. NCC Group applauds the work of the IETF and these early implementers.</p>
</div>