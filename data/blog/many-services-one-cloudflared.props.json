{
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Adam Chalmers",
				"slug": "adam-chalmers",
				"bio": "Australian, static typing enthusiast, ",
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1aqSM1mcj1n6KrFDvYWXTv/a9e95f6aa2fea17fcff17b12445768e6/adam-chalmers.png",
				"location": "Austin TX",
				"website": null,
				"twitter": "@adam_chal",
				"facebook": null
			}
		],
		"excerpt": "Previously, if you wanted to proxy 100 services through Argo Tunnel, you needed 100 instances of cloudflared running on your server. Today, we’re thrilled to announce our most-requested feature: you can now expose unlimited services using one cloudflared.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/24vht6TAD0Uq72jBGtMyTB/71c905fd46efe48941a5a3430c150f6d/many-services-one-cloudflared.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/YuYC8rMeikhlUWZDeYgHb/0a9c6e9a23175200a55d507678a54b7d/Multiple-proxy-services-in-one-cloudflared-1.png\" alt=\"\" class=\"kg-image\" width=\"1418\" height=\"769\" loading=\"lazy\"/>\n            \n            </figure><p><i>Route many different local services through many different URLs, with only one cloudflared</i></p><p>I work on the <a href=\"https://www.cloudflare.com/products/argo-tunnel/\">Argo Tunnel</a> team, and we make a program called <a href=\"https://github.com/cloudflare/cloudflared\">cloudflared</a><i>,</i> which lets you securely expose your web service to the Internet while ensuring that <i>all</i> its traffic goes through Cloudflare.</p><p>Say you have some local service (a website, an API, a TCP server, etc), and you want to securely expose it to the internet using Argo Tunnel. First, you run cloudflared, which establishes some long-lived TCP connections to the Cloudflare edge. Then, when Cloudflare receives a request for your chosen hostname, it proxies the request through those connections to cloudflared, which in turn proxies the request to your local service. This means anyone accessing your service has to go through Cloudflare, and Cloudflare can do caching, rewrite parts of the page, block attackers, or build <a href=\"https://www.cloudflare.com/teams/access/\">Zero Trust rules</a> to control who can reach your application (e.g. users with a @corp.com email). Previously, companies had to use VPNs or firewalls to achieve this, but Argo Tunnel aims to be more flexible, more secure, and more scalable than the alternatives.</p><p>Some of our larger customers have deployed hundreds of services with Argo Tunnel, but they’re consistently experiencing a pain point with these larger deployments. Each instance of <i>cloudflared</i> can only proxy a single service. This means if you want to put, say, 100 services on the internet, you’ll need 100 instances of cloudflared running on your server. This is inefficient (because you’re using 100x as many system resources) and, even worse, it’s a pain to manage 100 long-lived services!</p><p>Today, we’re thrilled to announce our most-requested feature: you can now expose unlimited services using one cloudflared. Any customer can start using this today, at no extra cost, using the Named Tunnels we released a few months ago.</p><h3>Named Tunnels</h3><p>Earlier this year, we announced <a href=\"/argo-tunnels-that-live-forever/\">Named Tunnels</a>—tunnels with immutable IDs that you can run and stop as you please. You can route traffic into the tunnel by adding a DNS or Cloudflare Load Balancer record, and you can route traffic from the tunnel into your local services by running cloudflared_._</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/640RbNyTpOVzJ2YIenEh4S/5d8b0d7ec8e4b6fe94ec925f62559f3e/BLOG-314-Multi-Service-Support-for-Cloudflared.png\" alt=\"\" class=\"kg-image\" width=\"624\" height=\"205\" loading=\"lazy\"/>\n            \n            </figure><p>You can <a href=\"https://developers.cloudflare.com/argo-tunnel/create-tunnel\">create a tunnel</a> by running $ cloudflared tunnel create my_tunnel_name. Once you’ve got a tunnel, you can use <a href=\"https://developers.cloudflare.com/argo-tunnel/routing-to-tunnel/dns\">DNS records</a> or <a href=\"https://developers.cloudflare.com/argo-tunnel/routing-to-tunnel/lb\">Cloudflare Load Balancers</a> to route traffic into the tunnel. Once traffic is routed into the tunnel, you can use our new ingress rules to map traffic to local services.</p><h3>Map traffic with ingress rules</h3><p>An ingress rule basically says “send traffic for <i>this</i> internet URL to <i>this</i> local service.” When you invoke <i>cloudflared</i> it’ll read these ingress rules from the configuration file. You write ingress rules under the ingress key of your config file, like this:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">$ cat ~/cloudflared_config.yaml\n\ntunnel: my_tunnel_name\ncredentials-file: .cloudflared/e0000000-e650-4190-0000-19c97abb503b.json\ningress:\n # Rules map traffic from a hostname to a local service:\n - hostname: example.com\n   service: https://localhost:8000\n # Rules can match the request's path to a regular expression:\n - hostname: static.example.com\n   path: /images/*\\.(jpg|png|gif)\n   service: https://machine1.local:3000\n # Rules can match the request's hostname to a wildcard character:\n - hostname: \"*.ssh.foo.com\"\n   service: ssh://localhost:2222\n # You can map traffic to the built-in “Hello World” test server:\n - hostname: foo.com\n   service: hello_world\n # This “catch-all” rule doesn’t have a hostname/path, so it matches everything\n - service: http_status:404</pre></code>\n            <p>This example maps traffic to three different local services. But cloudflared can map traffic to more than just addresses: it can respond with a given HTTP status (as in the last rule) or with the built-in Hello World test server (as in the second-last rule). See <a href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/configuration/ingress\">the docs</a> for a full list of supported services.</p><p>You can match traffic using the hostname, a path regex, or both. If you don’t use any filters, the ingress rule will match everything (so if you have DNS records from different zones routing into the tunnel, the rule will match all their URLs). Traffic is matched to rules from top to bottom, so in this example, the last rule will match anything that wasn’t matched by an earlier rule. We actually require the last rule to match everything; otherwise, cloudflared could receive a request and not know what to respond with.</p><h3>Testing your rules</h3><p>To make sure all your rules are valid, you can run</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">$ cat ~/cloudflared_config_invalid.yaml\n\ningress:\n - hostname: example.com\n   service: https://localhost:8000\n\n$ cloudflared tunnel ingress validate\nValidating rules from /usr/local/etc/cloudflared/config.yml\nValidation failed: The last ingress rule must match all URLs (i.e. it should not have a hostname or path filter)</pre></code>\n            <p>This will check that all your ingress rules use valid regexes and map to valid services, and it’ll ensure that your last rule (and only your last rule) matches all traffic. To make sure your ingress rules do what you expect them to do, you can run</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">$ cloudflared tunnel ingress rule https://static.example.com/images/dog.gif\nUsing rules from ~/cloudflared_config.yaml\nMatched rule #2\n        Hostname: static.example.com\n        path: /images/*\\.(jpg|png|gif)</pre></code>\n            <p>This will check which rule matches the given URL, almost like a dry run for the ingress rules (no tunnels are run and no requests are actually sent). It’s helpful for making sure you’re routing the right URLs to the right services!</p><h3>Per-rule configuration</h3><p>Whenever cloudflared gets a request from the internet, it proxies that request to the matching local service on your origin. Different services might need different configurations for this request; for example, you might want to tweak the timeout or HTTP headers for a certain origin. You can set a default configuration for all your local services, and then override it for specific ones, e.g.</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">ingress:\n  # Set configuration for all services\n  originRequest:\n    connectTimeout: 30s\n # This service inherits all the default (root-level) configuration\n - hostname: example.com\n   service: https://localhost:8000\n # This service overrides the default configuration\n - service: https://localhost:8001\n   originRequest:\n     connectTimeout: 10s\n     disableChunkedEncoding: true\n # Catch-all rule doesn’t actually use any of the config\n - service: http_status:404</pre></code>\n            <p>For a full list of configuration options, check out the <a href=\"https://developers.cloudflare.com/argo-tunnel/configuration/ingress\">docs</a>.</p><h3>What’s next?</h3><p>We really hope this makes Argo Tunnel an even easier way to deploy services onto the Internet. If you have any questions, file an issue on our <a href=\"https://github.com/cloudflare/cloudflared\">GitHub</a>. Happy developing!</p>",
		"id": "7xshQjXfZVHI2RUzluS5e3",
		"localeList": {
			"name": "Many services, one cloudflared Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "Previously, if you wanted to proxy 100 services through Argo Tunnel, you needed 100 instances of cloudflared running on your server. Today, we’re thrilled to announce our most-requested feature: you can now expose unlimited services using one cloudflared. ",
		"metadata": {
			"title": "Many services, one cloudflared",
			"description": "Previously, if you wanted to proxy 100 services through Argo Tunnel, you needed 100 instances of cloudflared running on your server. Today, we’re thrilled to announce our most-requested feature: you can now expose unlimited services using one cloudflared. ",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/72cYWxISZ4ZcTmt6lefQnE/fb49bb2c3dc10bbb20889ca8dd14cc4e/many-services-one-cloudflared-3UWoM0.png"
		},
		"primary_author": {},
		"published_at": "2020-11-19T12:00:00.000+00:00",
		"reading_time": 4,
		"slug": "many-services-one-cloudflared",
		"tags": [
			{
				"id": "6c9EM6c5poinGKIR6xldFo",
				"name": "Cloudflare Access",
				"slug": "cloudflare-access"
			},
			{
				"id": "6QktrXeEFcl4e2dZUTZVGl",
				"name": "Product News",
				"slug": "product-news"
			},
			{
				"id": "2kFnzwwExTv3DVtV0CTReO",
				"name": "Cloudflare Tunnel",
				"slug": "cloudflare-tunnel"
			}
		],
		"title": "Many services, one cloudflared",
		"updated_at": "2024-08-27T01:55:58.904Z",
		"url": "https://blog.cloudflare.com/many-services-one-cloudflared"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}