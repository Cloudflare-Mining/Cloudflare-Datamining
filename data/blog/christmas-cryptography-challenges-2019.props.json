{
	"initialReadingTime": "3",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Junade Ali",
				"slug": "junade-ali",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/3OWtXkEWho3HaulkNRp0L2/94facede17b4a972393d41defc8d8cfe/junade-ali.jpg",
				"location": null,
				"website": null,
				"twitter": "@IcyApril",
				"facebook": null
			},
			{
				"name": "Louis Poinsignon",
				"slug": "louis-poinsignon",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/3I0nzdzXnHJm80i9p2xDA9/ea240a762dc6b1258bec0374d969a4bc/louis-poinsignon.jpg",
				"location": null,
				"website": null,
				"twitter": "@lpoinsig",
				"facebook": null
			}
		],
		"excerpt": "We've put together some Christmas Cryptography questions. Do you think you can solve them?",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/3uorddW0QLohjJbIBlo6v9/083cf74aa76cb97a9a4eba84e9c7c3e0/christmas-cryptography-challenges-2019.png",
		"featured": false,
		"html": "<p>Last year <a href=\"/concise-post-christmas-cryptographic-challenges/\">we published some crypto challenges</a> to keep you momentarily occupied from the festivities. This year, we&#39;re doing the same. Whether you&#39;re bored or just want to learn a bit more about the technologies that encrypt the internet, feel free to give these short cryptography quizzes a go.</p><p>We&#39;re withholding answers until the start of the new year, to give you a chance to solve them without spoilers. Before we reveal the answers; if you manage to solve them, we&#39;ll be giving the first 5 people to get the answers right some Cloudflare swag. Fill out your <a href=\"https://goo.gl/forms/KexYSIfTgVaiPPKK2\">answers and details using this form</a> so we know where to send it.</p><p>Have fun!</p><p><b>UPDATE: This quiz is now closed.</b> Thank you to everyone who&#39;s played. We have received many responses, 15 of which got all the answers right; we will shortly be sending out some swag to those who got the answers right.</p><p><b>NOTE:</b> Hints, <i>now followed with solutions</i>, are below the questions, avoid scrolling too far if you want to avoid any spoilers.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/3nhuBXAXCdwxp6tYl5HUqt/20d94fd5311b4754f2c2c607b148f596/Family_Double_Dare_spaghetti_challenge-1.jpg\" alt=\"\" class=\"kg-image\" width=\"600\" height=\"399\" loading=\"lazy\"/>\n            \n            </figure><h2>Challenges</h2><h3>Client says Hello</h3><p>Client says hello, as follows:</p><blockquote><p>00000c07ac01784f437dbfc70800450000f2560140004006db58ac1020c843c7f80cd1f701bbc8b2af3449b598758018102a72a700000101080a675bce16787abd8716030100b9010000b503035c1ea569d5f64df3d8630de8bdddd1152e75f528ae577d2436949ce8deb7108600004400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009f009e006b0067003900330016009d009c003d003c0035002f000a00af00ae008d008c008b010000480000000b000900000663666c2e7265000a00080006001700180019000b00020100000d0012001004010201050106010403020305030603000500050100000000001200000017000052305655494338795157524c656d6443436c5246574651675430346754456c4f52564d674e434242546b51674e513d3d</p></blockquote><p>[<a href=\"https://gist.github.com/IcyApril/bb95c93a333aef24368242fe2af4c5ad\">Raw puzzle without text wrap</a>]</p><h3>Time-Based One-Time Password</h3><p>A user has an authenticator device to generate one time passwords for logins to their banking website. The implementation contains a fatal flaw.</p><p>At the following times, the following codes are generated (all in GMT/UTC):</p><ul><li><p>Friday, 21 December 2018 16:29:28 - <b>084342</b></p></li><li><p>Saturday, 22 December 2018 13:11:53 - <b>411907</b></p></li><li><p>Tuesday, 25 December 2018 12:15:03 - <b>617041</b></p></li></ul><p>What code will be generated at precisely midnight of the 1st of January 2019?</p><h3>RPKI</h3><p>At Cloudflare, we just setup <a href=\"/rpki-details/\">RPKI</a>: we signed a few hundred prefixes in order to reduce route leaks. But some of the prefixes hide a secret message. Find the ROAs that look different, decode the word!</p><h2>Hints</h2><h3>Client says Hello</h3><p>This challenge has 3 hints, as follows:</p><ul><li><p>Challenge is based on a network capture</p></li><li><p><a href=\"/encrypted-sni/\">https://blog.cloudflare.com/encrypted-sni/</a></p></li><li><p>What&#39;s weird about the Frame?</p></li></ul><h3>TOTP</h3><p>The Time-Based One-Time Password Algorithm is described in <a href=\"https://tools.ietf.org/html/rfc6238\">RFC 6238</a>, which was based of <a href=\"https://tools.ietf.org/html/rfc4226\">RFC4226</a> (providing an algorithm for HOTP). The TOTP algorithm requires input of two important parameters, the time and a shared secret - could one be missing?</p><p>The implementation used to generate the TOTP codes for the challenge uses SHA-1 as a digest algorithm.</p><h3>RPKI</h3><p><b>Note:</b> This challenge will no longer be valid after mid-January 2019.</p><p>This challenge has 4 hints, as follows:</p><ul><li><p>Hint #0: Four or six? Probably six.</p></li><li><p>Hint #1: If only there was a way of listing only our IPs!</p></li><li><p>Hint #2: What is the only part of the ROA where we can hide information into</p></li><li><p>Hint #3: Subtract the reserve, the char will show itself</p></li></ul><h2>Solutions</h2><p>If you prefer video form, someone has created a YouTube video of the how to solve the problems, else the written solutions are below:</p><h3>Client says Hello</h3><p>The string was (mostly) a capture from Wireshark of a Client Hello frame in TLS 1.2 handshake; as such, it reveals the Server Name where the connection is intended to go; in this case cfl.re.</p><p>There is a string suffixed to this hex stream which shouldn&#39;t be there; it&#39;s a base64 encoded string <code>\u0012\u0010\u0004\u0001\u0002\u0001\u0005\u0001\u0006\u0001\u0004\u0003\u0002\u0003\u0005\u0003\u0006\u0003\u0005\u0005\u0001\u0012\u0017R0VUIC8yQWRLemdCClRFWFQgT04gTElORVMgNCBBTkQgNQ==</code>. Decoding this string reveals:</p><blockquote><p>GET /2AdKzgBTEXT ON LINES 4 AND 5</p></blockquote><p>Accordingly; <a href=\"https://cfl.re/2AdKzgB\">https://cfl.re/2AdKzgB</a> redirects to <a href=\"https://www.cloudflare.com/robots.txt\">https://www.cloudflare.com/robots.txt</a>; on lines 4 and 5 is the phrase: &quot;Dear robot be nice&quot;.</p><p>The GET request would obviously ordinarily not be appended to the Client Hello like this; however SNI information would be. You can find more about the work Cloudflare is doing to encrypt such information, so attackers cannot see which site you&#39;re visiting, in the following post: <a href=\"/esni/\">Encrypting SNI: Fixing One of the Core Internet Bugs</a></p><h3>TOTP</h3><p>For this part, I&#39;m going to use the <a href=\"https://github.com/pyauth/pyotp\">pyotp</a> library to demonstrate how the challenge is set-up:</p><blockquote><p>&gt;&gt;&gt; import pyotp&gt;&gt;&gt; totp = pyotp.TOTP(&#39;&#39;)&gt;&gt;&gt; print totp.at(1545409768)084342&gt;&gt;&gt; print totp.at(1545484313)411907&gt;&gt;&gt; print totp.at(1545740103)617041</p></blockquote><p>Note that the argument to the TOTP function is set to an empty string, this means that there is no secret in place; and the one time passwords are generated solely from a hash of the time. Accordingly, a TOTP with the timestamp generated at midnight on New Year is 301554.</p><p>Whilst this may seem like a somewhat incredulous position for a developer to end up in - searching GitHub, I was even able to find implementations that used the default secret (<i>base32secret3232</i>) for all users wanting to authenticate to a website. This means that any other user&#39;s One Time Password is valid for any other account, and the secret could likely be breached fairly easily (as it isn&#39;t randomly generated).</p><h3>RPKI</h3><p>Cloudflare can only generate ROAs based on their prefixes. The IPv6 prefixes are listed here: <a href=\"https://cloudflare.com/ips-v6\">https://cloudflare.com/ips-v6</a>.</p><p>Using any RPKI validated prefix list (<a href=\"https://rpki.cloudflare.com/rpki.json\">https://rpki.cloudflare.com/rpki.json</a>, or using the GUI of the RIPEâ€™s RPKI Validator), test out our IPv6 prefixes. Some of them will appear coming from Reserved ASNs for Private Use:</p><ul><li><p>2803:f800:cfcf:cfcf:cfcf:cfcf:cfcf:1 - <b>B</b></p></li><li><p>2803:f800:cfcf:cfcf:cfcf:cfcf:cfcf:2 - <b>R</b></p></li><li><p>2803:f800:cfcf:cfcf:cfcf:cfcf:cfcf:3 - <b>A</b></p></li><li><p>2803:f800:cfcf:cfcf:cfcf:cfcf:cfcf:4 - <b>V</b></p></li><li><p>2803:f800:cfcf:cfcf:cfcf:cfcf:cfcf:5 - <b>O</b></p></li></ul><p>Subtract 4200000000, it will give you one byte for each character of the secret word.</p><p>Repeat until the word is decoded.</p><p><i>Interested in helping build a better internet and drive security online? </i><a href=\"https://www.cloudflare.com/careers/\"><i>Cloudflare is hiring</i></a><i>.</i></p>",
		"id": "68O8V73wAfSlxmCs2J88C7",
		"localeList": {
			"name": "Concise Christmas Cryptography Challenges 2019 Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2018-12-25T17:42:02.000+00:00",
		"slug": "christmas-cryptography-challenges-2019",
		"tags": [
			{
				"id": "1QsJUMpv0QBSLiVZLLQJ3V",
				"name": "Cryptography",
				"slug": "cryptography"
			},
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			},
			{
				"id": "7HtJFBG771uztRzrnO9jBL",
				"name": "Holidays",
				"slug": "holidays"
			},
			{
				"id": "gOuRX3XqidNRMDeIQugF5",
				"name": "Fun",
				"slug": "fun"
			}
		],
		"title": "Concise Christmas Cryptography Challenges 2019",
		"updated_at": "2024-08-27T02:15:50.769Z",
		"url": "https://blog.cloudflare.com/christmas-cryptography-challenges-2019"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}