<div class="mb2 gray5">4 min read</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4KH7AZv9ab8HD2mA9vxMim/52c246d506c88d16a1921516bbe740d0/enhancing-privacy-focused-web-analytics-to-better-meet-your-metrics-needs.png" alt="">
<div class="post-content lh-copy gray1">
	<p></p>
	<p>Last December we opened up our brand new privacy-first Web Analytics platform to everyone. Today, we’re excited to announce the release of three of the most requested features: adding multiple websites to an account, supporting Single-page Applications (SPA) as well as showing <a href="https://www.cloudflare.com/learning/performance/what-are-core-web-vitals">Core Web Vitals</a> in Web Analytics.</p>
	<div class="flex anchor relative">
		<h3 id="bringing-privacy-first-analytics-to-everyone">Bringing privacy-first analytics to everyone</h3>
		<a href="https://blog.cloudflare.com/#bringing-privacy-first-analytics-to-everyone" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Since we launched two months ago, we’ve received a lot of feedback from our users. We are really happy that we are able to provide our privacy-first analytics to so many of you.</p>
	<p>Popular analytics vendors have business models driven by ad revenue. Using them implies a bargain: they track visitor behavior and create buyer profiles to retarget your visitors with ads; in exchange, you get free analytics.</p>
	<p>Our mission is to help build a better Internet, and part of that is to deliver essential web analytics to everyone with a website without compromising user <a href="https://www.cloudflare.com/learning/privacy/what-is-data-privacy">privacy</a>. We’ve never been interested in tracking users or selling advertising. We don’t want to know what you do on the Internet — it’s not our business.</p>
	<div class="flex anchor relative">
		<h3 id="you-now-can-measure-multiple-sites">You now can measure multiple sites</h3>
		<a href="https://blog.cloudflare.com/#you-now-can-measure-multiple-sites" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>When we launched Web Analytics, each account was only able to measure one website. We are happy to announce that all users can now add up to 10 websites.</p>
	<p>Add one or more new sites via the Cloudflare Dashboard by selecting "Add site" in Quick Actions.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/JwHFT8TPvpsRmGSvoXawm/5a1c7606e8cd52883001360f431e3987/image4-10.png" alt="" class="kg-image" width="994" height="711" loading="lazy">

	</figure>
	<p>For measuring multiple subdomains (a.example.com and b.example.com) there are two options:</p>
	<ol>
		<li>
			<p>Add the root domain (example.com) to Web Analytics and add the same JavaScript snippet on all subdomains (a.example.com and b.example.com)</p>
		</li>
		<li>
			<p>Add the subdomains separately using multiple sites. Here you have to add separate snippets.</p>
		</li>
	</ol>
	<p>We use the hostname to validate the request, so remember that you can only use the JavaScript snippet if both the configured and actual hostnames match.</p>
	<div class="flex anchor relative">
		<h3 id="you-can-see-the-analytics-for-all-your-websites-sites-in-one-place">You can see the analytics for all your websites sites in one place</h3>
		<a href="https://blog.cloudflare.com/#you-can-see-the-analytics-for-all-your-websites-sites-in-one-place" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>

	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1gOpBfg0eTme94OnMVlB4B/6ea6c5eb33bd9e2c20b2918ad57f674a/jwLOrKWVvHHkUeNKeJNdtVc416SWL2cHxKB7kNjUxsSfU8Y76VYRycQctec4CPf-WnTzRyP1XA-WVWTdNkVgXqspeT7pFf3dNvUjmOrF-ukWV-0bMv0TmR4ZMppw.png" alt="" class="kg-image" width="1600" height="1004" loading="lazy">

	</figure>
	<p>When we talked to customers about the multiple site feature, we got the feedback that it is very important to add all sites to Web Analytics and be able to track them. But they also said that it would be even more powerful to have the option to see analytics for all your sites combined in one place.</p>
	<p>We listened. If you select "View Web Analytics for all sites’ on the Web Analytics overview page, you can now see all your sites listed and apply filters to them using site tags.</p>
	<div class="flex anchor relative">
		<h3 id="what-is-different-for-single-page-applications-spa">What is different for Single Page Applications (SPA)?</h3>
		<a href="https://blog.cloudflare.com/#what-is-different-for-single-page-applications-spa" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>With frameworks such as Angular, React, or Vue.js being very popular, one of the most requested features for Web Analytics was supporting single-page applications (<a href="https://en.wikipedia.org/wiki/Single-page_application">SPA</a>).</p>
	<p>SPAs work differently from a standard web application or website because they don't load a new page every time there's user interaction. Instead, they dynamically rewrite the current web page with new data retrieved from the web server.</p>
	<p>Since we've previously collected metrics only when the page load event is triggered, we had to change the transmission and interpretation of the signals from our JavaScript snippet to include sending metrics whenever there are any route changes made by the application or the website.</p>
	<p>We are happy to announce that we successfully implemented SPA support and enabled it for all customers.</p>
	<div class="flex anchor relative">
		<h3 id="how-we-are-supporting-spas">How we are supporting SPAs</h3>
		<a href="https://blog.cloudflare.com/#how-we-are-supporting-spas" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>You might have noticed that some websites keep the # in the URL whenever you navigate their webpages. You would see URLs like the following:</p>
	<pre class="language-bash"><code class="language-bash">https://cloudflare.com/#blog
https://cloudflare.com/#marketing</code></pre>
	<p>The portion separated by the # is called a fragment, and based on the fragment changes, SPAs dynamically pull the resources to rewrite the webpage. That is how it was done before the HTML 5 History API was introduced and widely used. These days most SPA libraries/frameworks use HTML 5 History API to keep your UI in sync with the URL instead of using # (although, some still support #-based routers). In most cases you won’t easily notice a SPA by looking at the URL path.</p>
	<p>To support analytics for SPAs, we implemented sending additional payloads to the beacon endpoint, which collects the data for analytics, whenever we detect any changes to the state of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/History/state">History API</a>. The JavaScript snippet overrides the <a href="https://developer.mozilla.org/en-US/docs/Web/API/History/pushState"><b>pushState</b></a> method and listens to the <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onpopstate"><b>onpopstate</b></a> event. By tracking the History API's state, you'll now see the route changes in SPAs within the Web Analytics dashboard.</p>
	<p>Some older SPA libraries/frameworks still support hash-based routers. If your application or website is using a hash-based router, unfortunately it is not yet supported in Web Analytics. However, this is our initial launch to support SPAs, so stay tuned for any improvements and updates.</p>
	<div class="flex anchor relative">
		<h3 id="how-can-i-add-my-single-page-application-to-web-analytics">How can I add my Single Page Application to Web Analytics?</h3>
		<a href="https://blog.cloudflare.com/#how-can-i-add-my-single-page-application-to-web-analytics" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>SPA support is automatically enabled for all domains in Web Analytics.</p>
	<div class="flex anchor relative">
		<h3 id="core-web-vitals-are-now-available-for-every-web-analytics-customer">Core Web Vitals are now available for every Web Analytics customer</h3>
		<a href="https://blog.cloudflare.com/#core-web-vitals-are-now-available-for-every-web-analytics-customer" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Core Web Vitals is an initiative by Google to provide unified guidance for quality signals that are essential to delivering a great user experience on the web.</p>
	<p>In September 2020, we introduced <a href="https://blog.cloudflare.com/start-measuring-web-vitals-with-browser-insights">Web Vitals</a> for customers using Browser Insights, and many customers love getting those unique insights into their website performance. But we were also aware that Browser Insights wasn't available to all our Web Analytics customers simply because they're not able to onboard to the rest of Cloudflare for Infrastructure. Specifically, they're not able to change their DNS servers.</p>
	<p>So today, we're introducing Core Web Vitals to Web Analytics as well.</p>
	<p>You can see the Core Web Vitals metrics in the same dashboard as Visits and Page Views and check how healthy your website performance is.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4yTFAINcPAo0t1S9OwIiKp/6b513be9a8cb27e075703c1d5f5fc862/image1-14.png" alt="" class="kg-image" width="1999" height="1656" loading="lazy">

	</figure>
	<div class="flex anchor relative">
		<h3 id="whats-next">What’s next</h3>
		<a href="https://blog.cloudflare.com/#whats-next" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>This is just the start for our privacy-first Web Analytics.</p>
	<p>We’re excited to integrate more closely with the rest of Cloudflare and give customers even more detailed stats about performance and security (not just traffic). We’re also hoping to make our analytics even more powerful as a standalone product by building support for alerts, real-time updates, and more.</p>
	<p>Please let us know if you have any questions or feedback, and happy measuring!</p>
</div>