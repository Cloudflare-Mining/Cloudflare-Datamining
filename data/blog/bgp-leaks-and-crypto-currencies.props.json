{
	"footerBlurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
	"initialReadingTime": "5",
	"locale": "en-us",
	"localesAvailable": [
		"zh-cn",
		"fr-fr",
		"de-de",
		"es-es"
	],
	"post": {
		"authors": [
			{
				"name": "Louis Poinsignon",
				"slug": "louis-poinsignon",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3I0nzdzXnHJm80i9p2xDA9/7e58af274690c0018ded871bd9c9de96/louis-poinsignon.jpg",
				"location": null,
				"website": null,
				"twitter": "@lpoinsig",
				"facebook": null
			}
		],
		"excerpt": "Over the few last hours, a dozen news stories have broken about how an attacker attempted (and perhaps managed) to steal cryptocurrencies using a BGP leak.",
		"feature_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2NqAg5jhZss56blwJmxK2Y/e1db9a49b9b647e398c9d87c55b7756c/bgp-leaks-and-crypto-currencies.jpg",
		"featured": false,
		"html": "<p>Over the few last hours, a <a href=\"https://www.forbes.com/sites/thomasbrewster/2018/04/24/a-160000-ether-theft-just-exploited-a-massive-blind-spot-in-internet-security/\">dozen news stories have broken</a> about how an attacker attempted (and <a href=\"https://twitter.com/killeswagon/status/988795209361252357\">perhaps managed</a>) to steal cryptocurrencies using a BGP leak.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4C9febUAV4dp0191tLDXmU/a8d8614a63ad59c6b83ee26c5ba23ae1/6818192898_c132e81824_z.jpg\" alt=\"6818192898_c132e81824_z\" class=\"kg-image\" width=\"640\" height=\"480\" loading=\"lazy\"/>\n            \n            </figure><p><a href=\"https://creativecommons.org/licenses/by/2.0/\">CC BY 2.0</a> <a href=\"https://www.flickr.com/photos/77519207@N02/6818192898/in/photolist-EGDA1W-Ga795-6yLrTS-22PPou3-gi3qi-8S6vb4-bov2cY-dgBNxk-ba28ar-ebQUDY-acXCjq-zZppue-j8nDM9-78GCT9-zFTmT1-zFT1ME-a8iKNR-6Hbzuk-bmMV3X-6Hbt1t-HkBYhJ-h7mEUc-8kza6J-inYagg-PUtWHj-cMHLr-g1zfvy-emgRCp-262Z5jD-CLumQP-M13Veh-ur2aSQ-68UJQ1\">image</a> by <a href=\"https://www.flickr.com/photos/77519207@N02/\">elhombredenegro</a></p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"what-is-bgp\">What is BGP?</h3>\n            <a href=\"#what-is-bgp\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>The Internet is composed of routes. For our DNS resolver <a href=\"https://cloudflare-dns.com/\"><b>1.1.1.1</b></a> , we tell the world that all the IPs in the range <code>1.1.1.0</code> to <code>1.1.1.255</code> can be accessed at any Cloudflare PoP.</p><p>For the people who do not have a <a href=\"/think-global-peer-local-peer-with-cloudflare-at-100-internet-exchange-points/\">direct link to our routers</a>, they receive the route via transit providers, who will deliver packets to those addresses as they are connected to Cloudflare and the rest of the Internet.</p><p>This is the normal way the Internet operates.</p><p>There are authorities (Regional Internet Registries, or RIRs) in charge of distributing IP addresses in order to avoid people using the same address space. Those are <a href=\"https://www.iana.org/\">IANA</a>, <a href=\"https://www.ripe.net\">RIPE</a>, <a href=\"https://www.arin.net\">ARIN</a>, <a href=\"https://www.lacnic.net\">LACNIC</a>, <a href=\"https://www.apnic.net\">APNIC</a> and <a href=\"https://www.afrinic.net\">AFRINIC</a>.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"what-is-a-bgp-leak\">What is a BGP leak?</h3>\n            <a href=\"#what-is-a-bgp-leak\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        \n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2CRfX9GucawxrG5pGUXig7/2a352c32b739c1ed9c8006e63548f3fb/6385512087_802c680220_z.jpg\" alt=\"Water pipe leak\" class=\"kg-image\" width=\"640\" height=\"425\" loading=\"lazy\"/>\n            \n            </figure><p><a href=\"https://creativecommons.org/licenses/by/2.0/\">CC BY 2.0</a> <a href=\"https://www.flickr.com/photos/magnus_d/6385512087/\">image</a> by <a href=\"https://www.flickr.com/photos/magnus_d/\">Magnus D</a></p><p>The broad definition of a BGP leak would be IP space that is announced by somebody not allowed by the owner of the space. When a transit provider picks up Cloudflare&#39;s announcement of <code>1.1.1.0/24</code> and announces it to the Internet, we allow them to do so. They are also verifying using the RIR information that only Cloudflare can announce it to them.</p><p>Although it can get tricky checking all the announcements. Especially when there are <b>700,000+</b> routes on the Internet and chains of providers exchanging traffic between each other.</p><p>By their nature, route leaks are localized. The more locally connected you are, the smaller the risk of accepting a leaked route is.In order to be accepted over a legitimate route, the route has to be either:</p><ul><li><p>A smaller prefix (<code>10.0.0.1/32</code> = 1 IP vs <code>10.0.0.0/24</code> = 256 IPs)</p></li><li><p>Have better metrics than a prefix with the same length (shorter path)</p></li></ul><p>The cause of a BGP leak is usually a <b>configuration mistake</b>: a router suddenly announces the IPs it learned. Or smaller prefixes used internally for traffic engineering suddenly becoming public.</p><p>But sometimes it is done with a <b>malicious intent</b>. The prefix can be re-routed through in order to passively analyze the data. Or somebody can also set-up a service to reply illegitimately instead. This has <a href=\"/why-google-went-offline-today-and-a-bit-about/\">happened before</a>.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"what-happened-today\">What happened today?</h3>\n            <a href=\"#what-happened-today\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Cloudflare maintains a range of BGP collectors gathering BGP information from hundreds of routers around the planet.</p><p>Between approximately <b>11:05:00 UTC and 12:55:00 UTC today</b> we saw the following announcements:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">BGP4MP|04/24/18 11:05:42|A|205.251.199.0/24|10297\nBGP4MP|04/24/18 11:05:42|A|205.251.197.0/24|10297\nBGP4MP|04/24/18 11:05:42|A|205.251.195.0/24|10297\nBGP4MP|04/24/18 11:05:42|A|205.251.193.0/24|10297\nBGP4MP|04/24/18 11:05:42|A|205.251.192.0/24|10297\n...\nBGP4MP|04/24/18 11:05:54|A|205.251.197.0/24|4826,6939,10297</pre></code>\n            <p>Those are more specifics announcements of the ranges:</p><ul><li><p><code>205.251.192.0/23</code></p></li><li><p><code>205.251.194.0/23</code></p></li><li><p><code>205.251.196.0/23</code></p></li><li><p><code>205.251.198.0/23</code></p></li></ul><p>This IP space is allocated to <b>Amazon</b> (AS16509). But the ASN that announced it was <b>eNet Inc</b> (AS10297) to their peers and forwarded to <b>Hurricane Electric</b> (AS6939).</p><p>Those IPs are for <a href=\"https://ip-ranges.amazonaws.com/ip-ranges.json\">Route53 Amazon DNS servers</a>. When you query for one of their client zones, those servers will reply.</p><p>During the two hours leak the servers on the IP range only responded to queries for <b>myetherwallet.com</b>. As some people noticed <a href=\"https://puck.nether.net/pipermail/outages/2018-April/011257.html\">SERVFAIL</a>.</p><p>Any DNS resolver that was asked for names handled by Route53 would ask the authoritative servers that had been taken over via the BGP leak. This poisoned DNS resolvers whose routers had accepted the route.</p><p>This included <a href=\"https://cloudflare-dns.com/\">Cloudflare DNS resolver 1.1.1.1</a>. We were affected in Chicago, Sydney, Melbourne, Perth, Brisbane, Cebu, Bangkok, Auckland, Muscat, Djibouti and Manilla. In the rest of the world, 1.1.1.1 worked normally.</p><blockquote><p>BGP hijack this morning affected Amazon DNS. eNet (AS10297) of Columbus, OH announced the following more-specifics of Amazon routes from 11:05 to 13:03 UTC today:205.251.192.0/24205.251.193.0/24205.251.195.0/24205.251.197.0/24205.251.199.0/24</p><p>— InternetIntelligence (@InternetIntel) <a href=\"https://twitter.com/InternetIntel/status/988792927068610561?ref_src=twsrc%5Etfw\">April 24, 2018</a></p></blockquote><blockquote><p>Correction: the BGP hijack this morning was against AWS DNS not Google DNS. <a href=\"https://t.co/gp3VLbImpX\">https://t.co/gp3VLbImpX</a></p><p>— InternetIntelligence (@InternetIntel) <a href=\"https://twitter.com/InternetIntel/status/988841601400270848?ref_src=twsrc%5Etfw\">April 24, 2018</a></p></blockquote><p>For instance, the following query will return you legitimate Amazon IPs:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">$ dig +short myetherwallet.com @205.251.195.239\n54.192.146.xx</pre></code>\n            <p>But during the hijack, it returned IPs associated with a <b>Russian provider</b> (AS48693 and AS41995). You did not need to accept the hijacked route to be victim of the attack, just use a DNS resolver that had been poisoned.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4bG1XFBxbEJg1akpE14ZqA/7f7f971aa49bf367eab386b15b86a1cb/Screen-Shot-2018-04-24-at-1.55.12-PM.png\" alt=\"Example of what the page would look like with a bad certificate\" class=\"kg-image\" width=\"761\" height=\"327\" loading=\"lazy\"/>\n            \n            </figure><p>If you were using HTTPS, the fake website would display a TLS certificate signed by an unknown authority (the domain listed in the certificate was correct but it was self-signed). The only way for this attack to work would be to continue and accept the wrong certificate. From that point on, everything you send would be encrypted but the attacker had the keys.</p><p>If you were already logged-in, your browser will send the login information in the cookie. Otherwise, your username and password would be sent if you typed them in on a login page.</p><p>Once the attacker got the login information, it used them on the legitimate website to transfer and steal Ethereum.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"summary-in-pictures\">Summary in pictures</h3>\n            <a href=\"#summary-in-pictures\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>Normal case</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7iaSnn0dekTUVCYRDPzZfe/61a16e2ffd729258c166b87375a06e3f/Slide1.png\" alt=\"Slide1\" class=\"kg-image\" width=\"720\" height=\"540\" loading=\"lazy\"/>\n            \n            </figure><p>After a BGP route leak</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6llrWMviALPMBhNwM4M1pY/8be9b2d2dd921583999c27edc3e8f093/Slide2.png\" alt=\"Slide2\" class=\"kg-image\" width=\"720\" height=\"540\" loading=\"lazy\"/>\n            \n            </figure>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"affected-regions\">Affected regions</h3>\n            <a href=\"#affected-regions\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>As previously mentioned, <b>AS10279</b> announced this route. But only some regions got affected. Hurricane Electric has a strong presence <b>Australia</b>, mostly due to Internet costs. <b>Chicago</b> was affected because AS10279 has a physical presence resulting in direct peering.</p><p>The following graph displays the number of packets received in the affected regions and unaffected regions (Y axis normalized). The drop is due to the authoritative server not responding to our requests anymore (it only responded for the one website and all other Amazon domains were ignored).</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4XMCIDZDvIhrjAknLNsI1L/2b4cbc6934e6a54418304570080cc16f/Screen-Shot-2018-04-24-at-1.38.03-PM.png\" alt=\"Screen-Shot-2018-04-24-at-1.38.03-PM\" class=\"kg-image\" width=\"1029\" height=\"256\" loading=\"lazy\"/>\n            \n            </figure><p>The others transits used by eNet (CenturyLink, Cogent and NTT) did not seem to have accepted this route: a reason could be that they have filters and/or Amazon as a customer.eNet provides IP services, so one of their clients could have been announcing it.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"is-there-somebody-to-blame\">Is there somebody to blame?</h3>\n            <a href=\"#is-there-somebody-to-blame\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>As there are many actors involved, it is hard to determine fault. Actors involved:</p><ul><li><p>The ISP that announced a subnet it did not own.</p></li><li><p>The transit providers that did not check the announcement before relaying it.</p></li><li><p>The ISPs that accepted the route.</p></li><li><p>The lack of protection on the DNS resolvers and authority.</p></li><li><p>The phishing website hosted on providers in Russia.</p></li><li><p>The website that did not enforce legitimate TLS certificates.</p></li><li><p>The user that clicked continue even though the TLS certificate was invalid.</p></li></ul><p>Just like a <b>blockchain</b>, a network change is usually visible and archived. RIPE maintains a <a href=\"https://ripe.net/ris/\">database for this use</a>.</p>\n          <div class=\"flex anchor relative\">\n            <h3 id=\"could-we-fix-this\">Could we fix this?</h3>\n            <a href=\"#could-we-fix-this\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n            </a>\n          </div>\n        <p>This is a difficult question to answer. There are proposals for securing BGP:Some terms can be added to the RIR databases, so a list of allowed sources can be generated:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">$ whois -h whois.radb.net &#039; -M 205.251.192.0/21&#039; | egrep &#039;^route:|^origin:|source:&#039; | paste - - - | sort\nroute:      205.251.192.0/23\torigin:     AS16509\tsource:     RADB\nroute:      205.251.192.0/23\torigin:     AS16509\tsource:     REACH</pre></code>\n            <p>Setting up RPKI/ROA records with the RIR as a source of truth regarding to the path of a route, although not everyone create those records or validate them. IP and BGP were created a few decades ago, with different requirements in mind regarding integrity and authenticity (less routes).</p><p>A few things can be done on the upper levels of the network stack.</p><p>On <b>DNS</b>, you can use <a href=\"https://en.wikipedia.org/wiki/Domain_Name_System_Security_Extensions\">DNSSEC</a> to sign your records. The IPs returned by the fake DNS would not have been signed as they do not have the private keys.If you use Cloudflare as a DNS, you can enable DNSSEC within <a href=\"https://cloudflare.com/a/dns\">a few clicks in the panel</a>.</p><p>On <b>HTTPS</b>, your browser will check the TLS certificate provided by the website. If <a href=\"https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security\">HSTS</a> is enabled, the browser will require a valid certificate all the time. The only way to generate a legitimate TLS certificate for a domain would be to poison the cache of a non-DNSSEC DNS resolver of the Certificate Authority.</p><p><a href=\"https://en.wikipedia.org/wiki/DNS-based_Authentication_of_Named_Entities\">DANE</a> provides a way of pinning certificates to a domain name using DNS.</p><p><a href=\"https://developers.cloudflare.com/1.1.1.1/dns-over-https/\">DNS over HTTPS</a> would also allow to validate you are talking to the correct resolver in case the leak would be on the DNS resolvers instead of the DNS authority.</p><p>There is no perfect and unique solution. The more of these protections are in place, the harder it will be for a malicious actor to perform this kind of attack.</p>",
		"id": "5SKcQGZX6y2OJMjWbFOiCN",
		"localeList": {
			"name": "BGP leaks and cryptocurrencies Config",
			"enUS": "English for Locale",
			"zhCN": "Translated for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "Translated for Locale",
			"deDE": "Translated for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "Translated for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2018-04-24T23:31:13.000+01:00",
		"slug": "bgp-leaks-and-crypto-currencies",
		"tags": [
			{
				"id": "5O7yCWW0RgXMAc5MVjwcGS",
				"name": "BGP",
				"slug": "bgp"
			},
			{
				"id": "56vA0Z6hqev6QaJBQmO2J8",
				"name": "TLS",
				"slug": "tls"
			},
			{
				"id": "5US4l4wdDysuDpZ4ktL3yP",
				"name": "HTTPS",
				"slug": "https"
			},
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			},
			{
				"id": "2pFyOCtANFB5qS6nbtQbVp",
				"name": "Vulnerabilities",
				"slug": "vulnerabilities"
			},
			{
				"id": "1QsJUMpv0QBSLiVZLLQJ3V",
				"name": "Cryptography",
				"slug": "cryptography"
			}
		],
		"title": "BGP leaks and cryptocurrencies",
		"updated_at": "2024-10-10T00:42:39.170Z",
		"url": "https://blog.cloudflare.com/bgp-leaks-and-crypto-currencies"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}