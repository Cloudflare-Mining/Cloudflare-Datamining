<div class="mb2 gray5">11 min read</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/5HdY4PgFwgiqnkuPlqqLg9/aa1487d8f349fb800feab4666115a7da/WhiteHouse.png" alt="">
<div class="post-content lh-copy gray1">
	<p>The Internet can feel like magic. When you load a webpage in your browser, many simultaneous requests for data fly back and forth to remote servers. Then, often in less than one second, a website appears. Many people know that DNS is used to look up a hostname, and resolve it to an IP address, but fewer understand how data flows from your home network to the network that controls the IP address of the web server.</p>
	<p>The Internet is an interconnected network of networks, operated by thousands of independent entities. To allow these networks to communicate with each other, in 1989, <a href="https://weare.cisco.com/c/r/weare/amazing-stories/amazing-things/two-napkin.html"><u>on the back of two napkins</u></a>, three network engineers devised the <a href="https://www.cloudflare.com/learning/security/glossary/what-is-bgp"><u>Border Gateway Protocol (BGP)</u></a>. It allows these independent networks to signal directions for IP prefixes they own, or that are reachable through their network. At that time, Internet security wasn’t a big deal — <a href="https://www.cloudflare.com/learning/ssl/what-is-ssl"><u>SSL</u></a>, initially developed to secure websites, wasn’t developed until 1995, six years later. So BGP wasn’t originally built with security in mind, but over time, security and availability concerns have emerged.</p>
	<p>Today, the <a href="https://www.whitehouse.gov/oncd"><u>White House Office of the National Cyber Director</u></a> issued the <a href="https://www.whitehouse.gov/oncd/briefing-room/2024/09/03/fact-sheet-biden-harris-administration-releases-roadmap-to-enhance-internet-routing-security"><u>Roadmap to Enhancing Internet Routing Security</u></a>, and we’re excited to highlight their recommendations. But before we get into that, let’s provide a quick refresher on what BGP is and why routing security is so important.</p>
	<h2>BGP: pathways through the Internet</h2>
	<p>BGP is the core signaling protocol used on the Internet. It’s fully distributed, and managed independently by all the individual operators of the Internet. With BGP, operators will send messages to their neighbors (other networks they are directly connected with, either physically or through an <a href="https://www.cloudflare.com/learning/cdn/glossary/internet-exchange-point-ixp"><u>Internet Exchange</u></a>) that indicate their network can be used to reach a specific IP prefix. These IP prefixes can be resources the network owns themselves, such as <a href="https://radar.cloudflare.com/routing/prefix/104.16.128.0/20"><u>104.16.128.0/20</u></a> for Cloudflare, or resources that are reachable through their network, by transiting the network.</p>
	<p>By exchanging all of this information between peers, each individual network on the Internet can form a full map of what the Internet looks like, and ideally, how to reach each IP address on the Internet. This map is in an almost constant state of flux: networks disappear from the Internet for a wide variety of reasons, ranging from scheduled maintenance to catastrophic failures, like the <a href="https://blog.cloudflare.com/october-2021-facebook-outage"><u>Facebook incident in 2021</u></a>. On top of this, the ideal path to take from point A (your home ISP) to point B (Cloudflare) can change drastically, depending on routing decisions made by your home ISP, and any or all intermediate networks between your home ISP and Cloudflare (<a href="https://blog.cloudflare.com/how-verizon-and-a-bgp-optimizer-knocked-large-parts-of-the-internet-offline-today"><u>here’s an example from 2019</u></a>). These <a href="https://blog.cloudflare.com/prepends-considered-harmful"><u>routing decisions</u></a> are entirely arbitrary, and left to the owners of the networks. Performance and security can be considered, but neither of these have been historically made visible through BGP itself.</p>
	<p>As all the networks can independently make their own routing decisions, there are a lot of individual points where things can go wrong. Going wrong can have multiple meanings here: this can range from routing loops, causing Internet traffic to go back and forth repeatedly between two networks, never reaching its destination, to more malicious problems, such as traffic interception or traffic manipulation.</p>
	<p>As routing security wasn’t accounted for in that initial two-napkin draft, it is easy for a malicious actor on the Internet to <a href="https://www.cloudflare.com/en-gb/learning/security/glossary/bgp-hijacking"><u>pretend to either be an originating network</u></a> (where they claim to own the IP prefix, positioning themselves as the destination network), or they can pretend to be a viable middle network, getting traffic to transit through their network.</p>
	<p>In either of these examples, the actor can manipulate the Internet traffic of unsuspecting end users and potentially steal passwords, cryptocurrency, or any other data that can be of value. While transport security (<a href="https://www.cloudflare.com/learning/ssl/transport-layer-security-tls"><u>TLS</u></a> for HTTP/1.x and HTTP/2, <a href="https://blog.cloudflare.com/the-road-to-quic"><u>QUIC</u></a> for HTTP/3) has reduced this risk significantly, there’s still ways this can be bypassed. Over time, the Internet community has acknowledged the security concerns with BGP, and has built infrastructure to mitigate some of these problems. </p>
	<h3>BGP security: The RPKI is born</h3>
	<p>This journey is now coming to a final destination with the development and adoption of the Resource Public Key Infrastructure (RPKI). The RPKI is a <a href="https://research.cloudflare.com/projects/internet-infrastructure/pki"><u>PKI</u></a>, just like the Web PKI which provides security certificates for the websites we browse (the “s” in https). The RPKI is a PKI specifically with the Internet in mind: it provides core constructs for <a href="https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address"><u>IP addresses</u></a> and <a href="https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system"><u>Autonomous System Numbers (ASNs</u></a>), the numbers used to identify these individual operating networks mentioned earlier.</p>
	<p>Through the RPKI, it’s possible for an operator to establish a cryptographically secure relationship between the IP prefixes they originate, and their ASN, through the issuance of <a href="https://www.arin.net/resources/manage/rpki/roa_request"><u>Route Origin Authorization records (ROAs)</u></a>. These ROAs can be used by all other networks on the Internet to validate that the IP prefix update they just received for a given origin network actually belongs to that origin network, a process called <a href="https://blog.cloudflare.com/rpki-updates-data"><u>Route Origin Validation (ROV)</u></a>. If a malicious party tries to hijack an IP prefix that has a ROA to their (different) origin network, validating networks would know this update is invalid and reject it, maintaining the origin security and ensuring reachability.</p>
	<h2>Why does BGP security matter? Examples of route hijacks and leaks</h2>
	<p>But why should you care about BGP? And more importantly, why does the White House care about BGP? Put simply: BGP (in)security can cost people and companies millions of dollars and cause widespread disruptions for critical services.</p>
	<p>In February 2022, Korean crypto platform KLAYswap was the target of a <a href="https://manrs.org/2022/02/klayswap-another-bgp-hijack-targeting-crypto-wallets"><u>malicious BGP hijack</u></a>, which was used to steal $1.9 million of cryptocurrency from their customers. The attackers were able to serve malicious code that mimicked the service KLAYswap was using for technical support. They were able to do this by announcing the IP prefix used to serve the JavaScript SDK KLAYswap was using. When other networks accepted this announcement, end user traffic loading the technical support page instead received malicious JavaScript, which was used to drain customer wallets. As the attackers hijacked the IP address, they were also able to register a TLS certificate for the domain name used to serve the SDK. As a result, nothing looked out of the ordinary for Klayswap’s customers until they noticed their wallets had been drained.</p>
	<p>However, not all BGP problems are intentional hijacks. In March 2022, <a href="https://radar.cloudflare.com/as8342"><u>RTComm (AS8342)</u></a>, a Russian ISP, announced itself as the origin of <a href="https://radar.cloudflare.com/routing/prefix/104.244.42.0/24"><u>104.244.42.0/24</u></a>, which is an IP prefix actually owned by <a href="https://radar.cloudflare.com/as13414"><u>Twitter (now X) (AS13414)</u></a>. In this case, all researchers have drawn a similar conclusion: RTComm wanted to block its users from accessing Twitter, but inadvertently advertised the route to its peers and upstream providers. Thankfully, the impact was limited, in large part due to Twitter issuing ROA records for their IP prefixes, which meant the hijack was blocked at all networks that had implemented ROV and were validating announcements.</p>
	<p>Inadvertent incorrect advertisements passing from one network to another, or route leaks, can happen to anyone, even Cloudflare. Our <a href="https://1.1.1.1/dns"><u>1.1.1.1 public DNS service</u></a> — used by millions of consumers and businesses — is often the unintended victim. Consider this situation (versions of which have happened numerous times): a network engineer running a local ISP is testing a configuration on their router and announces to the Internet that you can reach the IP address 1.1.1.1 through their network. They will often pick this address because it’s easy to input on the router and observe in network analytics. They accidentally push that change out to all their peer networks — the networks they’re connected to — and now, if proper routing security isn’t in place, users on multiple networks around the Internet trying to reach 1.1.1.1 might be directed to this local ISP where there is no DNS service to be found. This can lead to widespread outages.</p>
	<p>The types of routing security measures in the White House roadmap can prevent these issues. In the case of 1.1.1.1, <a href="https://rpki.cloudflare.com/?view=explorer&amp;prefix=1.1.1.0%2F24"><u>Cloudflare has ROAs in place</u></a> that tell the Internet that we originate the IP prefix that contains 1.1.1.1. If someone else on the Internet is advertising 1.1.1.1, that’s an invalid route, and other networks should stop accepting it. In the case of KLAYswap, had there been ROAs in place, other networks could have used common filtering techniques to filter out the routes pointing to the attackers malicious JavaScript. So now let’s talk more about the plan the White House has to improve routing security on the Internet, and how the US government developed its recommendations.</p>
	<h2>Work leading to the roadmap</h2>
	<p>The new routing security roadmap from the <a href="https://www.whitehouse.gov/oncd"><u>Office of the National Cyber Director (ONCD)</u></a> is the product of years of work, throughout both government and industry. The <a href="https://www.nist.gov"><u>National Institute of Standards and Technology (NIST)</u></a> has been a longstanding proponent of improving routing security, developing <a href="https://www.nist.gov/news-events/news/2014/05/nist-develops-test-and-measurement-tools-internet-routing-security"><u>test and measurement</u></a> <a href="https://rpki-monitor.antd.nist.gov"><u>tools</u></a> and publishing <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.1800-14.pdf"><u>special publication 1800-14</u></a> on Protecting the Integrity of Internet Routing, among many other initiatives. They are active participants in the Internet community, and an important voice for routing security.</p>
	<p>Cloudflare first started publicly <a href="https://blog.cloudflare.com/is-bgp-safe-yet-rpki-routing-security-initiative"><u>advocating</u></a> for adoption of security measures like RPKI after a <a href="https://blog.cloudflare.com/how-verizon-and-a-bgp-optimizer-knocked-large-parts-of-the-internet-offline-today"><u>massive BGP route leak</u></a> took down a portion of the Internet, including websites using Cloudflare’s services, in 2019.&nbsp;</p>
	<p>Since that time, the federal government has increasingly recognized the need to elevate efforts to secure Internet routing, a process that Cloudflare has helped support along the way. The <a href="https://www.solarium.gov"><u>Cyberspace Solarium Commission report</u></a>, published in 2020, encouraged the government to develop a strategy and recommendations to define “common, implementable guidance for securing the DNS and BGP.”&nbsp;&nbsp;&nbsp;&nbsp;</p>
	<p>In February 2022, the Federal Communication Commission <a href="https://www.fcc.gov/document/fcc-launches-inquiry-internet-routing-vulnerabilities"><u>launched</u></a> a notice of inquiry to better understand Internet routing. Cloudflare <a href="https://www.fcc.gov/ecfs/document/10412234101460/1"><u>responded</u></a> with a detailed explanation of our history with RPKI and routing security. In July 2023, the FCC, jointly with the Director of the <a href="https://cisa.gov"><u>Cybersecurity and Infrastructure Security Agency</u></a>, held a <a href="https://www.fcc.gov/news-events/events/2023/07/bgp-security-workshop"><u>workshop</u></a> for stakeholders, with <a href="https://youtu.be/VQhoNX2Q0aM?si=VHbB5uc-0DzHaWpL&amp;t=11462"><u>Cloudflare as one of the presenters</u></a>. In June 2024, the FCC issued a <a href="https://docs.fcc.gov/public/attachments/FCC-24-62A1.pdf"><u>Notice of Proposed Rulemaking</u></a> that would require large service providers to develop security risk management plans and report on routing security efforts, including RPKI adoption.&nbsp;</p>
	<p>The White House has been involved as well. In March 2023, they cited the need to secure the technical foundation of the Internet, from issued such as BGP vulnerabilities, as one of the strategic objectives of the <a href="https://www.whitehouse.gov/wp-content/uploads/2023/03/National-Cybersecurity-Strategy-2023.pdf"><u>National Cybersecurity Strategy</u></a>. Citing those efforts, in May 2024, the Department of Commerce <a href="https://www.commerce.gov/news/press-releases/2024/05/us-department-commerce-implements-internet-routing-security"><u>issued</u></a> <a href="https://rpki.cloudflare.com/?view=explorer&amp;asn=3477"><u>ROAs signing some of its IP space</u></a>, and this roadmap strongly encourages other departments and agencies to do the same. All of those efforts and the focus on routing security have resulted in increased adoption of routing security measures.&nbsp;</p>
	<h2>Report observations and recommendations</h2>
	<p>The report released by the White House Office of the National Cyber Director details the current state of BGP security, and the challenges associated with Resource Public Key Infrastructure (RPKI) Route Origin Authorization (ROA) issuance and RPKI Route Origin Validation (ROV) adoption. It also provides network operators and government agencies with next steps and recommendations for BGP security initiatives.&nbsp;</p>
	<p>One of the first recommendations is for all networks to create and publish ROAs. It’s important that every network issues ROAs for their IP prefixes, as it’s the only way for other networks to validate they are the authorized originator of those prefixes. If one network is advertising an IP address as their own, but a different network issued the ROA, that’s an important sign that something might be wrong!</p>
	<p>As shown in the chart below from <a href="https://rpki-monitor.antd.nist.gov"><u>NIST’s RPKI Monitor</u></a>, as of September 2024, at least 53% of all the IPv4 prefixes on the Internet have a valid ROA record available (IPv6 reached this milestone in late 2023), up from only 6% in 2017. (The metric is even better when measured as a percent of Internet traffic: data from <a href="https://kentik.com"><u>Kentik</u></a>, a network observability company, <a href="https://www.kentik.com/blog/rpki-rov-deployment-reaches-major-milestone"><u>shows</u></a> that 70.3% of Internet traffic is exchanged with IP prefixes that have a valid ROA.) This increase in the number of signed IP prefixes (ROAs) is foundational to secure Internet routing.</p>
	<figure class="kg-card kg-image-card">
		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/4f4Y1fXcdxYRxUhQYjxlWp/08f38899c936521f02def6897fda02f7/image2.png" alt="" class="kg-image" width="1960" height="912" loading="lazy">
	</figure>
	<p>Unfortunately, the US is lagging behind: <a href="https://radar.cloudflare.com/routing/us"><u>Only 39% of IP prefixes</u></a> originated by US networks have a valid ROA. This is not surprising, considering the US has significantly more Internet address resources than other parts of the world. However, the report highlights the need for the US to overcome the common barriers network operators face when implementing BGP security measures. Administrative challenges, the perception of risk, and prioritization and resourcing constraints are often cited as the problems networks face when attempting to move forward with ROV and RPKI.</p>
	<p>A related area of the roadmap highlights the need for networks that allow their customers to control IP address space to still create ROAs for those addresses. The reality of how every ISP, government, and large business allocates its IP address space is undoubtedly messy, but that doesn’t reduce the importance of making sure that the correct entity is identified in the official records with a ROA.&nbsp;</p>
	<p>A network signing routes for its IP addresses is an important step, but it isn’t enough. To prevent incorrect routes — malicious or not — from spreading around the Internet, networks need to implement Route Origin Validation (ROV) and implement other BGP best practices, outlined by <a href="https://manrs.org"><u>MANRS</u></a> in their <a href="https://manrs.org/wp-content/uploads/2023/12/The_Zen_of_BGP_Sec_Policy_Nov2023.docx.pdf"><u>Zen Guide to Routing Security Policy</u></a>. If one network incorrectly announces itself as the origin for 1.1.1.1, that won’t have any effect beyond its own borders if no other networks pick up that invalid route. The Roadmap calls out filtering invalid routes as another action for network service providers.&nbsp;</p>
	<p>As of <a href="https://blog.cloudflare.com/rpki-updates-data"><u>2022</u></a>, our data<a href="https://blog.cloudflare.com/rpki-updates-data"><u> showed</u></a> that around 15 percent of networks were validating routes. Ongoing measurements from APNIC show progress: this year about 20 percent <a href="https://stats.labs.apnic.net/rpki/XA"><u>of APNIC probes</u></a> globally correctly filter invalid routes with ROV. <a href="https://stats.labs.apnic.net/rpki/US"><u>In the US</u></a>, it’s 70 percent. Continued growth of ROV is a critical step towards achieving better BGP security.</p>
	<figure class="kg-card kg-image-card">
		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/5Ne3sPYqAEytLjO0Vm53yA/a2f1a42c8555109a98b8751670e134fc/image1.png" alt="" class="kg-image" width="1600" height="723" loading="lazy">
	</figure>
	<p>Filtering out invalid routes is prominently highlighted in the report’s recommendations. While recognizing that there’s been dramatic improvement in filtering by the large transit networks, the first report recommendation is for network service providers — large and small —&nbsp; to fully deploy ROV.&nbsp;</p>
	<p>In addition, the Roadmap proposes using the federal government’s considerable weight as a purchaser, writing, “<i>[Office of Management and Budget] should require the Federal Government’s contracted service providers to adopt and deploy current commercially-viable Internet routing security technologies.</i>” It goes on to say that grant programs, particularly broadband grants, “<i>should require grant recipients to incorporate routing security measures into their projects.</i>”</p>
	<p>The roadmap doesn’t only cover well-established best practices, but also highlights emerging security technologies, such as <a href="https://datatracker.ietf.org/doc/draft-ietf-sidrops-aspa-profile"><u>Autonomous System Provider Authorization (ASPA)</u></a> and <a href="https://datatracker.ietf.org/doc/html/rfc8205"><u>BGPsec</u></a>. ROAs only cover part of the BGP routing ecosystem, so additional work is needed to ensure we secure everything. It’s encouraging to see the work being done by the wider community to address these concerns is acknowledged, and more importantly, actively followed.</p>
	<h2>What’s next for the Internet community</h2>
	<p>The new roadmap is an important step in outlining actions that can be taken today to improve routing security. But as the roadmap itself recognizes, there’s more work to be done both in making sure that the steps are implemented, and that we continue to push routing security forward.</p>
	<p>From an implementation standpoint, our hope is that the government’s focus on routing security through all the levers outlined in the roadmap will speed up ROA adoption, and encourage wider implementation of ROV and other best practices. At Cloudflare, we’ll continue to report on routing practices on <a href="https://radar.cloudflare.com/routing/us"><u>Cloudflare Radar</u></a> to help assess progress against the goals in the roadmap.</p>
	<p>At a technical level, the wider Internet community has made massive strides in adopting RPKI ROV, and have set their sights on the next problem: we are securing the IP-to-originating network relationship, but what about the relationships between the individual networks?</p>
	<p>Through the adoption of BGPsec and ASPA, network operators are able to not only validate the destination of a prefix, but also validate the path to get there. These two new technical additions within the RPKI will combine with ROV to ultimately provide a fully secure signaling protocol for the modern Internet. The community has actively undertaken this work, and we’re excited to see it progress!</p>
	<p>Outside the RPKI, the community has also ratified the formalization of customer roles through <a href="https://datatracker.ietf.org/doc/rfc9234"><u>RFC9234: Route Leak Prevention and Detection Using Roles in UPDATE and OPEN Messages</u></a>. As this new BGP feature gains support, we’re hopeful that this will be another helpful tool in the operator toolbox in preventing route leaks of any kind.</p>
	<h2>How you can help keep the Internet secure</h2>
	<p>If you’re a network operator, you’ll need to sign your routes, and validate incoming prefixes. This consists of signing Route Origin Authorization (ROA) records, and performing Route Origin Validation (ROV). Route signing involves creating records with your local <a href="https://www.nro.net/about/rirs"><u>Regional Internet Registry (RIR)</u></a> and signing to their PKI. Route validation involves only accepting routes that are signed with a ROA. This will help ensure that only secure routes get through. You can learn more about that <a href="https://blog.cloudflare.com/rpki-updates-data"><u>here</u></a>.</p>
	<p>If you’re not a network operator, head to <a href="http://isbgpsafeyet.com"><u>isbgpsafeyet.com</u></a>, and test your ISP. If your ISP is not keeping BGP safe, be sure to let them know how important it is. If the government has pointed out prioritization is a consistent problem, let’s help increase the priority of routing security.</p>
	<h2>A secure Internet is an open Internet</h2>
	<p>As the report points out, one of the keys to keeping the Internet open is ensuring that users can feel safe accessing any site they need to without worrying about attacks that they can’t control. Cloudflare wholeheartedly supports the US government’s efforts to bolster routing security around the world and is eager to work to ensure that we can help create a safe, open Internet for every user.</p>
</div>