<div class="mb2 gray5">6 min read</div>
<div class="mt4">This post is also available in <a href="https://blog.cloudflare.com/zh-cn/saas-to-saas-security">简体中文</a>.</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1Vm0d4crO0XZ2pntuXzmCA/2fd698c9afecdbf3215b1cee8878268a/BLOG-2997_1.png" alt="">
<div class="post-content lh-copy gray1">
	<p>The recent <a href="https://blog.cloudflare.com/response-to-salesloft-drift-incident"><u>Salesloft breach</u></a> taught us one thing: connections between <a href="https://www.cloudflare.com/learning/cloud/what-is-saas"><u>SaaS applications</u></a> are hard to monitor and create blind spots for security teams with disastrous side effects. This will likely not be the last breach of this type. </p>
	<p>To fix this, Cloudflare is working towards a set of solutions that consolidates all SaaS connections via a single proxy, for easier monitoring, detection and response. A SaaS to SaaS proxy for everyone.</p>
	<p>As we build this, we need feedback from the community, both data owners and SaaS platform providers. If you are interested in gaining early access, <a href="https://www.cloudflare.com/lp/saas-to-saas-security"><u>please sign up here</u></a>.</p>
	<p>SaaS platform providers, who often offer marketplaces for additional applications, store data on behalf of their customers and ultimately become the trusted guardians. As integrations with marketplace applications take place, that guardianship is put to the test. A key breach in any one of these integrations can lead to widespread data exfiltration and tampering. As more apps are added the attack surface grows larger. Security teams who work for the data owner have no ability, today, to detect and react to any potential breach.</p>
	<p>In this post we explain the underlying technology required to make this work and help keep your data on the Internet safe.</p>
	<div class="flex anchor relative">
		<h2 id="saas-to-saas-integrations">SaaS to SaaS integrations</h2>
		<a href="https://blog.cloudflare.com/#saas-to-saas-integrations" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>No one disputes the value provided by SaaS applications and their integrations. Major SaaS companies implement flourishing integration ecosystems, often presented as marketplaces. For many, it has become part of their value pitch. Salesforce provides an <a href="https://appexchange.salesforce.com"><u>AppExchange</u></a>. Zendesk provides a <a href="https://www.zendesk.co.uk/marketplace/apps"><u>marketplace</u></a>. ServiceNow provides an <a href="https://www.servicenow.com/uk/products/integration-hub.html"><u>Integration Hub</u></a>. And so forth.</p>
	<p>These provide significant value to any organisation and complex workflows. Data analysis or other tasks that are not supported natively by the SaaS vendor are easily carried out via a few clicks.</p>
	<p>On the other hand, SaaS applications present security teams with a growing list of unknowns. Who can access this data? What security processes are put in place? And more importantly: how do we detect data leak, compromise, or other malicious intent?</p>
	<p>Following the <a href="https://blog.cloudflare.com/response-to-salesloft-drift-incident"><u>Salesloft breach</u></a>, which compromised the data of hundreds of companies, including Cloudflare, the answers to these questions are top of mind.</p>
	<div class="flex anchor relative">
		<h2 id="the-power-of-the-proxy-seamless-observability">The power of the proxy: seamless observability</h2>
		<a href="https://blog.cloudflare.com/#the-power-of-the-proxy-seamless-observability" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>There are two approaches Cloudflare is actively prototyping to address the growing security challenges SaaS applications pose, namely visibility into SaaS to SaaS connections, including anomaly detection and key management in the event of a breach. Let’s go over each of these, both relying on proxying SaaS to SaaS traffic.</p>
	<div class="flex anchor relative">
		<h3 id="1-giving-control-back-to-the-data-owner">1) Giving control back to the data owner</h3>
		<a href="https://blog.cloudflare.com/#1-giving-control-back-to-the-data-owner" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Cloudflare runs one of the world’s largest reverse proxy networks. As we terminate L7 traffic, we are able to perform security-related functions including blocking malicious requests, detecting anomalies, detecting automated traffic and so forth. This is one of the main use cases customers approach us for.</p>
	<p>Cloudflare can proxy any hostname under the customer’s control.</p>
	<p>It is this specific ability, often referred to as “vanity”, “branded” or “custom” hostnames, that allows us to act as a front door to the SaaS vendor on behalf of a customer. Provided a marketplace app integrates via a custom domain, the data owner can choose to use Cloudflare’s new SaaS integration protection capabilities. </p>
	<p>For a customer (Acme Corp in this example) to access, say SaaS Application, the URL needs to become saas.acme.com as that is under Acme’s control (and not acme.saas.com).</p>
	<p>This setup allows Cloudflare to be placed in front of SaaS Corp as the customer controls the DNS hostname. By proxying traffic, Cloudflare can be the only integration entity with programmatic access to SaaS Corp's APIs and data and transparently "swap" authorisation tokens with valid ones and issue separate tokens, using key splitting, to any integrations.&nbsp; </p>
	<figure class="kg-card kg-image-card">
		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1diK7GrWICfbRyHu2fpvFt/26eec0f692686d7d4f769abd7e2db661/image__4_.png" alt="SaaS to SaaS proxy via vanity hostnames" class="kg-image" width="1514" height="783" loading="lazy">
	</figure>
	<p>Note that in many cases, authorization and authentication flows fall outside any vanity/branded hostname. It is in fact very common for an <a href="https://www.cloudflare.com/learning/access-management/what-is-oauth"><u>OAuth</u></a> flow to still hit the SaaS provider url oauth.saas.com. It is therefore required, in this setup, for marketplace applications to provide the ability to support vanity/branded URLs for their OAuth and similar flows, oauth.saas.acme.com in the diagram above.</p>
	<p>Ultimately Cloudflare provides a full L7 <a href="https://www.cloudflare.com/learning/cdn/glossary/reverse-proxy"><u>reverse proxy</u></a> for all traffic inbound/outbound to the given SaaS provider solving for the core requirements that would lessen the impact of a similar breach to the Salesloft example. Had Salesloft integrated via a Cloudflare-proxied domain, then data owners would be able to:</p>
	<ul>
		<li>
			<p><b>Gain visibility into who or what can access data</b>, and where it’s accessed from, in the SaaS platform. Cloudflare already provides analytics and filtering tools to identify traffic sources, including hosting locations, IPs, user agents and other tools.</p>
		</li>
		<li>
			<p><b>Instantly shut off access to the SaaS provider</b> without the need to rotate credentials on the SaaS platform, as Cloudflare would be able to block access from the proxy.</p>
		</li>
		<li>
			<p><b>Detects anomalies </b>in data access by observing baselines and traffic patterns. For example a change in data exfiltration traffic flows would trigger an alert.</p>
		</li>
	</ul>
	<div class="flex anchor relative">
		<h3 id="2-improve-saas-platform-security">2) Improve SaaS platform security</h3>
		<a href="https://blog.cloudflare.com/#2-improve-saas-platform-security" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>The approach listed above assumes the end user is the company whose data is at risk. However, SaaS platforms themselves are now paying a lot of attention to marketplace applications and access patterns. From a deployment perspective, it’s actually easier to provide additional visibility to a SaaS provider as it is a standard reverse proxy deployment and we have tools designed for SaaS applications, such as <a href="https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas"><u>Cloudflare for SaaS</u></a>.</p>
	<figure class="kg-card kg-image-card">
		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3ElxtRBMqeI0GBD45BR4UC/13eee60d852991a3dfe5b2beb172584c/BLOG-2997_3.png" alt="SaaS to SaaS proxy for SaaS vendors" class="kg-image" width="1999" height="1120" loading="lazy">
	</figure>
	<p>This deployment model allows Cloudflare to proxy all traffic to the SaaS vendor, including to all API endpoints therefore gaining visibility into any SaaS to SaaS connections. As part of this, we are building improvements to our <a href="https://www.cloudflare.com/en-gb/application-services/products/api-shield"><u>API Shield solution</u></a> to provide SaaS security teams with additional controls:</p>
	<ul>
		<li>
			<p><b>Token / session logging:</b> Ability to keep track of OAuth tokens and provide session logs for audit purposes.</p>
		</li>
		<li>
			<p><b>Session anomaly detection:</b> Ability to warn when a given OAuth (or other session) shows anomalous behavior.</p>
		</li>
		<li>
			<p><b>Token / session replacement:</b> Ability to substitute SaaS-generated tokens with Cloudflare-generated tokens to allow for fast rotation and access lock down.</p>
		</li>
	</ul>
	<p>The SaaS vendor may of course expose some of the affordances to their end customer as part of their dashboard.</p>
	<div class="flex anchor relative">
		<h2 id="how-key-splitting-enables-secure-token-management">How key splitting enables secure token management</h2>
		<a href="https://blog.cloudflare.com/#how-key-splitting-enables-secure-token-management" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Both deployment approaches described above rely on our ability to control access without storing complete credentials. While we already store SSL/TLS private keys for millions of web applications, storing complete SaaS bearer tokens would create an additional security burden. To solve this, and enable the token swapping and instant revocation capabilities mentioned above, we use key splitting.</p>
	<p>Key splitting cryptographically divides bearer tokens into two mathematically interdependent fragments called Part A and Part B. Part A goes to the fourth-party integration (like Drift or Zapier) while Part B stays in Cloudflare's edge storage. Part A is just random noise that won't authenticate to Salesforce or any SaaS platform expecting complete tokens, so neither fragment is usable alone.</p>
	<p>This creates an un-bypassable control point. Integrations cannot make API calls without going through Cloudflare's proxy because they only possess Part A. When an integration needs to access data, it must present Part A to our edge where we retrieve Part B, reconstruct the token in memory for microseconds, forward the authenticated request, and then immediately clear the token. This makes sure that the complete bearer token never exists in any database or log.</p>
	<p>This forced cooperation means every API call flows through Cloudflare where we can monitor for anomalies, delete Part B to instantly revoke access (transforming incident response from hours to seconds), and maintain complete audit trails. Even more importantly, this approach minimizes our burden of storing sensitive credentials since a breach of our systems wouldn't yield usable tokens.</p>
	<p>If attackers compromise the integration and steal Part A, or somehow breach Cloudflare's storage and obtain Part B, neither fragment can authenticate on its own. This fundamentally changes the security model from protecting complete tokens to managing split fragments that are individually worthless. It also gives security teams unprecedented visibility and control over how their data is accessed across third-party integrations.</p>
	<figure class="kg-card kg-image-card">
		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/MmwLfTnQweqJiIFe4fTac/a9596a5a023ec147af4dc671ba3b5b8a/BLOG-2997_4.png" alt="key splitting token flow" class="kg-image" width="1454" height="1300" loading="lazy">
	</figure>
	<div class="flex anchor relative">
		<h2 id="regaining-control-of-your-data">Regaining control of your data</h2>
		<a href="https://blog.cloudflare.com/#regaining-control-of-your-data" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>We are excited to develop solutions mentioned above to give better control and visibility around data stored in SaaS environments, or more generally, outside a customer’s network.</p>
	<p>If you are a company worried about this risk, and would like to be notified to take part in our early access, please sign up <a href="https://www.cloudflare.com/lp/saas-to-saas-security"><u>here</u></a>.</p>
	<p>If you are a SaaS vendor who would like to provide feedback and take part in developing better API security tooling for third party integrations towards your platform, <a href="https://www.cloudflare.com/lp/saas-to-saas-security"><u>sign up here</u></a>.</p>
	<p>We are looking forward to helping you get better control of your data in SaaS to SaaS environments.</p>
</div>