<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image5-20.png" class="kg-image" alt="Application security: Cloudflare’s view"></figure>
	<p>Developers, bloggers, business owners, and large corporations all rely on Cloudflare to keep their applications secure, available, and performant.</p>
	<p>To meet these goals, over the last twelve years we have built a smart network capable of protecting many millions of Internet properties. As of March 2022, <a href="https://w3techs.com/technologies/details/cn-cloudflare" target="_blank">W3Techs reports that</a>:</p>
	<blockquote><em>“Cloudflare is used by 80.6% of all the websites whose reverse proxy service we know. This is 19.7% of all websites”</em></blockquote>
	<p>Netcraft, another provider who crawls the web and monitors adoption puts this figure at more than 20M active sites in their latest <a href="https://news.netcraft.com/archives/2022/02/28/february-2022-web-server-survey.html" target="_blank">Web Server Survey (February 2022)</a>:</p>
	<blockquote><em>“Cloudflare continues to make strong gains amongst the million busiest websites, where it saw the only notable increases, with an additional 3,200 sites helping to bring its market share up to 19.4%”</em></blockquote>
	<p>The breadth and diversity of the sites we protect, and the billions of browsers and devices that interact with them, gives us unique insight into the ever-changing application security trends on the Internet. In this post, we share some of those insights we’ve gathered from the 32 million HTTP requests/second that pass through our network.</p>
	<h2 id="definitions">Definitions</h2>
	<p>Before we examine the data, it is useful to define the terminology we use. Throughout this post, we will refer to the following terms:</p>
	<ul>
		<li><strong>Mitigated Traffic</strong>: any eyeball HTTP<strong>*</strong> request that had a “terminating” action applied to by the Cloudflare platform. These include actions such as <code>BLOCK</code>, <code>CHALLENGE</code> (such as captchas or JavaScript based challenges). This does not include requests that had the following actions applied: <code>LOG</code>, <code>SKIP</code>, <code>ALLOW</code>.</li>
		<li><strong>Bot Traffic/Automated Traffic</strong>: any HTTP request identified by Cloudflare’s <a href="https://www.cloudflare.com/products/bot-management/" target="_blank">Bot Management</a> system as being generated by a bot. This includes requests scored between <a href="https://developers.cloudflare.com/bots/concepts/bot-score/" target="_blank">1 and 29</a>.</li>
		<li><strong>API Traffic</strong>: any HTTP request with a response content type of <code>XML</code>, <code>JSON</code>, <code>gRPC</code>, or similar. Where the response content type is not available, such as for mitigated requests, the equivalent <code>Accept</code> content type (specified by the user agent) is used instead. In this latter case API traffic won’t be fully accounted for, but for insight purposes it still provides a good representation.</li>
	</ul>
	<p>Unless otherwise stated, the time frame evaluated in this post is the three-month period from December 1, 2021, to March 1, 2022.</p>
	<p>Finally, please note that the data is calculated based only on traffic observed across the Cloudflare network and does not necessarily represent overall HTTP traffic patterns across the Internet.</p>
	<!--kg-card-begin: markdown-->
	<p><small>*When referring to HTTP traffic we mean both HTTP and HTTPS.</small></p>
	<!--kg-card-end: markdown-->
	<h2 id="global-traffic-insights">Global Traffic Insights</h2>
	<p>The first thing we can look at is traffic mitigated across all HTTP requests proxied by the Cloudflare network. This will give us a good baseline view before drilling into specific traffic types, such as bot and API traffic.</p>
	<h3 id="8-of-all-cloudflare-http-traffic-is-mitigated">8% of all Cloudflare HTTP traffic is mitigated</h3>
	<p>Cloudflare proxies ~32 million HTTP requests per second on average, with more than ~44 million HTTP requests per second at peak. Overall, ~2.5 million requests per second are mitigated by our global network and never reach our caches or the origin servers, ensuring our customers’ bandwidth and compute power is only used for clean traffic.</p>
	<p>Site owners using Cloudflare gain access to tools to mitigate unwanted or malicious traffic and allow access to their applications only when a request is deemed clean. This can be done both using fully managed features, such as our <a href="https://www.cloudflare.com/ddos/" target="_blank">DDoS mitigation</a>, <a href="https://www.cloudflare.com/waf/" target="_blank">WAF</a> managed ruleset or schema validation, as well as custom rules that allow users to define their own filters for blocking traffic.</p>
	<p>If we look at the top five Cloudflare features (sources) that mitigated traffic, we get a clear picture of how much each Cloudflare feature is contributing towards helping keep customer sites and applications online and secure:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image7-1.png" class="kg-image" title="Chart"></figure>
	<p>Tabular format for reference:</p>
	<!--kg-card-begin: markdown-->
	<style>
		table {
			width: 100%;
		}
	</style>
	<table>
		<thead>
			<tr>
				<th>Source</th>
				<th>Percentage %</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Layer 7 DDoS mitigation</td>
				<td>66.0%</td>
			</tr>
			<tr>
				<td>Custom WAF Rules</td>
				<td>19.0%</td>
			</tr>
			<tr>
				<td>Rate Limiting</td>
				<td>10.5%</td>
			</tr>
			<tr>
				<td>IP Threat Reputation</td>
				<td>2.5%</td>
			</tr>
			<tr>
				<td>Managed WAF Rules</td>
				<td>1.5%</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>Looking at each mitigation source individually:</p>
	<ul>
		<li><strong>Layer 7 DDoS mitigation, </strong>perhaps unsurprisingly,<strong> </strong>is the largest contributor to mitigated HTTP requests by total count (66% overall). Cloudflare’s layer 7 DDoS rules are fully managed and don’t require user configuration: they automatically detect a vast array of HTTP DDoS attacks including those generated by the <a href="https://blog.cloudflare.com/meris-botnet/">Meris botnet</a>, <a href="https://blog.cloudflare.com/cloudflare-blocks-an-almost-2-tbps-multi-vector-ddos-attack/">Mirai botnet</a>, known attack tools, and others. Volumetric DDoS attacks, by definition, create a lot of malicious traffic!</li>
		<li><strong>Custom WAF Rules</strong> contribute to more than 19% of mitigated HTTP traffic. These are user-configured rules defined using Cloudflare’s <a href="https://developers.cloudflare.com/ruleset-engine/rules-language/" target="_blank">wirefilter syntax</a>. We explore common rule patterns further down in this post.</li>
		<li>Our <strong>Rate Limiting</strong> feature allows customers to define custom thresholds based on application preferences. It is often used as an additional layer of protection for applications against traffic patterns that are too low to be detected as a DDoS attack. Over the time frame analyzed, rate limiting contributed to 10.5% of mitigated HTTP requests.</li>
		<li><strong>IP Threat Reputation</strong> is exposed in the Cloudflare dashboard as Security Level. Based on behavior we observe across the network, Cloudflare automatically assigns a threat score to each IP address. When the threat score is above the specified threshold, we challenge the traffic. This accounts for 2.5% of all mitigated HTTP requests.<br></li>
		<li>Our <strong>Managed WAF Rules</strong> are rules that are handcrafted by our internal security analyst team aimed at matching only against valid malicious payloads. They contribute to about 1.5% of all mitigated requests.</li>
	</ul>
	<h3 id="http-anomalies-are-the-most-common-attack-vector">HTTP anomalies are the most common attack vector</h3>
	<p>If we drill into Managed WAF Rules, we get a clear picture of what type of attack vectors malicious users are attempting against the Internet properties we protect.</p>
	<p>The vast majority (over 54%) of HTTP requests blocked by our Managed WAF Rules contain HTTP anomalies, such as malformed method names, null byte characters in headers, non-standard ports or content length of zero with a <code>POST</code> request.</p>
	<p>Common attack types in this category are shown below. These have been grouped when relevant:</p>
	<!--kg-card-begin: markdown-->
	<style>
		table {
			width: 100%;
		}
	</style>
	<table>
		<thead>
			<tr>
				<th>Rule Type</th>
				<th>Description</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Missing User Agent</td>
				<td>These rules will block any request without a <code>User-Agent</code> header. All browsers and legitimate crawlers present this header when connecting to a site. Not having a user agent is a common signal of a malicious request.</td>
			</tr>
			<tr>
				<td>Not <code>GET</code>, <code>POST</code> or <code>HEAD</code> Method</td>
				<td>Most applications only allow standard <code>GET</code> or <code>POST</code> requests (normally used for viewing pages or submitting forms). <code>HEAD</code> requests are also often sent from browsers for security purposes. Customers using our Managed Rules can easily block any other method - which normally results in blocking a large number of vulnerability scanners.</td>
			</tr>
			<tr>
				<td>Missing Referer</td>
				<td>When users navigate applications, browsers use the <code>Referer</code> header to indicate where they are coming from. Some applications expect this header to always be present.</td>
			</tr>
			<tr>
				<td>Non-standard port</td>
				<td>Customers can configure Cloudflare Managed Rules to block HTTP requests trying to access non-standard ports (such as 80 and 443). This is activity normally seen by vulnerability scanners.</td>
			</tr>
			<tr>
				<td>Invalid UTF-8 encoding</td>
				<td>It is common for attackers to attempt to break an application server by sending “special” characters that are not valid in UTF-8 encoding.</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>More commonly known and referenced attack vectors such as XSS and SQLi only contribute to about 13% of total mitigated requests. More interestingly, attacks aimed at information disclosure are third most popular (10%) and software-specific CVE-based attacks account for about 12% of mitigated requests (more than SQLi alone) highlighting both the importance of needing to patch software quickly, and the likelihood of CVE proof-of-concepts (PoCs) being used to compromise applications, such as with the recent <a href="https://blog.cloudflare.com/tag/log4j/">Log4J</a> vulnerability. The top 10 attack vectors by percentage of mitigated requests are shown below:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image1-96.png" class="kg-image" title="Chart"></figure>
	<p>Tabular format for reference:</p>
	<!--kg-card-begin: markdown-->
	<style>
		table {
			width: 100%;
		}
	</style>
	<table>
		<thead>
			<tr>
				<th>Source</th>
				<th>Percentage %</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>HTTP Anomaly</td>
				<td>54.5%</td>
			</tr>
			<tr>
				<td>Vendor Specific CVE</td>
				<td>11.8%</td>
			</tr>
			<tr>
				<td>Information Disclosure</td>
				<td>10.4%</td>
			</tr>
			<tr>
				<td>SQLi</td>
				<td>7.0%</td>
			</tr>
			<tr>
				<td>XSS</td>
				<td>6.1%</td>
			</tr>
			<tr>
				<td>File Inclusion</td>
				<td>3.3%</td>
			</tr>
			<tr>
				<td>Fake Bots</td>
				<td>3.0%</td>
			</tr>
			<tr>
				<td>Command Injection</td>
				<td>2.7%</td>
			</tr>
			<tr>
				<td>Open Redirects</td>
				<td>0.1%</td>
			</tr>
			<tr>
				<td>Other</td>
				<td>1.5%</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<h3 id="businesses-still-rely-on-ip-address-based-access-lists-to-protect-their-assets">Businesses still rely on IP address-based access lists to protect their assets</h3>
	<p>In the prior section, we noted that 19% of mitigated requests come from Custom WAF Rules. These are rules that Cloudflare customers have implemented using the <a href="https://developers.cloudflare.com/ruleset-engine/rules-language/" target="_blank">wirefilter syntax</a>. At time of writing, Cloudflare customers had a total of ~6.5 million Custom WAF rules deployed.</p>
	<p>It is interesting to look at what rule fields customers are using to identify malicious traffic, as this helps us focus our efforts on what other fully automated mitigations could be implemented to improve the Cloudflare platform.</p>
	<p>The most common field, found in approximately 64% of all custom rules, remains the source IP address or fields easily derived from the IP address, such as the client country location. Note that IP addresses are becoming <a href="https://blog.cloudflare.com/icloud-private-relay/">less useful</a> signals for security policies, but they are often the quickest and simplest type of filter to implement during an attack. Customers are also starting to adopt better approaches such as those offered in our <a href="https://www.cloudflare.com/products/zero-trust/zero-trust-network-access/" target="_blank">Zero Trust portfolio</a> to further reduce reliance on IP address-based fields.</p>
	<p>The top 10 fields are shown below:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image2-79.png" class="kg-image" title="Chart"></figure>
	<p>Tabular format for reference:</p>
	<!--kg-card-begin: markdown-->
	<style>
		table {
			width: 100%;
		}
	</style>
	<table>
		<thead>
			<tr>
				<th>Field name</th>
				<th>Used in % of rules</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>ip</td>
				<td>64.9%</td>
			</tr>
			<tr>
				<td>ip_geoip_country</td>
				<td>27.3%</td>
			</tr>
			<tr>
				<td>http_request_uri</td>
				<td>24.1%</td>
			</tr>
			<tr>
				<td>http_user_agent</td>
				<td>21.8%</td>
			</tr>
			<tr>
				<td>http_request_uri_path</td>
				<td>17.8%</td>
			</tr>
			<tr>
				<td>http_referer</td>
				<td>8.6%</td>
			</tr>
			<tr>
				<td>cf_client_bot</td>
				<td>8.3%</td>
			</tr>
			<tr>
				<td>http_host</td>
				<td>7.8%</td>
			</tr>
			<tr>
				<td>ip_geoip_asnum</td>
				<td>5.8%</td>
			</tr>
			<tr>
				<td>cf_threat_score</td>
				<td>4.4%</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>Beyond IP addresses, standard HTTP request fields (<code>URI</code>, <code>User-Agent</code>, <code>Path</code>, <code>Referer</code>) tend to be the most popular. Note, also, that across the entire rule corpus, the average rule combines at least three independent fields.</p>
	<h2 id="bot-traffic-insights">Bot Traffic Insights</h2>
	<p>Cloudflare has long offered a <a href="https://www.cloudflare.com/products/bot-management/" target="_blank">Bot Management</a> solution to allow customers to gain insights into the automated traffic that might be accessing their application. Using Bot Management classification data, we can perform a deep dive into the world of bots.</p>
	<h3 id="38-of-http-traffic-is-automated">38% of HTTP traffic is automated</h3>
	<p>Over the time period analyzed, bot traffic accounted for about 38% of all HTTP requests. This traffic includes bot traffic from hundreds of <a href="https://radar.cloudflare.com/verified-bots" target="_blank">Verified Bots tracked by Cloudflare</a>, as well as any request that received a bot score below 30, indicating a high likelihood that it is automated.</p>
	<p>Overall, when bot traffic matches a security configuration, customers allow 41% of bot traffic to pass to their origins, blocking only 6.4% of automated requests. Remember that this includes traffic coming from <a href="https://blog.cloudflare.com/friendly-bots/">Verified Bots</a> like GoogleBot, which ultimately benefits site owners and end users. It’s a reminder that automation in and of itself is not necessarily detrimental to a site. &nbsp;This is why we segment Verified Bot traffic, and why we give customers a granular bot score, rather than a binary “bot or not bot” indicator. Website operators want the flexibility to be precise with their response to different types of bot traffic, and we can see that they do in fact use this flexibility. Note that our self-serve customers can also decide how to handle bot traffic using our <a href="https://blog.cloudflare.com/super-bot-fight-mode/">Super Bot Fight Mode</a> feature.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image6-6.png" class="kg-image" title="Chart"></figure>
	<p>Tabular data for reference:</p>
	<!--kg-card-begin: markdown-->
	<style>
		table {
			width: 100%;
		}
	</style>
	<table>
		<thead>
			<tr>
				<th>Action on all bot traffic</th>
				<th>Percentage %</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>allow</td>
				<td>40.9%</td>
			</tr>
			<tr>
				<td>log</td>
				<td>31.9%</td>
			</tr>
			<tr>
				<td>bypass</td>
				<td>19.0%</td>
			</tr>
			<tr>
				<td>block</td>
				<td>6.4%</td>
			</tr>
			<tr>
				<td>jschallenge</td>
				<td>0.5%</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<h3 id="more-than-a-third-of-non-verified-bot-http-traffic-is-mitigated">More than a third of non-verified bot HTTP traffic is mitigated</h3>
	<p>31% of all bot traffic observed by Cloudflare is not verified, and comes from thousands of custom-built automated tools like scanners, crawlers, and bots built by hackers. As noted above, automation does not necessarily mean these bots are performing malicious actions. If we look at customer responses to identified bot traffic, we find that 38.5% of HTTP requests from non-verified bots are mitigated. This is obviously a much more defensive configuration compared to overall bot traffic actions shown above:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image4-17.png" class="kg-image" title="Chart"></figure>
	<p>Tabular data for reference:</p>
	<!--kg-card-begin: markdown-->
	<style>
		table {
			width: 100%;
		}
	</style>
	<table>
		<thead>
			<tr>
				<th>Action on non-verified bot traffic</th>
				<th>Percentage %</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>block</td>
				<td>34.0%</td>
			</tr>
			<tr>
				<td>log</td>
				<td>28.6%</td>
			</tr>
			<tr>
				<td>allow</td>
				<td>14.5%</td>
			</tr>
			<tr>
				<td>bypass</td>
				<td>13.2%</td>
			</tr>
			<tr>
				<td>managed_challenge</td>
				<td>3.7%</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>You’ll notice that almost 30% of customers log traffic rather than take immediate action. We find that many enterprise customers choose to not immediately block bot traffic, so they don’t give a feedback signal to attackers. Rather, they prefer to tag and monitor this traffic, and either drop at a later time or redirect to alternate content. As targeted attack vectors have evolved, responses to those attacks have had to evolve and become more sophisticated as well. Additionally, nearly 3% of non-verified bot traffic is automatically mitigated by our DDoS protection (<code>connection_close</code>). These requests tend to be part of botnets used to attack customer applications.</p>
	<h2 id="api-traffic-insights">API Traffic Insights</h2>
	<p>Many applications built on the Internet today are not meant to be consumed by humans. Rather, they are intended for computer-to-computer communication. The common way to expose an application for this purpose is to build an <a href="https://www.cloudflare.com/learning/security/api/what-is-an-api/" target="_blank">Application Programming Interface</a> (API) that can be accessed using HTTP.</p>
	<p>Due to the underlying format of the data in transit, API traffic tends to be a lot more structured than standard web applications, causing all sorts of problems from a security standpoint. First, the structured data often causes Web Application Firewalls (WAFs) to generate a large number of false positives. Secondly, due to the nature of APIs, they often go unnoticed, and many companies end up exposing old and unmaintained APIs without knowing, often referred to as “shadow APIs”.</p>
	<p>Below, we look at some differences in API trends compared to the global traffic insights shown above.</p>
	<h3 id="10-of-api-traffic-is-mitigated">10% of API traffic is mitigated</h3>
	<p>A good portion of bot traffic is accessing API endpoints, and <a href="https://blog.cloudflare.com/landscape-of-api-traffic/">as discussed previously</a>, API traffic is the fastest growing traffic type on the Cloudflare network, currently accounting for 55% of total requests.</p>
	<p>API endpoints globally receive more malicious requests compared to standard web applications (10% vs 8%) potentially indicating that attackers are focusing more on APIs for their attack surface as opposed to standard web apps.</p>
	<p>Our DDoS mitigation is still the top source of mitigated events for API endpoints, accounting for just over 63% of the total mitigated requests. More interestingly, Custom WAF rules account for 35% compared to 19% when looking at global traffic. Customers have, to date, been heavily using WAF Custom Rules to lock down and validate traffic to API endpoints, although we expect our <a href="https://blog.cloudflare.com/api-gateway/">API Gateway</a> schema validation feature to soon surpass Custom WAF Rules in terms of mitigated traffic.</p>
	<h3 id="sqli-is-the-most-common-attack-vector-on-api-endpoints">SQLi is the most common attack vector on API endpoints</h3>
	<p>If we look at our WAF Managed Rules mitigations on API traffic only, we see notable differences compared to global trends. These differences include much more equal distribution across different types of attacks, but more noticeably, SQL injection attacks in the top spot.</p>
	<p>Command Injection attacks are also much more prominent (14.3%), and vectors such as Deserialization make an appearance, contributing to more than 1% of the total mitigated requests.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image3-36.png" class="kg-image" title="Chart"></figure>
	<p>Tabular data for reference:</p>
	<!--kg-card-begin: markdown-->
	<style>
		table {
			width: 100%;
		}
	</style>
	<table>
		<thead>
			<tr>
				<th>Source</th>
				<th>Percentage %</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>SQLi</td>
				<td>34.5%</td>
			</tr>
			<tr>
				<td>HTTP Anomaly</td>
				<td>18.2%</td>
			</tr>
			<tr>
				<td>Vendor Specific CVE</td>
				<td>14.5%</td>
			</tr>
			<tr>
				<td>Command Injection</td>
				<td>14.3%</td>
			</tr>
			<tr>
				<td>XSS</td>
				<td>7.3%</td>
			</tr>
			<tr>
				<td>Fake Bots</td>
				<td>5.8%</td>
			</tr>
			<tr>
				<td>File Inclusion</td>
				<td>2.3%</td>
			</tr>
			<tr>
				<td>Deserialization</td>
				<td>1.2%</td>
			</tr>
			<tr>
				<td>Information Disclosure</td>
				<td>0.6%</td>
			</tr>
			<tr>
				<td>Other</td>
				<td>1.3%</td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<h2 id="looking-ahead">Looking ahead</h2>
	<p>In this post we shared some initial insights around Internet application security trends based on traffic to Cloudflare’s network. Of course, we have only just scratched the surface. Moving forward, we plan to publish quarterly reports with dynamic filters directly on <a href="https://radar.cloudflare.com/" target="_blank">Cloudflare Radar</a> and provide much deeper insights and investigations.</p>
</div>