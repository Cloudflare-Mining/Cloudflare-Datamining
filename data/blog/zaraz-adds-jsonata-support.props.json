{
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Yo'av Moshe",
				"slug": "yoav",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/26RcxowCLD305zrVRKtZES/65ac8530cbe80cf569f48d2d9926f82c/yoav.jpeg",
				"location": null,
				"website": null,
				"twitter": "@yoavmoshe",
				"facebook": null
			}
		],
		"excerpt": "Discover the seamless integration of Cloudflare Zaraz and JSONata, enabling precise data customization for enhanced workflows. Effortlessly optimize data transmission to providers and APIs with ease. Unlock the power of fine-tuned data today",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/7cqkkjNIki9BkD26Is7ByM/576ae3db070825fcfe165612274d1ce8/zaraz-adds-jsonata-support.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/3KHrDvLnG9ZIhs7000zsYn/61ad1ce6f6eb5dc4e4167428ea2a2c02/image1-44.png\" alt=\"Cloudflare Zaraz supports JSONata\" class=\"kg-image\" width=\"1999\" height=\"1125\" loading=\"lazy\"/>\n            \n            </figure><p>Cloudflare users leverage Zaraz for loading their third-party JavaScript tools. Tools like analytics, conversion pixels, widgets and alike, <a href=\"/cloudflare-acquires-zaraz-to-enable-cloud-loading-of-third-party-tools/\">load faster and safer when loaded through Zaraz</a>.</p><p>When configuring a tool in Zaraz, users can specify the payload to be included when sending information to it. This allows for the transmission of more detailed data. For example, when sending the &quot;Button Clicked&quot; event to Google Analytics, users can include additional information such as the ID of the button element and the content of the <code>user_id</code> cookie at the time of the button press. In Zaraz, users have the flexibility to add as many fields as desired when configuring the action.</p><p>Typically, information reaches Zaraz through the execution of <code>zaraz.track(&quot;event name&quot;, { properties })</code> within the website&#39;s code. The <code>properties</code> object can contain relevant details that will be sent to third-party tools, such as the button ID in the previous example. However, there are cases where users may need to process and manipulate the information before sending it to their third-party tools.</p><p>To address this requirement, we recently introduced <a href=\"/dynamic-data-collection-with-zaraz-worker-variables/\">Worker Variables</a>, which enables users to send information to a Cloudflare Worker, perform manipulations on it, and return a modified value. This feature offers immense power and flexibility. For instance, users can communicate with their backend server to retrieve data and leverage JavaScript to perform necessary calculations. With Worker Variables, users have access to a fully-featured Worker, opening up endless possibilities.</p><p>However, feedback from our users highlighted the need for a middle-ground solution. Sometimes, the data manipulation required is minor, and employing a Cloudflare Worker might feel like overkill. It is in response to this feedback that we decided to integrate with <a href=\"https://jsonata.org/\">JSONata</a>.</p><h3>What is JSONata?</h3><p>JSONata calls itself a JSON query and transformation language. While some developers may already be familiar with jq, the command-line JSON processor, JSONata offers similar features with a syntax that we believe is more intuitive and easier to understand. Since JSONata is a JavaScript library, it was very easy to integrate into Cloudflare Zaraz.</p><p>Let’s say we have JSON document like the following:</p>\n            <pre class=\"language-javascript\"><code class=\"language-javascript\">{\n  \"name\": \"Jane Smith\",\n  \"address\": {\n    \"street\": \"123 High St\",\n    \"city\": \"London\"\n  },\n  \"pets\": [\n    { \"type\": \"hamster\", \"name\": \"Rex\" },\n    { \"type\": \"parrot\", \"name\": \"Milo\" },\n    { \"type\": \"parrot\", \"name\": \"Alfie\" }\n  ]\n}</pre></code>\n            <p>With JSONata, with JSONata, one can run interesting queries on the document:</p>\n            <pre class=\"language-javascript\"><code class=\"language-javascript\">$count(pets) // 3\n\naddress.city // London\n\npets[type=\"parrot\"].name // [\"Alfie\", \"Milo\"]</pre></code>\n            <p>The JSONata documentation includes many examples for what you do with it, and there’s even <a href=\"https://try.jsonata.org/\">a playground</a> where you can try your JSONata queries live.</p><h3>Using JSONata with Zaraz</h3><p>JSONata has been tightly integrated with Cloudflare Zaraz, allowing you to leverage its capabilities in the fields of all Actions, Triggers, and Variables. Before diving into writing your JSONata expressions, it&#39;s essential to understand the JSON document you&#39;ll be working with.</p><p>Similar to Worker Variables or the HTTP Request tool, JSONata has access to the Zaraz Context. This object contains information from your <code>zaraz.track()</code> and <code>zaraz.ecommerce()</code> calls, as well as automatically gathered data by Zaraz, such as the current page URL, cookies, page title, user-agent string, and more. You can find the complete reference for this object in <a href=\"https://developers.cloudflare.com/zaraz/reference/context/\">the Zaraz documentation</a>.</p><p>Using your JSONata query is straightforward once you are familiar with it. To incorporate the query into your field content, simply enclose it within double curly brackets. The expression will be passed to JSONata along with the Zaraz Context object, and the resulting value will be used for the field.</p><p>Let&#39;s explore two examples from our documentation. Often, there&#39;s a need to convert a string to lowercase, such as when comparing it to another value in a regular expression. Suppose the original string is derived from a cookie named <code>loggedIn</code>, that specifies if the current user is logged in. In that case, we can use JSONata to transform the value to lowercase using the expression $lowercase(system.cookies.loggedIn). If we want to use this expression within a trigger, we navigate to the Zaraz dashboard and choose our trigger, locate the relevant match rule, and enter {{ $lowercase(system.cookies.loggedIn) }} as the value. Now, the cookie value will be compared in its lowercase format.</p>\n            <figure class=\"kg-card kg-image-card kg-width-wide\">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/7FgInwKRsFuMNM0YpjuVbn/4d8c18d561e9753edf6753eb33165f6f/image2-39.png\" alt=\"\" class=\"kg-image\" width=\"1999\" height=\"840\" loading=\"lazy\"/>\n            \n            </figure><p>You can also run simple calculations. Assuming you are using <code>zaraz.track()</code> to send the cart content like this:</p>\n            <pre class=\"language-javascript\"><code class=\"language-javascript\">zaraz.track(\"Cart Viewed\",\n  {  products:\n\t[\n\t{\n  \tsku: '2671033',\n  \tname: 'V-neck T-shirt',\n  \tprice: 14.99,\n  \tquantity: 3\n\t},{\n  \tsku: '2671034',\n  \tname: 'T-shirt',\n  \tprice: 10.99,\n  \tquantity: 2\n\t},\n\t],\n  }\n);</pre></code>\n            <p>If the field in which you want to include the total sum of all products, you will enter {{ $sum(client.products.(price * quantity)) }}. This will multiply the price of each product by its quantity, and then sum up the total.</p>\n            <figure class=\"kg-card kg-image-card kg-width-wide\">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/6nbdz3jTkzgSojEw0MhXqU/171f8c64ca65968f809dd9395a723e90/image3-31.png\" alt=\"\" class=\"kg-image\" width=\"1950\" height=\"1102\" loading=\"lazy\"/>\n            \n            </figure><h3>Start using JSONata today</h3><p>JSONata support is available to all Zaraz users at no cost, and it is enabled automatically for all websites. Start using JSONata today to send finely tuned data to your providers or APIs with minimal code and zero maintenance for your data infrastructure. If you need any help - join <a href=\"https://discord.gg/2TRr6nSxdd\">our Discord channel</a>!</p>",
		"id": "11BUBHj8lD7Rox2DYHBmft",
		"localeList": {
			"name": "Cloudflare Zaraz supports JSONata Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "Discover the seamless integration of Cloudflare Zaraz and JSONata, enabling precise data customization for enhanced workflows. Effortlessly optimize data transmission to providers and APIs with ease. Unlock the power of fine-tuned data today",
		"metadata": {
			"title": "Cloudflare Zaraz supports JSONata",
			"description": "Discover the seamless integration of Cloudflare Zaraz and JSONata, enabling precise data customization for enhanced workflows. Effortlessly optimize data transmission to providers and APIs with ease. Unlock the power of fine-tuned data today",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4byunYAagwm822nVlhWHzF/ceeb7263092cf4621e33e6a4aa7bd215/zaraz-adds-jsonata-support-PwRhD8.png"
		},
		"primary_author": {},
		"published_at": "2023-06-27T14:00:56.000+01:00",
		"reading_time": 3,
		"slug": "zaraz-adds-jsonata-support",
		"tags": [
			{
				"id": "5KsuE8WNLu5C4uyvr4XWCV",
				"name": "Zaraz",
				"slug": "zaraz"
			}
		],
		"title": "Cloudflare Zaraz supports JSONata",
		"updated_at": "2024-08-27T01:08:31.304Z",
		"url": "https://blog.cloudflare.com/zaraz-adds-jsonata-support"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}