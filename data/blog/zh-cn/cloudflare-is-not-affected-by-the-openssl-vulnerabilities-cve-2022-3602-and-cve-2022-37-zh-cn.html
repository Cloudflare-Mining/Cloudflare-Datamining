<div class="mb2 gray5">4 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image1-6.png" class="kg-image" alt="Cloudflare is not affected by the OpenSSL vulnerabilities CVE-2022-3602 and CVE-2022-37" loading="lazy"></figure>
	<p>昨天（2022 年 11 月 1 日），OpenSSL 发布了 3.0.7 版，以修复 OpenSSL 3.0.x 加密库中的两个高危漏洞： <a href="https://www.openssl.org/news/secadv/20221101.txt" target="_blank">CVE-2022-3602 和 CVE-2022-3786</a>。 Cloudflare 不受这些漏洞的影响，因为我们的产品<a href="https://blog.cloudflare.com/make-ssl-boring-again">使用 BoringSSL</a>。</p>
	<p>这些漏洞是内存损坏问题，可被攻击者利用在受害者的机器中执行任意代码。CVE-2022-3602 最初宣布时被定为严重级别，但后来被降为高级别，因为这个漏洞被认为难以通过远程代码执行（RCE）利用。与之前 OpenSSL 用户几乎普遍受到攻击的情况不同，使用其他版本 OpenSSL 的软件（例如 1.1.1）的软件不易受到这种攻击。</p>
	<h3 id="-">这些问题如何影响客户端和服务器？</h3>
	<p>这些漏洞存在于负责 X.509 证书验证的代码中 —— 大多在客户端执行，用于<a href="https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake" target="_blank">验证服务器和提供的证书</a>。要受到这些漏洞的影响，受害者（客户端或服务器）需要满足以下几个条件：</p>
	<ul>
		<li>恶意证书需要由受害者信任的证书颁发机构（CA）签名。</li>
		<li>受害者需要验证恶意证书，或忽略来自浏览器的一系列警告。</li>
		<li>受害者需要运行 3.0.7 以前的OpenSSL 3.0.x 版本。</li>
	</ul>
	<p>客户端受到这个漏洞影响的条件是，访问一个恶意站点，且后者提供的证书包含利用漏洞的有效负载。此外，该恶意证书必须由受信任的证书颁发机构（CA）签名。</p>
	<p>如果运行受影响版本 OpenSSL 的服务器支持双向验证（在此情况下，客户端和服务器均提供一个有效和签名的 X.509 证书，且客户端能向服务器提交一个带有利用负载的证书），则服务器可受到攻击。</p>
	<h3 id="--1">应该如何处理这个问题？</h3>
	<p>如果你正在管理运行 OpenSSL 的服务，你应该给存在漏洞的 OpenSSL 包进行修补。在 Linux 系统上，可以使用 <code>lsof</code> 命令确定是否有进程动态加载 OpenSSL。如下示例中，发现 NGINX 正在使用 OpenSSL。</p><!--kg-card-begin: markdown-->
	<pre><code class="language-bash">root@55f64f421576:/# lsof | grep libssl.so.3
nginx   1294     root  mem       REG              254,1           925009 /usr/lib/x86_64-linux-gnu/libssl.so.3 (path dev=0,142)
</code></pre>
	<!--kg-card-end: markdown-->
	<p>一旦 Linux 发行版的包维护者发布 OpenSSL 3.0.7，你就可以通过更新包源和升级 libssl3 包来进行修补。在 Debian 和 Ubuntu 上，这可以通过 apt-get upgrade 命令来完成</p><!--kg-card-begin: markdown-->
	<pre><code class="language-bash">root@55f64f421576:/# apt-get --only-upgrade install libssl3
</code></pre>
	<!--kg-card-end: markdown-->
	<p>尽管如此，你有可能正在运行一个受影响版本的 OpenSSL，但 <code>lsof</code> 命令无法发现，因为你的进程是静态编译的。必须对你负责的静态编译软件进行更新，并确保在未来几天内更新你的操作系统和其他安装的软件，其中可能包含易受攻击的 OpenSSL 版本。</p>
	<h3 id="--2">关键要点</h3>
	<p>Cloudflare 使用 BoringSSL，因而确信在漏洞发布日期之前，该问题不会对我们造成影响。</p>
	<p>更普遍而言，该漏洞提醒人们，内存安全仍然是一个重要问题。这个问题可能难以被利用，因为它需要一个恶意制作并由受信任 CA 签名的证书，而证书颁发机构很可能将开始验证其签名的证书不包含利用这些漏洞的有效负载。然而，鉴于问题的严重性，打补丁并将易受攻击的 OpenSSL 包升级到 OpenSSL 3.0.7 仍然很重要。</p>
	<p><em>若要进一步了解我们帮助构建更美好互联网的使命，请<a href="https://www.cloudflare.com/learning/what-is-cloudflare" target="_blank">从此处开始</a>。如果您正在寻找新的职业方向，请查看<a href="https://cloudflare.com/careers" target="_blank">我们的空缺职位</a>。</em></p>
</div>