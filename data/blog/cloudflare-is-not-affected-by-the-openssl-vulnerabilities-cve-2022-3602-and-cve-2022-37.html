<div class="mb2 gray5">2 min read</div>
<div class="mt4">This post is also available in <a href="https://blog.cloudflare.com/zh-cn/cloudflare-is-not-affected-by-the-openssl-vulnerabilities-cve-2022-3602-and-cve-2022-37">简体中文</a> and <a href="https://blog.cloudflare.com/zh-tw/cloudflare-is-not-affected-by-the-openssl-vulnerabilities-cve-2022-3602-and-cve-2022-37">繁體中文</a>.</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6OB3Jyi60aZlg1iUboxAc6/35887ef19d3c519e1255c0a96ca3db30/cloudflare-is-not-affected-by-the-openssl-vulnerabilities-cve-2022-3602-and-cve-2022-37.png" alt="">
<div class="post-content lh-copy gray1">
	<p></p>
	<p>Yesterday, November 1, 2022, OpenSSL released version 3.0.7 to patch <a href="https://www.openssl.org/news/secadv/20221101.txt">CVE-2022-3602 and CVE-2022-3786</a>, two HIGH risk vulnerabilities in the OpenSSL 3.0.x cryptographic library. Cloudflare is not affected by these vulnerabilities because <a href="https://blog.cloudflare.com/make-ssl-boring-again">we use BoringSSL</a> in our products.</p>
	<p>These vulnerabilities are memory corruption issues, in which attackers may be able to execute arbitrary code on a victim’s machine. CVE-2022-3602 was initially announced as a CRITICAL severity vulnerability, but it was downgraded to HIGH because it was deemed difficult to exploit with <a href="https://www.cloudflare.com/learning/security/what-is-remote-code-execution">remote code execution (RCE)</a>. Unlike previous situations where users of OpenSSL were almost universally vulnerable, software that is using other versions of OpenSSL (like 1.1.1) are not vulnerable to this attack.</p>
	<div class="flex anchor relative">
		<h3 id="how-do-these-issues-affect-clients-and-servers">How do these issues affect clients and servers?</h3>
		<a href="https://blog.cloudflare.com/#how-do-these-issues-affect-clients-and-servers" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>These vulnerabilities reside in the code responsible for X.509 certificate verification - most often executed on the client side to <a href="https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake">authenticate the server and the certificate presented</a>. In order to be impacted by this vulnerability the victim (client or server) needs a few conditions to be true:</p>
	<ul>
		<li>
			<p>A malicious certificate needs to be signed by a Certificate Authority that the victim trusts.</p>
		</li>
		<li>
			<p>The victim needs to validate the malicious certificate or ignore a series of warnings from the browser.</p>
		</li>
		<li>
			<p>The victim needs to be running OpenSSL 3.0.x before 3.0.7.</p>
		</li>
	</ul>
	<p>For a client to be affected by this vulnerability, they would have to visit a malicious site that presents a certificate containing an exploit payload. In addition, this malicious certificate would have to be signed by a trusted certificate authority (CA).</p>
	<p>Servers with a vulnerable version of OpenSSL can be attacked if they support mutual authentication - a scenario where both client and a server provide a valid and signed X.509 certificate, and the client is able to present a certificate with an exploit payload to the server.</p>
	<div class="flex anchor relative">
		<h3 id="how-should-you-handle-this-issue">How should you handle this issue?</h3>
		<a href="https://blog.cloudflare.com/#how-should-you-handle-this-issue" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>If you’re managing services that run OpenSSL: you should patch vulnerable OpenSSL packages. On a Linux system you can determine if you have any processes dynamically loading OpenSSL with the <code>lsof</code> command. Here’s an example of finding OpenSSL being used by NGINX.</p>
	<pre class="language-bash"><code class="language-bash">root@55f64f421576:/# lsof | grep libssl.so.3
nginx   1294     root  mem       REG              254,1           925009 /usr/lib/x86_64-linux-gnu/libssl.so.3 (path dev=0,142)</code></pre>
	<p>Once the package maintainers for your Linux distro release OpenSSL 3.0.7 you can patch by updating your package sources and upgrading the libssl3 package. On Debian and Ubuntu this can be done with the apt-get upgrade command</p>
	<pre class="language-bash"><code class="language-bash">root@55f64f421576:/# apt-get --only-upgrade install libssl3</code></pre>
	<p>With that said, it’s possible that you could be running a vulnerable version of OpenSSL that the <code>lsof</code> command can’t find because your process is statically compiled. It’s important to update your statically compiled software that you are responsible for maintaining, and make sure that over the coming days you are updating your operating system and other installed software that might contain the vulnerable OpenSSL versions.</p>
	<div class="flex anchor relative">
		<h3 id="key-takeaways">Key takeaways</h3>
		<a href="https://blog.cloudflare.com/#key-takeaways" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Cloudflare’s use of BoringSSL helped us be confident that the issue would not impact us prior to the release date of the vulnerabilities.</p>
	<p>More generally, the vulnerability is a reminder that memory safety is still an important issue. This issue may be difficult to exploit because it requires a maliciously crafted certificate that is signed by a trusted CA, and certificate issuers are likely to begin validating that the certificates they sign don’t contain payloads that exploit these vulnerabilities. &nbsp;However, it’s still important to patch your software and upgrade your vulnerable OpenSSL packages to OpenSSL 3.0.7 given the severity of the issue.</p>
	<p><i>To learn more about our mission to help build a better Internet,</i> <a href="https://www.cloudflare.com/learning/what-is-cloudflare"><i>start here</i></a><i>. If you're looking for a new career direction, check out</i> <a href="https://cloudflare.com/careers"><i>our open positions</i></a><i>.</i></p>
</div>