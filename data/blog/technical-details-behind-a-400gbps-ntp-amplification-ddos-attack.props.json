{
	"initialReadingTime": "4",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Matthew Prince",
				"slug": "matthew-prince",
				"bio": "A little bit geek, wonk, and nerd. Repeat entrepreneur, recovering lawyer, and former ski instructor. Co-founder & CEO of Cloudflare (NYSE: NET).",
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1VD9WePJ1jvjFwuSRF0IfQ/4867307860761eb8209f67f2a9dd771f/matthew-prince.jpeg",
				"location": "San Francisco, CA",
				"website": null,
				"twitter": "@eastdakota",
				"facebook": null
			}
		],
		"excerpt": "On Monday we mitigated a large DDoS that targeted one of our customers. The attack peaked just shy of 400Gbps. We've seen a handful of other attacks at this scale, but this is the largest attack we've seen that uses NTP amplification.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1P0zbdEcuSVRARh4Mx5Rkd/6c53713453fc0c9291746d304e89703d/technical-details-behind-a-400gbps-ntp-amplification-ddos-attack.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/19SQaf01KoZvz3J3XtblQm/43489ef915ce8e9ac16cfc77f56db33f/Screen_Shot_2014-02-13_at_9.34.43_AM.png\" alt=\"\" class=\"kg-image\" width=\"329\" height=\"330\" loading=\"lazy\"/>\n            \n            </figure><p>On Monday we mitigated a large DDoS that targeted one of our customers. The attack peaked just shy of 400Gbps. We&#39;ve seen a handful of other attacks at this scale, but this is the largest attack we&#39;ve seen that uses NTP amplification. This style of attacks has grown dramatically over the last six months and poses a significant new threat to the web. Monday&#39;s attack serves as a good case study to examine how these attacks work.</p><h3>NTP Amplification 101</h3><p>Before diving into the particular details of this attack, it&#39;s important to understand the basic mechanics of how NTP amplification attacks work. This is a quick overview of how these attacks occur. John Graham-Cumming on our team previously wrote a <a href=\"/understanding-and-mitigating-ntp-based-ddos-attacks\">detailed primer on NTP amplification attacks</a> if you&#39;re interested in further technical details. If you&#39;re interested in amplification attacks, you may also find interesting <a href=\"/deep-inside-a-dns-amplification-ddos-attack\">our posts about DNS Amplification attacks</a>. These attacks use a similar method but target open DNS resolvers rather than NTP servers.</p><p>An NTP amplification attack begins with a server controlled by an attacker on a network that allows source IP address spoofing (e.g., it does not follow <a href=\"http://tools.ietf.org/html/bcp38\">BCP38</a>). The attacker generates a large number of UDP packets spoofing the source IP address to make it appear the packets are coming from the intended target. These UDP packets are sent to Network Time Protocol servers (port 123) that support the MONLIST command.</p><p>I&#39;d personally be curious to talk with whoever added MONLIST as a command to NTP servers. The command seems of such little practical use -- it returns a list of up to the last 600 IP addresses that last accessed the NTP server -- and yet it can do so much harm. If an NTP server has its list fully populated, the response to a MONLIST request will be 206-times larger than the request. In the attack, since the source IP address is spoofed and UDP does not require a handshake, the amplified response is sent to the intended target. An attacker with a 1Gbps connection can theoretically generate more than 200Gbps of DDoS traffic.</p><h3>Not Just Theoretical</h3><p>Monday&#39;s DDoS proved these attacks aren&#39;t just theoretical. To generate approximately 400Gbps of traffic, the attacker used 4,529 NTP servers running on 1,298 different networks. On average, each of these servers sent 87Mbps of traffic to the intended victim on CloudFlare&#39;s network. Remarkably, it is possible that the attacker used only a single server running on a network that allowed source IP address spoofing to initiate the requests.</p><p>While NTP servers that support MONLIST are less common than open DNS resolvers, they tend to run on beefier servers with fatter connections to the network. Combined with the high amplification factor, this allows a much smaller number of NTP servers to generate very large attacks. For comparison, the attack that targeted Spamhaus used 30,956 open DNS resolvers to <a href=\"/the-ddos-that-almost-broke-the-internet\">generate a 300Gbps DDoS</a>. On Monday, with 1/7th the number of vulnerable servers, the attacker was able to generate an attack that was 33% larger than the Spamhaus attack.</p><h3>Globally Distributed Threat</h3><p></p><p><a href=\"http://www.tableausoftware.com/public/about-tableau-products?ref=http://public.tableausoftware.com/views/IPMap/Sheet1\">Learn About Tableau</a></p><p>We saw attack traffic hitting every one of CloudFlare&#39;s data centers. While we were generally able to mitigate the attack, it was large enough that it caused network congestion in parts of Europe. The map above shows the global distribution of the 4,529 NTP servers used in the attack. The chart below lists the AS Numbers and names of the top 24 networks we saw traffic from in the attack, as well as the number of exploited NTP servers running on each.</p><p>ASN Network                                                          Count\n9808 CMNET-GD Guangdong Mobile Communication Co.Ltd.                    136\n4134 CHINANET-BACKBONE No.31,Jin-rong Street                            116\n16276 OVH OVH Systems                                                    114\n4837 CHINA169-BACKBONE CNCGROUP China169 Backbone                        81\n3320 DTAG Deutsche Telekom AG                                            69\n39116 TELEHOUSE Telehouse Inter. Corp. of Europe Ltd                      61\n10796 SCRR-10796 - Time Warner Cable Internet LLC                         53\n6830 LGI-UPC Liberty Global Operations B.V.                              48\n6663 TTI-NET Euroweb Romania SA                                          46\n9198 KAZTELECOM-AS JSC Kazakhtelecom                                     45\n2497 IIJ Internet Initiative Japan Inc.                                  39\n3269 ASN-IBSNAZ Telecom Italia S.p.a.                                    39\n9371 SAKURA-C SAKURA Internet Inc.                                       39\n12322 PROXAD Free SAS                                                     37\n20057 AT&amp;T Wireless Service                                               37\n30811 EPiServer AB                                                        36\n137 ASGARR GARR Italian academic and research network                   34\n209 ASN-QWEST-US NOVARTIS-DMZ-US                                        33\n6315 XMISSION - XMission, L.C.                                           33\n52967 NT Brasil Tecnologia Ltda. ME                                       32\n4713 OCN NTT Communications Corporation                                  31\n56041 CMNET-ZHEJIANG-AP China Mobile communications corporation           31\n1659 ERX-TANET-ASN1 Tiawan Academic Network (TANet) Information Center   30\n4538 ERX-CERNET-BKB China Education and Research Network Center          30</p><p>At this time, we&#39;ve decided not to publish the full list of the IP addresses of the NTP servers involved in the attack out of concern that it could give even more attackers access to a powerful weapon. However, we have published a <a href=\"https://docs.google.com/spreadsheet/ccc?key=0AhuvvqAkGlindHFtS0pJa0lYZGNlLXNONWtlY01qanc&usp=sharing\">spreadsheet with the complete list of the networks with NTP servers that participated in the attack</a>. While the per server amplification makes these attacks troubling, the smaller number of servers and networks involved gives us some hope that we can make a dent in getting them cleaned up. We are reaching out to network operators whose resources were used in the attack to encourage them to restrict access to their NTP servers and disable the MONLIST command.</p><p>Somewhat ironically, the large French hosting provider OVH was one of the largest sources of our attack and also a victim of a large scale NTP amplification attack around the same time. The company&#39;s founder Tweeted:</p><blockquote><p>We see today lot of new DDoS attacks from Internet to our network. Type: NTP AMP Size: &gt;350Gbps. No issue. VAC is great :) — Oles (@olesovhcom) <a href=\"https://twitter.com/olesovhcom/statuses/433631778620702721\">February 12, 2014</a></p></blockquote><h3>Time to Clean Up the Problem</h3><p>If you&#39;re a network administrator and on Monday you saw network graphs like the one in the Tweet below then you are running a vulnerable NTP server.</p><blockquote><p>and here&#39;s what it looks like when a device participates in the NTP DDOS against <a href=\"https://twitter.com/CloudFlare\">@CloudFlare</a> <a href=\"http://t.co/QcrPGxbcUz\">pic.twitter.com/QcrPGxbcUz</a></p><p>— Eric C (@ctrl_alt_esc) <a href=\"https://twitter.com/ctrl_alt_esc/statuses/433629994351214592\">February 12, 2014</a></p></blockquote><p>You can check whether there are open NTP servers that support the MONLIST command running on your network by visiting the <a href=\"http://openntpproject.org/\">Open NTP Project</a>. Even if you don&#39;t think you&#39;re running an NTP server, you should check your network because you may be running one inadvertently. For example, some firmware on Supermicro&#39;s IPMI controllers <a href=\"http://blog.gmane.org/gmane.network.ntp.pool/month=20140201\">shipped with a MONLIST-enabled NTP server on by default</a>. More details on NTP attacks and instructions on how to disable the MONLIST command can be found on the <a href=\"https://isc.sans.edu/diary/NTP+reflection+attack/17300\">Internet Storm Center&#39;s NTP attack advisory</a>.</p><p>NTP and all other UDP-based amplification attacks rely on source IP address spoofing. If attackers weren&#39;t able to spoof the source IP address then they would only be able to DDoS themselves. If you&#39;re running a network then you should ensure that you are following BCP38 and preventing packets with spoofed source addresses from leaving your network. You can test whether your network currently follows BCP38 using tools from MIT&#39;s <a href=\"http://spoofer.cmand.org/summary.php\">the Spoofer Project</a>. If you&#39;re running a naughty network that allows source IP address spoofing, you can easily implement BCP38 by following the <a href=\"http://www.bcp38.info/index.php/Main_Page\">instructions listed at BCP38.info</a>.</p><p>Finally, if you think NTP is bad, just wait for what&#39;s next. SNMP has a theoretical 650x amplification factor. We&#39;ve already begun to see evidence attackers have begun to experiment with using it as a DDoS vector. Buckle up.</p>",
		"id": "2NhGou3aWU1B09ebcKWB5s",
		"localeList": {
			"name": "Technical Details Behind a 400Gbps NTP Amplification DDoS Attack Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2014-02-13T01:00:00.000+00:00",
		"slug": "technical-details-behind-a-400gbps-ntp-amplification-ddos-attack",
		"tags": [
			{
				"id": "5kIxDMJCg3PXQxVINDL0Cw",
				"name": "Attacks",
				"slug": "attacks"
			},
			{
				"id": "ddJrV1bYzbMmaXkRKrp3G",
				"name": "Tech Talks",
				"slug": "tech-talks"
			},
			{
				"id": "6QVJOBzgKXUO9xAPEpqxvK",
				"name": "Reliability",
				"slug": "reliability"
			},
			{
				"id": "64g1G2mvZyb6PjJsisO09T",
				"name": "DDoS",
				"slug": "ddos"
			},
			{
				"id": "2UVIYusJwlvsmPYl2AvSuR",
				"name": "Deep Dive",
				"slug": "deep-dive"
			}
		],
		"title": "Technical Details Behind a 400Gbps NTP Amplification DDoS Attack",
		"updated_at": "2024-08-27T02:43:50.583Z",
		"url": "https://blog.cloudflare.com/technical-details-behind-a-400gbps-ntp-amplification-ddos-attack"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}