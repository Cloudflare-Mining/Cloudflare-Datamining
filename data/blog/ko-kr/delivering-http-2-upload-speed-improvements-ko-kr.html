<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/Speed-header@2x-3.png" class="kg-image"></figure>
	<p>Cloudflare는 HTTP/2 클라이언트들이 우리 네트워크에 <em>업로드</em>하는 속도를 향상하였습니다. 이 글에서는 문제를 찾아내는 방법에서 시작하여 이를 수정하고 글로벌 인터넷의 업로드 속도 향상이 되기까지의 과정에 대해 설명하겠습니다.</p>
	<p>우리는 사용자 네트워크의 성능 측정을 위해 2020년 5월에 <a href="https://blog.cloudflare.com/test-your-home-network-performance/">speed.cloudflare.com을 런칭</a>하였습니다. 이 사이트는 다운로드, 업로드와 지연 시간 테스트를 제공 합니다. 릴리즈 직후 몇몇 사용자에게서 업로드 속도가 낮게 표시된다는 리포트를 받았습니다. 조사 결과 고속의 업로드 대역폭을 가진 고객 (수백Mbps 업로드 속도가 가능한 케이블이나 파이버 서비스)에게서 발생하는 것으로 보였습니다. 우리의 속도 측정은 브라우저 자바스크립트로 동작하며 대부분의 브라우저는 HTTP/2 를 기본 사용하고 있습니다. 이후 사용자가 매우 빠른 업로드 대역폭을 갖고 있는 경우 HTTP/2 업로드 속도가 HTTP/1.1 (모두 TLS라 가정 합니다)보다 매우 느린 경우가 있는 것을 알게 되었습니다.</p>
	<p>업로드 속도는 가정용 브로드밴드 연결을 사용하고 있는 사람들에게 예전보다 더 중요해 졌습니다. 많은 사람들이 예전과는 다르게 집에서 가정용 회선으로 재택 근무를 할 수 밖에 없는 상황이 되었기 때문입니다. 코로나 대유행 이전의 브로드밴드 트래픽은 매우 비대칭적이었습니다만 (다운로드 속도가 업로드보다 매우 빠릅니다... 음악을 듣거나 영화를 스트리밍으로 보는 경우를 생각해 보세요) 이제 사용자들이 가정에서 비디오 컨퍼런스에 참여하거나 컨텐츠를 만들어 올리는 일을 많이 보게 되었습니다.</p>
	<h3 id="-">초기 테스트</h3>
	<p>고객의 리포트는 주로 빠른 가정용 네트워크에 집중되었으므로, 제어된 환경에서 업로드 속도를 테스트할 수 있도록 <code>dummynet</code> 네트워크 시뮬레이터를 설정 하였습니다. 맥북 프로 안에 회사 코드를 실행할 수 있도록 리눅스 VM을 만들고 <a href="https://www.saturnsoft.net/tech/2020/06/07/macosx-dummynet/" target="_blank">맥북 호스트와 VM간에 <code>dummynet</code>을 구성</a> 하였습니다. 업로드 속도를 측정하는 것은 간단합니다 - 파일을 만들어서 요청 본문을 받아들일 수 있는 종착점으로 curl을 사용해서 업로드하면 됩니다. 동일한 테스트를 20회 수행하여 중간값을 측정 하였습니다(Mbps). </p>
	<pre><code class="language-shell">% dd if=/dev/urandom of=test.dat bs=1M count=10
% curl --http1.1 -w '%{speed_upload}\n' -sf -o/dev/null --data-binary @test.dat https://edge/upload-endpoint
% curl --http2 -w '%{speed_upload}\n' -sf -o/dev/null --data-binary @test.dat https://edge/upload-endpoint</code></pre>
	<p>200Mbps 대역폭과 40ms 왕복 시간(RTT)의 네트워크에서 10MB 크기 파일을 업로드하는 것을 측정해 보자 결과는 놀라웠습니다. 실 서비스와 동일한 설정을 사용할 때 HTTP/2 업로드 테스트 속도는 동일 환경의 HTTP/1.1보다 거의 절반 정도의 속도였습니다. (아래 차트는 높은 수치가 좋은 것입니다)</p>
	<figure class="kg-card kg-image-card"><img src="data:image/png;base64,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CIuLi9PT0+2tpqYmCXJsbIyvEwAAElOEZ8+cXbBgQSgUciLMz8/Pysqyd1UUSoR9fX18nQAAkIAijEQiixcv3rt3r4adCPPy8nJycmwECVIi7Ojo4OsEAIAEFKGKv4ULF+6aQsJbvXp1W1tbYWFhZmamjdDV1aX2oaEh34Q9PT3NAACQZASDwUQTocz32D0kvEWLFlVXVwcCgbS0NBuhvr5elSI7NQAAkJgVoRd3aDQcDkuKRUVFMv/SpUtzc3P5LgEAIIlEKMrKylKmyMjIGBgY4LsEAIDEF6GP0dHRUCjEtwgAAEkqQhDtfRP/uyPy5Lu3ibkZuTuG9R3RUQEQITwosOB8cGGEjgqACOFBgWbmRdBRARAhIEJECACIEBAhIgQARAiIEBECACIERIgIAQARAiJEhACACAERIkIAQISACBEhACBCQISIEAAQISBCRAgAiBAQISIEAEQIiBARAgAiBESICAEAEQIiRIQAgAgBESJCAECEgAgRIQAgQkCEiBAAECEgQkQIAIgQECEiBABEiAjRDCIEAESICAlECACIEBESiBAAECEiJBAhACBCREggQgBAhIiQQIQAgAgRIYEIAQARIkICEQIAIkSEBCIEAESICAlECACIEBESiBAAECEiJBAhACBCREggQgBECIiQQIQAiBAQIYEIARAhIEICEQIgQkCEBCIEQISACAlECIAIARESiBAAEQIiJBAhACIEREggQgBECIiQQIQAiBAQIYEIARAhIEICEQIgQkCEBCIEQISACAlECIAIARESiBAAEQIiJBAhACIEREggQgBECIiQQIQAiBAQIYEIARAhIEICEQIgwvvI5OTkLBsRIYEIASChRHjq1KmnnnoqJSVlyZIlP/30kzXW1tbqpRqzsrL6+/sRIYEIASAxRRiJRNLS0jZu3KiB1atXL1q0SI3d3d2pqamBQCAYDGZnZy9fvhwREogQABJThKOjo42NjWNjYxouKipasGDB5ORkcXFxenq6jdDU1KS60EZAhAQiBIAEPDQqQqHQCy+8IOFt375dL/Pz87OysuwtFYVq7+vrQ4QEIgSAhBXh1atXV65cqXLw6aefHhkZycvLy8nJcY6UCDs6OhAhgQgBIGFF6C3+jhw5UlhYmJmZaY1dXV1qHBoaih65OQnAMfMimgHgYaHkn2givHz58ooVKyKRiIbHxsZSU1MrKioCgUBaWpqNUF9fr8ak3ZfBMVSEAJDgFaHkt3Dhwvfee294eHjTpk1ynoq/cDisKrCoqEjmX7p0aW5uLiIkECEAJOyh0YMHDz722GN2H2F1dbU1lpWVpUyRkZExMDCACAlECAAJK0Ij2najo6OhUCjJv0IcgwgBIFlECIgQEQIAIgREiAgBABECIkSEAIAIAREiQgBAhIAIESEAIEJESCBCAECEiJBAhACACBEhgQgBABEiQgIRAgAiRIQEIgQARIgICUQIAIgQERKIEAAQISIkECEAIEJESCBCAECEiJBAhACACBEhgQgBABEiQgIRAgAiRIQEIgRAhIAICUQIgAgBERKIEAARAiIkECEAIgRESCBCAEQIiJBAhACIEBAhgQgBECEgQgIRAiBCQIQEIgRAhIAICUQIgAgBERKIEAARAiIkECEAIgRESCBCAEQIiJBAhACIEBAhgQgBECEgQgIRAiBCQIQEIgRAhIAICUQIgAgBERKIEAARAiIkECEAIgRESCBCAEQIiBARAgAiBESICAEAEQIiRIQAgAgBESJCAECEgAgRIQAgQkCEiBAAECEgQkQIAIgQECEiBABECIgQEQIAIgREiAgBABECIkSEAIAIAREiQgBAhIAIESEAzFkRTk5O3gjd0EBjY+PXX38diUT4TBEhgQgBkkWEw8PDjz/++FtvvVVXV5eSkpKampqVlcVniggJRAiQLCKsqalZvHjxwMDA888//9xzz92+fVs6vHbtGh8rIiQQIUBSiLCkpET+GxsbUy1YXV09MTGxYMGCq1evPqB1nZycnGUjIiQQIQA8DBGePXNWCpQLVQiGQqFXX3110aJFD2ItT548mZ2draUsW7bswIED1lhbW7tkyRI1ZmVl9ff3I0ICEQLAwxah2L1794oVKxoaGsbHx5999tnW1tb7voqqOOXXgoKCoaGhqqoqmW9gYKC7u1sODgQCwWBQjly+fDkiJBDhI6e9byJ3R0Tb+z/E3At9L7k7hvUdYb77LEJx/fr177//vqWl5c6dOw9iFVXtbdy40WZupyFVCxYXF6enp9sITU1NapQvESGBCB8t/ztlQWIuh/ZUMN/9FOHk5OSaNWtS7qES7ciRIw90dbdu3aqlhEKh/Px8d4WqikItva+vDxESiJDeSMSP/+FA/f0V4Y8//igD1dXVqVxT3fbhhx/K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" class="kg-image"></figure>
	<p><br>여러분의 네트워크에 따라 결과는 다를 수 있지만 네트워크가 더 빠르면 차이가 더 컸습니다. 반대로 느린 네트워크의 경우, 가령 느린 가정용 케이블 연결의 경우 (5Mbps 업로드와 20ms RTT) HTTP/2 업로드 속도는 HTTP/1.1에서 측정된 것과 거의 동일 하였습니다.</p>
	<h3 id="--1">수신 흐름 제어</h3>
	<p>이 주제에 대해서 더 알아보기 전에, 제 느낌은 이것은 수신 흐름 제어와 관련된 것이 아닌가 하는 것이었습니다. 일반적으로는 클라이언트 (브라우저 또는 HTTP 클라이언트)는 데이터의 수신자이지만, 이 경우에는 클라이언트가 서버에 컨텐츠를 업로드하는 것이라 서버가 데이터의 수신자가 됩니다. 그리고 수신자는 수신 버퍼의 흐름을 제어할 필요가 있습니다.</p>
	<p>HTTP/1.1 과 HTTP/2 의 수신 흐름 제어 방식은 어떻게 다를까요? 가령 HTTP/1.1은 수신 흐름 제어를 정의하지 않았는데, 연결 내에 여러 요청이 동시에 전송되지 않기 때문에 수신 흐름 제어는 TCP 계층에 맡겨져 있습니다. 최근의 OS TCP 스택은 수신 버퍼의 자동 조정을 하고 있으며 (나중에 다시 살펴 봅니다) 이는 현재의 <a href="https://en.wikipedia.org/wiki/Bandwidth-delay_product" target="_blank">BDP (대역폭-지연시간 곱)</a>에 기반하고 있습니다. </p>
	<p>HTTP/2 의 경우 프로토콜이 스트림 멀티플렉싱을 지원하기 때문에 <a href="https://tools.ietf.org/html/rfc7540#section-5.2" target="_blank">스트림 수준 흐름 제어</a>가 존재 합니다. 각 HTTP/2 스트림은 자체적인 흐름 제어 윈도우를 갖고 있고 연결의 모든 스트림을 제어하는 연결 수준 흐름 제어도 있습니다. 만약 흐름 제어에 여유가 없다면 데이터 송신은 흐름 제어에 의해 일시 중지될 수 있습니다. 만약 너무 여유가 있다면 버퍼링에 메모리를 낭비하게 될 수도 있습니다. 따라서 최적의 흐름 제어를 유지하는 것은 흐름 제어를 구현할 때 중요하며 일반적인 최적 전략은 수신 버퍼 크기를 현재의 BDP에 맞추는 것입니다. BDP는 현재 네트워크에서 전송되고 있는 데이터의 최대 크기이며 최적의 버퍼 크기로 사용될 수 있습니다.</p>
	<h3 id="nginx-">NGINX가 요청 본문 버퍼를 다루는 법</h3>
	<p>처음에는 NGINX 업로드 버퍼링 관련 설정값을 찾아 보고 이 값을 변경하는 것이 좋은 결과를 나타내는지 보려 했습니다. 요청 본문 업로드에 관련된 설정값은 다음과 같습니다.</p>
	<ul>
		<li><a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_buffering" target="_blank"><code>proxy_buffering</code></a></li>
		<li><a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#client_body_buffer_size" target="_blank"><code>client_body_buffer_size</code></a></li>
	</ul>
	<p>HTTP/2 관련으로는 다음이 있습니다.</p>
	<ul>
		<li><a href="https://nginx.org/en/docs/http/ngx_http_v2_module.html#http2_body_preread_size" target="_blank"><code>http2_body_preread_size</code></a></li>
	</ul>
	<p>Cloudflare는 <code>proxy_request_buffering</code> 을 사용하지 않으므로 이 상황은 고려하지 않도록 하겠습니다. <code>client_body_buffer_size</code> 는 프로토콜에 공통으로 사용되는 요청 본문 버퍼의 크기이며 HTTP/1.1 과 HTTP/2 에 모두 적용 됩니다.</p>
	<p>코드를 살펴보게 되면 다음과 같이 동작 합니다:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/download.png" class="kg-image"></figure>
	<!--kg-card-begin: markdown-->
	<ul>
		<li>HTTP/1.1: <code>client_body_buffer_size</code> 크기의 버퍼를 클라이언트와 업스트림 사이에서 사용하고 이 버퍼를 이용하여 읽기와 쓰기를 반복 합니다.</li>
		<li>HTTP/2: HTTP/2 DATA 프레임의 흐름 제어 업데이트를 해야 하기 때문에 다음의 두 설정값이 관련 됩니다.
			<ul>
				<li><code>http2_body_preread_size</code>: 업스트림으로 보내기 전에 미리 읽어둘 초기 요청 본문의 크기를 지정 합니다.</li>
				<li><code>client_body_buffer_size</code>: 요청 본문 버퍼의 크기를 지정 합니다.</li>
				<li>이 두 설정값은 업로드 중의 요청 본문 버퍼를 할당하는데 사용 됩니다. 다음은 버퍼링 없는 업로드가 어떻게 동작하는지에 대한 간단한 요약 설명 입니다:
					<ul>
						<li><code>http2_body_preread_size</code> 와 <code>client_body_buffer_size</code> 중 큰 값으로 하나의 요청 본문 버퍼를 할당 합니다. 만약 <code>http2_body_preread_size</code>가 64KB이고 <code>client_body_buffer_size</code>가 128KB라면 128KB 의 버퍼가 할당 됩니다. 우리는 <code>client_body_buffer_size</code>로 128KB를 사용하고 있습니다.</li>
						<li>HTTP/2 스트림의 <code>INITIAL_WINDOW_SIZE</code> 설정은 <code>http2_body_preread_size</code>로 지정되며 우리는 64KB (<a href="https://tools.ietf.org/html/rfc7540#section-6.9.2" target="_blank">RFC7540의 기본값</a>)을 사용하고 있습니다.</li>
						<li>HTTP/2 모듈은 업스트림으로 보내기 전에 <code>http2_body_preread_size</code> 만큼 읽어 들입니다.</li>
						<li>사전에 읽어들인 버퍼를 모두 업스트림으로 보내고 나면 요청 본문을 모두 읽어 들일 때 까지 클라이언트에서 계속 읽어 들인 내용을 업스트림으로 보내고 필요시 <code>WINDOW_UPDATE</code> 프레임을 클라이언트에게 보내는 일을 반복 합니다.</li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	<!--kg-card-end: markdown-->
	<p>요약하자면 다음과 같습니다. HTTP/1.1은 단일 버퍼를 사용 하고 TCP 소켓 버퍼가 흐름 제어를 합니다. 하지만 HTTP/2의 경우 어플리케이션 계층에서도 수신 흐름 제어를 하는데 NGINX는 수신 버퍼에 고정 크기를 사용 합니다. 이는 현재 네트워크의 BDP가 정해진 수신 버퍼 크기보다 큰 경우 업로드 속도를 제약하게 됩니다. 따라서 버퍼 크기가 너무 작은 경우에 HTTP/2 흐름 제어에서 병목이 생기게 됩니다.</p>
	<h3 id="--2">버퍼 크기를 늘리면 될까요?</h3>
	<p>이론적으로는 버퍼 크기를 늘리면 업로드 병목은 해결될 것이므로 이 값을 늘려 가며 테스트를 다시 해 보았습니다. 이전 결과 차트는 "(prod)"라고 표시하였습니다. <code>client_body_buffer_size</code> 를 256KB, 512KB, 1024KB로 늘려 가며 HTTP/2 업로드 테스트를 다시 해 보았습니다:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/download--1-.png" class="kg-image"></figure>
	<p><br><code>client_body_buffer_size</code>의 최적값은 512KB로 보입니다.</p>
	<p>만약 다른 네트워크에서는 어떨까요? 아래는 동일 네트워크에서 RTT가 10ms일 경우입니다. 이 경우 256KB가 최적으로 보입니다.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/download--2-.png" class="kg-image"></figure>
	<p>두가지 모두 현재의 128KB보다는 더 낫고 HTTP/1.1 과 동등하거나 때로는 더 나은 성능을 보여주고 있습니다. 하지만 최적의 버퍼 크기는 경우에 따라 다르며, 단순히 큰 버퍼 크기를 선택하게 되면 오히려 성능에 악영향을 미치게 됩니다. 따라서 최적의 버퍼 크기를 찾기 위한 똑똑한 방법이 필요합니다.</p>
	<h3 id="--3">요청 본문 버퍼 크기 자동 조정</h3>
	<p>이런 경우에 도움이 되는 아이디어 중 하나는 자동 조정입니다. 가령 최근의 TCP 스택은 수신 버퍼 크기를 자동 조정합니다. 우리의 엣지 서버에서도 <a href="https://sysctl-explorer.net/net/ipv4/tcp_moderate_rcvbuf/" target="_blank">TCP 수신 버퍼 자동 조정</a>은 기본으로 설정되어 있습니다.</p>
	<pre><code>net.ipv4.tcp_moderate_rcvbuf = 1</code></pre>
	<p>하지만 HTTP/2 의 경우, HTTP/2 계층에서 직접 수신 흐름 제어를 하고 있고 기존의 128KB 는 큰 BDP 에서는 너무 작은 값이므로 TCP 버퍼 자동 조정은 그리 효과적이지 않습니다. 이런 이유로 TCP가 하는 것 처럼 HTTP/2 수신 버퍼 자동 조정을 시도해 보기로 하였습니다.</p>
	<p>기본적인 아이디어는 BDP를 측정하여 그 값에 맞게 HTTP/2 요청 본문 버퍼 크기를 두배씩 늘리는 것입니다. 다음은 현재 우리의 NGINX에 구현된 알고리즘입니다:</p>
	<ul>
		<li>위에서 설명한 대로 요청 본문 버퍼를 할당.</li>
		<li>매 RTT (linux <code>tcp_info</code> 사용) 마다 현재 BDP를 갱신.</li>
		<li>현재 BDP &gt; ( 수신 윈도우 / 4 ) 인 경우 요청 본문 버퍼 크기를 두배로 늘림.</li>
	</ul>
	<h2 id="--4"><strong>테스트 결과</strong></h2>
	<h3 id="--5"><strong>실험실 테스트</strong></h3>
	<p>아래는 HTTP/2 업로드 버퍼 자동 조정을 사용하였을 때의( <code>client_body_buffer_size</code>는 계속 128KB를 사용) 테스트 결과입니다. "h2 autotune"으로 표시 하였는데, 잘 동작 하는 것을 볼 수 있습니다 - (원래의 목표였던) HTTP/1.1 속도와 동등하거나 조금 더 빠른 것을 알 수 있습니다. 특정 네트워크에 맞게 수동으로 고른 버퍼 크기 보다는 약간 느릴 수 있지만, 서로 다른 네트워크 조건에 맞게 자동적으로 최적의 버퍼 크기를 찾는 것을 볼 수 있습니다.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/download--3-.png" class="kg-image"></figure>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/download--4-.png" class="kg-image"></figure>
	<h3 id="--6">실 환경 테스트</h3>
	<p>이 기능을 실 서비스에 적용한 후에 빠른 네트워크 노드를 사용해서 실 서비스 엣지 서버에 10MB 파일을 업로드하는 동일한 테스트를 진행 하였습니다. 빠른 네트워크 (Gbps급)과 낮은 지연 시간 (10ms 이하)에서 업로드 테스트를 하기 위해 구글 클라우드에 리눅스 VM 인스턴스를 만들었습니다.</p>
	<p>다음은 구글 클라우드 벨기에 지역에서 7ms 떨어져 있는 우리의 CDG (프랑스 파리) PoP로 업로드 테스트를 진행한 경우 입니다. 이 경우 3배 가까운 향상이 있음을 알 수 있습니다.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/download--5-.png" class="kg-image"></figure>
	<p><br>구글 클라우드 도쿄 지역에서 2.3ms 떨어진 우리의 NRT (도쿄) PoP으로 업로드하는 경우도 테스트해 보았습니다. 일반 가정용 네트워크라고 볼 수는 없겠지만 결과는 흥미롭습니다. 128KB 고정 버퍼 크기도 괜찮게 동작하지만 HTTP/2 업로드 버퍼 자동조정의 경우가 HTTP/1.1 보다 더 빨랐습니다.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2020/08/download--6-.png" class="kg-image"></figure>
	<h3 id="--7">요약</h3>
	<p>HTTP/2 업로드 버퍼 자동 조정 기능은 현재 Cloudflare 엣지 서버에 기본 적용되어 있습니다. <a href="https://speed.cloudflare.com" target="_blank">speed.cloudflare.com</a> 을 포함하여 고객은 HTTP/2 연결을 통한 업로드 속도의 향상을 기대할 수 있습니다. 업로드 버퍼 크기를 자동 조정하는 것은 대부분의 경우에 잘 동작 하며 이제 HTTP/2 업로드는 예전보다 더 빠릅니다! 성능이라고 하면 다운로드 속도나 지연 시간의 개선을 생각하기 쉽습니다만, 대량의 데이터 업로드가 필요한 재택 근무자에게 빠른 업로드도 도움을 줄 수 있습니다. 가령 사진/비디오 공유, 콘텐츠 제작, 비디오 회의나 라이브 방송과 같은 경우입니다.</p>
	<p>이 글 작성에 많은 도움을 준 <a href="https://blog.cloudflare.com/author/lucas/">Lucas Pardue</a>와 <a href="https://blog.cloudflare.com/author/rustam-lalkaka/">Rustam Lalkaka</a>에게 감사드립니다. </p>
	<p>추신: 패치를 공개하고 NGINX 개발자에게 보냈습니다. <a href="https://mailman.nginx.org/pipermail/nginx-devel/2020-August/013436.html" target="_blank">다음 링크</a>에서 찾아 볼 수 있습니다.</p>
</div>