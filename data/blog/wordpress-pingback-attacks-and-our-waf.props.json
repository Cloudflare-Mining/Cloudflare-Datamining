{
	"locale": "en-us",
	"post": {
		"id": "5d16453b41acde0011a9534e",
		"uuid": "160faea7-2c59-4728-8d50-47de46c0372e",
		"title": "WordPress Pingback Attacks and our WAF",
		"slug": "wordpress-pingback-attacks-and-our-waf",
		"html": "<!--kg-card-begin: markdown--><p>At CloudFlare a lot of our customers use WordPress, that's why we have our own <a href=\"http://WordPress.org/plugins/cloudflare\">plugin</a>, we hang out at <a href=\"https://twitter.com/CloudFlare/status/424232493282107392\">WordCamp</a> and we wrote a WordPress specific ruleset for our <a href=\"https://www.cloudflare.com/waf\">Web Application Firewall</a>.</p>\n<p>WordPress' ubiquity on the web can make it an ideal target for <a href=\"http://en.wikipedia.org/wiki/OSI_model#Layer_7:_application_layer\">Layer 7</a> attacks, and its powerful features as a blogging platform can be demanding on small web and database servers, meaning Layer 7 attacks can be effective in making a WordPress server go offline using a relatively low number of requests.</p>\n<p>Recently the folks at <a href=\"http://blog.sucuri.net/2014/03/more-than-162000-WordPress-sites-used-for-distributed-denial-of-service-attack.html\">Sucuri</a> observed a large DDoS using WordPress' pingback mechanism. A <a href=\"http://en.wikipedia.org/wiki/Pingback\">pingback</a> is a way of one website telling another that it has linked to their content. We’ve seen this attack in the past and already had WAF rules in place to block it.</p>\n<p>WordPress exposes an <a href=\"http://en.wikipedia.org/wiki/XML-RPC#PHP\">XMLRPC</a> endpoint - xmlrpc.php - which other sites can make POST requests to in a standard format to inform a blog that their content has been linked to. The message it sends contains the blog link they referred to, and the page on which they placed that link.</p>\n<p>When WordPress receives a pingback, it makes a request back to the source page to check that the link is actually there. Attackers can use this mechanism to specify a genuine link on a WordPress site and an intended victim, which will trigger a HTTP request to the victim's site. You can think of this as a kind of HTTP Reflection attack, in that the attacker can send a relatively small request to an XMLRPC endpoint that supports pingbacks, and trigger a much larger amount of effort and response on the victim's server.</p>\n<p>Fortunately, our WordPress WAF rule WP0001 &quot;WordPress Pingback Blocker&quot; will immediately stop your WordPress blog from being used for this type of pingback abuse. If you run WordPress, you may want to consider enabling this today.</p>\n<p><img alt=\"CloudFlare WAF rules for WordPress\" src=\"http://blog.cloudflare.com/content/images/cloudflare_waf_wordpress_ruleset_1.png\"><noscript><img alt=\"CloudFlare WAF rules for WordPress\" src=\"http://blog.cloudflare.com/content/images/cloudflare_waf_wordpress_ruleset_1.png\"></noscript></p>\n<p>You can find the “CloudFlare WordPress” ruleset under the CloudFlare Settings &gt; Security &gt; Manage WAF section, toggle the switch to turn the CloudFlare Wordpress ruleset on, and you’re all set.</p>\n<p>For an added sting in the tail, the attack Sucuri observed also used a mutating query string when specifying a URL on which they had placed a link. This bogus mutating URL will neutralise most caches and means a server has to expend the effort of producing a page from scratch over and over again. Fortunately we also have CloudFlare WordPress rule 100000 &quot;WordPress Numbers Botnet&quot; which will block this type of behaviour.</p>\n<p>So whether your blog is used to attack others or to be attacked itself, our WAF can help. For more information on our WAF <a href=\"https://www.cloudflare.com/waf\">cloudflare.com/waf</a></p>\n<!--kg-card-end: markdown-->",
		"comment_id": "4181",
		"feature_image": "http://blog.cloudflare.com/content/images/2018/08/cloudflare_waf_wordpress_ruleset_1.png",
		"featured": false,
		"visibility": "public",
		"created_at": "2014-08-20T11:03:46.000+01:00",
		"updated_at": "2020-08-17T19:17:35.000+01:00",
		"published_at": "2014-03-11T16:00:00.000+00:00",
		"custom_excerpt": "At CloudFlare a lot of our customers use WordPress, that's why we have our own plugin, we hang out at WordCamp and we wrote a WordPress specific ruleset for our Web Application Firewall.",
		"codeinjection_head": null,
		"codeinjection_foot": null,
		"custom_template": null,
		"canonical_url": null,
		"authors": [
			{
				"id": "5d1644b141acde0011a94f38",
				"name": "Simon Moore",
				"slug": "simon-moore",
				"profile_image": "http://blog.cloudflare.com/content/images/2022/08/simon-moore.png",
				"cover_image": "http://blog.cloudflare.com/content/images/2018/08/general@2x-119.png",
				"bio": null,
				"website": null,
				"location": null,
				"facebook": null,
				"twitter": null,
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/simon-moore/"
			}
		],
		"tags": [
			{
				"id": "5d16450341acde0011a95154",
				"name": "WordPress",
				"slug": "wordpress",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/wordpress/"
			},
			{
				"id": "5d16450341acde0011a951e6",
				"name": "WAF",
				"slug": "waf",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/waf/"
			},
			{
				"id": "5d16450341acde0011a95169",
				"name": "Attacks",
				"slug": "attacks",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/attacks/"
			}
		],
		"primary_author": {
			"id": "5d1644b141acde0011a94f38",
			"name": "Simon Moore",
			"slug": "simon-moore",
			"profile_image": "http://blog.cloudflare.com/content/images/2022/08/simon-moore.png",
			"cover_image": "http://blog.cloudflare.com/content/images/2018/08/general@2x-119.png",
			"bio": null,
			"website": null,
			"location": null,
			"facebook": null,
			"twitter": null,
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/simon-moore/"
		},
		"primary_tag": {
			"id": "5d16450341acde0011a95154",
			"name": "WordPress",
			"slug": "wordpress",
			"description": null,
			"feature_image": null,
			"visibility": "public",
			"meta_title": null,
			"meta_description": null,
			"og_image": null,
			"og_title": null,
			"og_description": null,
			"twitter_image": null,
			"twitter_title": null,
			"twitter_description": null,
			"codeinjection_head": null,
			"codeinjection_foot": null,
			"canonical_url": null,
			"accent_color": null,
			"url": "http://blog.cloudflare.com/tag/wordpress/"
		},
		"url": "http://blog.cloudflare.com/wordpress-pingback-attacks-and-our-waf/",
		"excerpt": "At CloudFlare a lot of our customers use WordPress, that's why we have our own plugin, we hang out at WordCamp and we wrote a WordPress specific ruleset for our Web Application Firewall.",
		"reading_time": 2,
		"access": true,
		"comments": false,
		"og_image": null,
		"og_title": null,
		"og_description": null,
		"twitter_image": null,
		"twitter_title": null,
		"twitter_description": null,
		"meta_title": null,
		"meta_description": null,
		"email_subject": null,
		"frontmatter": null,
		"feature_image_alt": null,
		"feature_image_caption": null
	}
}