{
	"locale": "en-us",
	"localesAvailable": [
		"zh-cn",
		"ja-jp"
	],
	"post": {
		"authors": [
			{
				"name": "Garrett Galow",
				"slug": "garrett",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/7mBhcWLbV0cg7OflZ199WK/5f2c149e3ebd9485de1e69c0d28b25ab/garrett.jpg",
				"location": null,
				"website": null,
				"twitter": null,
				"facebook": null
			}
		],
		"excerpt": "Cloudflare is making it easier for enterprise account owners to manage their team’s access to Cloudflare by allowing user access to be scoped to sets of domains",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4ryRiIWa6QXpbbuzf3w5rz/2f6aa54af7ab19d7bb197067542f1b80/domain-scoped-roles-early-access.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/1xDrevKC9L4P1ZpspVjJRp/2614da8dcd80552ad35864dd37170e8f/image3-30.png\" alt=\"\" class=\"kg-image\" width=\"1801\" height=\"1013\" loading=\"lazy\"/>\n            \n            </figure><p>Today, Cloudflare is making it easier for enterprise account owners to manage their team’s access to Cloudflare by allowing user access to be scoped to sets of domains. Ensuring users have exactly the access they need and no more is critical, and Domain Scoped Roles provide a significant step forward. Additionally, with the introduction of Domain Groups, account owners can grant users access to domains by group instead of individually. Domains can be added or removed from these groups to automatically update the access of those who have access to the group. This reduces toil in managing user access.</p><p>One of the most common uses we have seen for Domain Scoped Roles is to limit access to production domains to a small set of team members, while still allowing development and pre-production domains to be open to the rest of the team. That way, someone can’t make changes to a production domain unless they are given access.</p><h3>How to use Domain Scoped Roles</h3><p>If you are an enterprise customer please talk with your CSM to get you and your team enrolled. Note that you must have Super Administrator privileges to be able to modify account memberships.</p><p>Once the beta has been enabled for you, here is how to start using it:</p><ul><li><p>Log in to <a href=\"https://dash.cloudflare.com\">dash.cloudflare.com</a>, select your account, and navigate to the <a href=\"https://dash.cloudflare.com/?account=members\">members page</a>.</p><ul><li><p>From here, you can either invite a new member with a Domain Scoped Role or modify an existing user’s permissions. In this case, we will invite a new user.</p></li></ul></li></ul>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/7Itam7ImZp41fEhXudxach/2aa303fe55cbe830531e8d5025dd598e/image1-72.png\" alt=\"\" class=\"kg-image\" width=\"983\" height=\"911\" loading=\"lazy\"/>\n            \n            </figure><ul><li><p>When inviting new members there are three things to provide:</p><ul><li><p>Which users to invite.</p></li><li><p>The scope of which resource they will have access to:</p><ul><li><p>Selecting “All Domains” will allow you to select legacy roles.</p></li></ul></li><li><p>The role(s) which will decide what permissions are granted.</p></li></ul></li></ul>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/3757BL7vZiIxEgMqLjUNfm/fc7e07582684001aa657a44a98be5a09/1a.png\" alt=\"Membership invitation page with users, scope, and role selection.\" class=\"kg-image\" width=\"892\" height=\"862\" loading=\"lazy\"/>\n            \n            </figure><ul><li><p>Before sending the invite, you will be able to confirm the users, scope, and roles.</p></li></ul>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/1SJEopWHA0ryzEZ84AMkyJ/48142b20d5342bd90dc75c2d00f9aa92/1b.png\" alt=\"Membership invite confirmation screen.\" class=\"kg-image\" width=\"892\" height=\"462\" loading=\"lazy\"/>\n            \n            </figure><h3>Domain Groups</h3><p>In addition to manually creating inclusion or exclusion lists per user, account owners can also create Domain Groups to allow granting one or more users to a group of domains. Domain Groups can be created from the member invite flow or directly from Account Configurations -&gt; <a href=\"https://dash.cloudflare.com/?account=configurations/lists\">Lists</a>. When creating a domain group, the user selects the domains to include and, from that point on, the group can be used when inviting a user to the account.</p><h4>Domain Group Creation Screen</h4>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/ZnFUgFHbOn3lqT1oUldtZ/4a99be88144ced233e842816c395a6c3/image4-13.png\" alt=\"Domain Group creation screen showing two domains selected.\" class=\"kg-image\" width=\"980\" height=\"857\" loading=\"lazy\"/>\n            \n            </figure><h4>Domain Group selection during member invite</h4>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2Wkzbiwso2hdps1g9hj1ff/de0ae282553e65488e633273695e82b3/image6-4.png\" alt=\"Member invite screen showing the scope of a user’s access being limited to a domain group named, “Test Domains”.\" class=\"kg-image\" width=\"869\" height=\"182\" loading=\"lazy\"/>\n            \n            </figure><h3>Introducing Bach</h3><p>Domain Scoped Roles is possible because of a new permission system called Bach. Bach provides a policy based system for defining authorization to Cloudflare’s control plane. Authorization defines what someone can do in a system. Bach has been powering API Tokens, but going forward all authorization will use Bach. This gives customers the ability to define more granular permissions and resource scoping. Resources can be any object a user interacts with whether that be accounts, zones, worker environments, or DNS records to name a few.. Whereas before Cloudflare’s <a href=\"/domain-scoped-roles-early-access/edit\">RBAC system</a> relied on assigning a set of roles in which each role defined broad permissions that applied to an entire account, Bach’s policies allow for deeper permission grants that can be scoped to sets of resources.</p><p>Let’s take a look at the legacy system and how it compares to what Bach supports. Typically, user’s permissions are defined by the ‘roles’ that they are assigned to. These included: ‘Super Administrator’, ‘Administrator’, ‘Cloudflare for Teams’, and ‘Cloudflare Workers Admin’ to name a few. In the legacy system, each of these maps to an explicit set of simple permissions like ‘workers:read’, ‘workers:edit’ or ‘zones:edit’. When requests get made either via the Cloudflare API or the Cloudflare dashboard, Cloudflare’s API Gateway would check to see if, for the endpoint requested, an actor had the correct permissions to perform the action. In order to change a zone setting, the actor would need to have the ‘zone:edit’ permission – which could be granted from one of many roles. Below is what a user with only ‘DNS’ permissions is granted in the legacy system:</p><h4>Legacy DNS User Role Permissions</h4><p>Permission</p><p>Edit</p><p>Read</p><p>dns_records</p><p>✔</p><p>✔</p><p>legal</p><p>✔</p><p>account</p><p>✔</p><p>subscription</p><p>✔</p><p>zone</p><p>✔</p><p>zone_settings</p><p>✔</p><p>While straightforward, this had many drawbacks. First, this meant the inability to define limits on the resources the permissions applied to, whether that be a set of resources or attributes of resources. Second, permissions for a given ‘resource’ were simply read or edit, where edit included creating and deleting. These don’t fully capture the needs that may exist – for example, limiting deletions while allowing edits.</p><p>With Bach we have an expanded capability to define granular permissions for authorization. An example policy defining the aforementioned ‘DNS’ member’s access would look like this:</p><h3>Bach DNS User Role Policy</h3><p>(slightly modified for readability)</p>\n            <pre class=\"language-yaml\"><code class=\"language-yaml\">#Legacy DNS Role - applies to all zones\n  policies:\n  - id: 186f95f3bda1443c986aeb78b05eb60b\n    permission_groups:\n    - id: 49ce85367bae433b9f0717ed4fea5c74\n      name: DNS\n      meta:\n        description: Can edit DNS records.\n        editable: &#039;false&#039;\n        label: dns_admin\n        scopes: com.cloudflare.api.account\n      permissions:\n      - key: com.cloudflare.registrar.domain.read\n      - key: com.cloudflare.registrar.domain.list\n      - key: com.cloudflare.registrar.contact.read\n      - key: com.cloudflare.registrar.contact.list\n      - key: com.cloudflare.api.account.secondary-dns.update\n      - key: com.cloudflare.api.account.secondary-dns.read\n      - key: com.cloudflare.api.account.secondary-dns.delete\n      - key: com.cloudflare.api.account.secondary-dns.create\n      - key: com.cloudflare.api.account.zone.secondary-dns.update\n      - key: com.cloudflare.api.account.zone.secondary-dns.read\n      - key: com.cloudflare.api.account.zone.secondary-dns.delete\n      - key: com.cloudflare.api.account.zone.secondary-dns.create\n      - key: com.cloudflare.api.account.notification.*\n      - key: com.cloudflare.api.account.custom-ns.update\n      - key: com.cloudflare.api.account.custom-ns.list\n      - key: com.cloudflare.api.account.custom-ns.*\n      - key: com.cloudflare.edge.spectrum.app.list\n      - key: com.cloudflare.edge.spectrum.app.read\n      - key: com.cloudflare.api.account.zone.custom-page.read\n      - key: com.cloudflare.api.account.zone.custom-page.list\n      - key: com.cloudflare.api.account.zone.setting.read\n      - key: com.cloudflare.api.account.zone.setting.list\n      - key: com.cloudflare.api.account.zone.dnssec.update\n      - key: com.cloudflare.api.account.zone.dnssec.read\n      - key: com.cloudflare.api.account.dns-firewall.cluster.delete\n      - key: com.cloudflare.api.account.dns-firewall.cluster.update\n      - key: com.cloudflare.api.account.dns-firewall.cluster.read\n      - key: com.cloudflare.api.account.dns-firewall.cluster.create\n      - key: com.cloudflare.api.account.dns-firewall.cluster.list\n      - key: com.cloudflare.api.account.zone.dns-record.delete\n      - key: com.cloudflare.api.account.zone.dns-record.update\n      - key: com.cloudflare.api.account.zone.dns-record.read\n      - key: com.cloudflare.api.account.zone.dns-record.create\n      - key: com.cloudflare.api.account.zone.dns-record.list\n      - key: com.cloudflare.api.account.zone.page-rule.read\n      - key: com.cloudflare.api.account.zone.page-rule.list\n      - key: com.cloudflare.api.account.zone.railgun-connection.read\n      - key: com.cloudflare.api.account.zone.railgun-connection.list\n      - key: com.cloudflare.api.account.zone.subscription.read\n      - key: com.cloudflare.api.account.zone.aml.read\n      - key: com.cloudflare.api.account.zone.read\n      - key: com.cloudflare.api.account.zone.list\n      - key: com.cloudflare.api.account.audit-log.read\n      - key: com.cloudflare.api.account.custom-page.read\n      - key: com.cloudflare.api.account.custom-page.list\n      - key: com.cloudflare.api.account.railgun.read\n      - key: com.cloudflare.api.account.railgun.list\n      - key: com.cloudflare.api.account.dpa.read\n      - key: com.cloudflare.api.account.subscription.read\n      - key: com.cloudflare.api.account.subscription.list\n      - key: com.cloudflare.api.account.read\n      - key: com.cloudflare.api.account.list\n    resource_groups:\n    - id: 2fe938e0a5824128bdc8c42f9339b127\n      name: com.cloudflare.api.account.a67e14daa5f8dceeb91fe5449ba496eb\n      meta:\n        editable: &#039;false&#039;\n      scope:\n        key: com.cloudflare.api.account.a67e14daa5f8dceeb91fe5449ba496eb\n        objects:\n        - key: &quot;*&quot;\n    access: allow</pre></code>\n            <p>You can see a greater granularity in the permissions that are defined. In both cases, the user can perform the same actions, but the granularity means we are more explicit about what can be done. Here for DNS records (under com.cloudflare.api.account.zone.dns-record) there are explicit create, read, update, delete and list permissions. In the resource group section, we can see that the scope section defines an account. Any objects like domains in that account will match to the “*” value under ‘objects’. This means that these permissions apply throughout the entire account. Now, let’s modify this user’s permissions to be scoped to a single domain and see how the policy changes.</p><h3>Bach DNS User Role with Domain Scoping Policy</h3><p>(slightly modified for readability)</p>\n            <pre class=\"language-yaml\"><code class=\"language-yaml\"># Zone Scoped DNS role - scoped to 1 zone\npolicies:\n- id: 80b25dd735b040708155c85d0ed8a508\n  permission_groups:\n  - id: 132c52e7e6654b999c183cfcbafd37d7\n    name: Zone DNS\n    meta:\n      description: Grants access to edit DNS settings for zones in an account.\n      editable: &#039;false&#039;\n      label: zone_dns_admin\n      scopes: com.cloudflare.api.account.zone\n    permissions:\n    - key: com.cloudflare.api.account.zone.secondary-dns.*\n    - key: com.cloudflare.api.account.zone.dnssec.*\n    - key: com.cloudflare.api.account.zone.dns-record.*\n    - key: com.cloudflare.api.account.zone.analytics.dns-report.*\n    - key: com.cloudflare.api.account.zone.analytics.dns-bytime.*\n    - key: com.cloudflare.api.account.zone.setting.read\n    - key: com.cloudflare.api.account.zone.setting.list\n    - key: com.cloudflare.api.account.zone.rate-plan.read\n    - key: com.cloudflare.api.account.zone.subscription.read\n    - key: com.cloudflare.api.account.zone.read\n    - key: com.cloudflare.api.account.subscription.read\n    - key: com.cloudflare.api.account.subscription.list\n    - key: com.cloudflare.api.account.read\n  resource_groups:\n  - scope:\n      key: com.cloudflare.api.account.a67e14daa5f8dceeb91fe5449ba496eb\n      objects:\n      - key: com.cloudflare.api.account.zone.b1fbb152bbde3bd28919a7f4bdca841f\n  access: allow</pre></code>\n            <p>Once we scope the user’s permissions to only include one explicit zone, we see two main differences. First, there is a large reduction in permissions. This is because we do not grant the user access to read or list many account level resources that the legacy account scoped roles grant. The only account level permissions granted are <i>account.read</i>, <i>subscriptions.read</i>, and <i>subscriptions.list</i>. These permissions are necessary for a user to be able to use the dashboard.  When viewing the account in the dashboard the only account level product that will be shown is domains. Other products like Cloudflare Workers, Zero Trust, etc will be hidden.</p><p>Second, in the resource groups scope section, we see an explicit mention of a zone (line X: <code>com.cloudflare.api.account.zone.b1fbb152bbde3bd28919a7f4bdca841f</code>). This means that the zone permissions outlined in the policy only apply to that specific zone. Any attempt to access other features of that zone or to modify DNS for any other zones will be rejected by Cloudflare.</p><h2>What’s next</h2><p>If you are an enterprise customer and interested in getting started with Domain Scoped Roles, please contact your CSM to get enabled for the Early Access period. This announcement represents a significant milestone in our migration to Bach, an authorization system built for Coudflare’s scale. This will allow us to expand these same capabilities to more products in the future and to create an authorization system that puts customers more in control of their team’s access across all of Cloudflare’s services. Stay tuned as we are just getting started!</p>",
		"id": "nnIShKnEqkpAlu4MDhYcr",
		"localeList": {
			"name": "Domain Scoped Roles - Early Access Config",
			"enUS": "English for Locale",
			"zhCN": "Translated for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "Translated for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2022-03-18T21:04:00.000+00:00",
		"reading_time": 6,
		"slug": "domain-scoped-roles-early-access",
		"tags": [
			{
				"id": "3DmitkNK6euuD5BlhuvOLW",
				"name": "Security Week",
				"slug": "security-week"
			},
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			},
			{
				"id": "6QktrXeEFcl4e2dZUTZVGl",
				"name": "Product News",
				"slug": "product-news"
			},
			{
				"id": "1tnVQatXpUvEFq9vjg0SfJ",
				"name": "Domain Scoped Roles",
				"slug": "domain-scoped-roles"
			}
		],
		"title": "Domain Scoped Roles - Early Access",
		"updated_at": "2024-08-27T01:34:22.746Z",
		"url": "https://blog.cloudflare.com/domain-scoped-roles-early-access"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}