{
	"footerBlurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
	"initialReadingTime": "1",
	"locale": "en-us",
	"localesAvailable": [
		"zh-cn",
		"zh-tw",
		"fr-fr",
		"de-de",
		"ja-jp",
		"ko-kr"
	],
	"post": {
		"authors": [
			{
				"name": "Gabriel Gabor",
				"slug": "gabriel",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5WMYMXbYT3PzVjGn3lfbja/6e6e6a4806b3d291532e28fc75325708/gabriel.jpg",
				"location": null,
				"website": null,
				"twitter": null,
				"facebook": null,
				"publiclyIndex": true
			},
			{
				"name": "Andre Bluehs",
				"slug": "andre-bluehs",
				"bio": "Engineering Manager for the Managed Rules (WAF) team.",
				"profile_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/45Jp0onN2OjHSSPgfJX1Xa/879106a0fa87ac79939c7372d6e6b811/andre-bluehs.jpg",
				"location": "London, UK",
				"website": null,
				"twitter": null,
				"facebook": null,
				"publiclyIndex": true
			}
		],
		"excerpt": "This vulnerability is actively being exploited and anyone using Log4J should update to version 2.16.0 as soon as possible. Latest version is available on the Log4J download page.",
		"feature_image": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/uI6jAGy2p2WOmDdcDyaOO/451f8d79bd8b792ce3c4e1a744609856/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6HFvezpk0veaQFoKivOsj7/4a03a513216f5da31a99c2b88233c1d6/image1-80.png\" alt=\"Protection against CVE-2021-45046, the additional Log4J RCE vulnerability\" class=\"kg-image\" width=\"1200\" height=\"628\" loading=\"lazy\"/>\n            \n            </figure><p>Hot on the heels of CVE-2021-44228 a second Log4J CVE has been filed <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-45046\">CVE-2021-45046</a>. The rules that we <a href=\"/cve-2021-44228-log4j-rce-0-day-mitigation/\">previously released for CVE-2021-44228</a> give the same level of protection for this new CVE.</p><p>This vulnerability is actively being exploited and anyone using Log4J should update to version <b>2.16.0</b> as soon as possible, even if you have previously updated to 2.15.0. The latest version can be found on the <a href=\"https://logging.apache.org/log4j/2.x/download.html\">Log4J download page</a>.</p><p>Customers using the Cloudflare WAF have three rules to help mitigate any exploit attempts:</p><table><tr><td><p><b>Rule ID</b></p></td><td><p><b>Description</b></p></td><td><p><b>Default Action</b></p></td></tr><tr><td><p><code>100514 </code>(legacy WAF)\n<code>6b1cc72dff9746469d4695a474430f12</code>(new WAF)</p></td><td><p>Log4J Headers</p></td><td><p><code>BLOCK</code></p></td></tr><tr><td><p><code>100515 </code>(legacy WAF)\n<code>0c054d4e4dd5455c9ff8f01efe5abb10 </code>(new WAF)</p></td><td><p>Log4J Body</p></td><td><p><code>BLOCK</code></p></td></tr><tr><td><p><code>100516 </code>(legacy WAF)\n<code>5f6744fa026a4638bda5b3d7d5e015dd </code>(new WAF)</p></td><td><p>Log4J URL</p></td><td><p><code>BLOCK</code></p></td></tr></table><p>The mitigation has been split across three rules inspecting HTTP headers, body and URL respectively.</p><p>In addition to the above rules we have also released a fourth rule that will protect against a much wider range of attacks at the cost of a higher false positive rate. For that reason we have made it available but not set it to <code>BLOCK</code> by default:</p><table><tr><td><p><b>Rule ID</b></p></td><td><p><b>Description</b></p></td><td><p><b>Default Action</b></p></td></tr><tr><td><p><code>100517 </code>(legacy WAF)\n<code>2c5413e155db4365befe0df160ba67d7 </code>(new WAF)</p></td><td><p>Log4J Advanced URI, Headers</p></td><td><p><code>DISABLED</code></p></td></tr></table>\n    <div class=\"flex anchor relative\">\n      <h3 id=\"who-is-affected\">Who is affected</h3>\n      <a href=\"#who-is-affected\" aria-hidden=\"true\" class=\"relative sm:absolute sm:-left-5\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg>\n      </a>\n    </div>\n    <p>Log4J is a powerful Java-based logging library maintained by the Apache Software Foundation.</p><p>In all Log4J versions &gt;= 2.0-beta9 and ‚Üê 2.14.1 JNDI features used in configuration, log messages, and parameters can be exploited by an attacker to perform <a href=\"https://www.cloudflare.com/learning/security/what-is-remote-code-execution/\">remote code execution</a>. Specifically, an attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled.</p><p>In addition, the previous mitigations for CVE-2021-22448 as seen in version 2.15.0 were not adequate to protect against CVE-2021-45046.</p>",
		"id": "6pspqKqlsP5qiWZ0SPJahl",
		"localeList": {
			"name": "Protection against CVE-2021-45046, the additional Log4j RCE vulnerability Config",
			"enUS": "English for Locale",
			"zhCN": "Translated for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "Translated for Locale",
			"frFR": "Translated for Locale",
			"deDE": "Translated for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "Translated for Locale",
			"koKR": "Translated for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "This vulnerability is actively being exploited and anyone using Log4J should update to version 2.16.0 as soon as possible, even if you have previously updated to 2.15.0. The latest version can be found on the Log4J download page.",
		"metadata": {
			"title": "Protection against CVE-2021-45046, the additional Log4j RCE vulnerability",
			"description": "This vulnerability is actively being exploited and anyone using Log4J should update to version 2.16.0 as soon as possible, even if you have previously updated to 2.15.0. The latest version can be found on the Log4J download page.",
			"imgPreview": "https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2Syv2lVy5joNzykBvrbKkX/3df269fd2124e6cd51772d263b783383/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability-L2IvLX.png"
		},
		"primary_author": {},
		"publicly_index": true,
		"published_at": "2021-12-15T13:56:13.000+00:00",
		"slug": "protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability",
		"tags": [
			{
				"id": "7JF2fsZ3jyQAhuK7QLpTHZ",
				"name": "Log4J",
				"slug": "log4j"
			},
			{
				"id": "cwQv0X1pG0tueXmBQ4uOc",
				"name": "Log4Shell",
				"slug": "log4shell"
			},
			{
				"id": "7gPQ1MtyU85B0FNCOHq6ju",
				"name": "WAF Rules",
				"slug": "waf-rules"
			},
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			},
			{
				"id": "2pFyOCtANFB5qS6nbtQbVp",
				"name": "Vulnerabilities",
				"slug": "vulnerabilities"
			}
		],
		"title": "Protection against CVE-2021-45046, the additional Log4j RCE vulnerability",
		"updated_at": "2025-03-04T04:10:02.775Z",
		"url": "https://blog.cloudflare.com/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.icon_aria_label": "Search",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"search.result_stat_empty": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong>",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"search.autocomplete_title": "Insert a query. Press enter to send",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}