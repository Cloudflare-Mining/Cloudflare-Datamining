<div class="mb2 gray5">8 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/image4-4.png" class="kg-image" alt="Network flow monitoring is GA, providing end-to-end traffic visibility" loading="lazy" width="1999" height="1125"></figure>
	<p>Netzwerkingenieure stellen oft fest, dass ihnen zur Analyse von DDoS-Angriffen oder zur Behebung anderer Anomalien beim Traffic der nötige Überblick über den Datenverkehr und die betrieblichen Aktivitäten im Netzwerk fehlt. Normalerweise stehen ihnen übergeordnete Kennzahlen zum Netzwerk-Traffic zur Verfügung. Sie haben aber oft Mühe, grundlegende Daten zu den konkreten Flows zu erhalten, die ihnen bei der Klärung eines speziellen Problems helfen würden. Daher hat Cloudflare eine Lösung namens <a href="https://www.cloudflare.com/network-services/products/magic-network-monitoring" target="_blank">Magic Network Monitoring</a> entwickelt, die Kunden eine Nachverfolgung der Datenflüsse erlaubt und ihnen auf diese Weise einen lückenlosen Überblick über den gesamten Traffic innerhalb ihres Netzwerks verschafft.</p>
	<p>Cloudflare freut sich, heute bekannt geben zu können, dass Magic Network Monitoring (früher <a href="https://blog.cloudflare.com/flow-based-monitoring-for-magic-transit">Flow Based Monitoring</a>) jetzt für Enterprise-Kunden allgemein verfügbar ist. Im vergangenen Jahr hat unser Engineering-Team das Produkt erheblich verbessert. Deshalb können wir jetzt einen Netzwerkdienst anbieten, der unseren Kunden dabei helfen wird, Gefahren schneller zu erkennen, die Zahl ihrer Sicherheitslücken zu reduzieren und ihr Netzwerk sicherer zu machen.<br><br>Magic Network Monitoring wird für alle Enterprise-Kunden, die Magic Transit und Magic WAN nutzen, automatisch aktiviert. Das Produkt ist auf Konto-Ebene des Cloudflare-Dashboards angesiedelt. Sie finden es unter „Analytics Logs &gt; Magic Monitoring“. Die Einführung von Magic Network Monitoring erfolgt in Eigenregie und alle Enterprise-Kunden, die über einen Zugang verfügen, können sofort mit der Konfiguration der Lösung beginnen.</p>
	<p>Enterprise-Kunden, die weder Magic Transit noch Magic WAN nutzen und Magic Network Monitoring gern ausprobieren würden, können den Zugang zur kostenlosen Version (die hinsichtlich des Traffic-Volumens <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">beschränkt</a> ist) bei ihrem Ansprechpartner / ihrer Ansprechpartnerin bei Cloudflare stellen oder das folgende Formular ausfüllen, um sich <a href="http://network-services/products/magic-network-monitoring" target="_blank">fachkundig beraten</a> zu lassen.</p>
	<h3 id="was-versteht-man-unter-magic-network-monitoring">Was versteht man unter Magic Network Monitoring?</h3>
	<p>Magic Network Monitoring ist Werkzeug zur Nachverfolgung der Datenströme in einem Cloud-Netzwerk. Mit <a href="https://en.wikipedia.org/wiki/Traffic_flow_(computer_networking)" target="_blank">Netzwerk-Datenflüssen</a> sind die Wege gemeint, die Datenpakete zwischen einer Quelle und einem Ziel nehmen, die dasselbe Internetprotokoll und dieselben Ports nutzen. Kunden können Berichte zu diesen Netzwerk-Datenflüssen von ihren Routern (oder anderen Orten, an denen solche Datenflüsse generiert werden) an einen öffentlich verfügbaren Endpunkt im <a href="https://www.cloudflare.com/learning/cdn/glossary/anycast-network" target="_blank">Anycast-Netzwerk von Cloudflare</a> senden, auch wenn der Traffic ursprünglich nicht unser Netzwerk durchlaufen hat. Cloudflare analysiert die Netzwerk-Datenflüsse und ermöglicht Kunden anhand der Ergebnisse einen Überblick über wichtige Kennzahlen dazu in einem Analyse-Dashboard. Zu den bereitgestellten Daten gehören Traffic-Menge (angegeben in Bits oder Paketen) für einen bestimmten Zeitraum, Quellen- und Ziel-IP-Adressen, Ports, Traffic-Protokolle und Router-IP-Adressen. Kunden können außerdem außerdem festlegen, dass sie bei <a href="https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack" target="_blank">DDoS-Angriffen</a> und allen anderen Aktivitäten mit außergewöhnlich hohem Datenverkehrsvolumen eine Warnmeldung erhalten.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2023/10/1-1.png" class="kg-image" alt="" loading="lazy" width="1435" height="802">
		<figcaption>Flow-Daten können vom Netzwerk zur Analyse an Cloudflare übermittelt werden</figcaption>
	</figure>
	<h3 id="erkennung-und-aufschl%C3%BCsselung-von-ddos-angriffen-f%C3%BCr-enterprise-kunden">Erkennung und Aufschlüsselung von DDoS-Angriffen für Enterprise-Kunden</h3>
	<p>Kunden, die Magic Transit auf Abruf (<a href="https://developers.cloudflare.com/magic-transit/on-demand" target="_blank">Magic Transit On Demand</a> – MTOD) nutzen, werden beim Einsatz von Magic Network Monitoring durch den besseren Überblick über ihren Traffic erhebliche Vorteile verzeichnen. <a href="https://www.cloudflare.com/network-services/products/magic-transit" target="_blank">Magic Transit</a> ist eine Lösung für Netzwerksicherheit, die Schutz vor DDoS-Attacken und eine Beschleunigung des Traffics von jedem Cloudflare-Rechenzentrum für lokale, in der Cloud gehostete und hybride Netzwerke bietet. MTOD-Kunden können Magic Transit aktivieren, um sich zu schützen, sobald ein DDoS-Angriff festgestellt wird.</p>
	<p>Generell ist uns aufgefallen, dass einigen MTOD-Kunden Werkzeuge fehlten, um sich den zur schnellen Erkennung von DDoS-Attacken und zur Ergreifung der entsprechenden Gegenmaßnahmen erforderlichen Überblick zu verschaffen. Jetzt können diese Kunden Magic Network Monitoring nutzen, um ihre Netzwerkdaten zu analysieren und gewarnt zu werden, wenn ein DDoS-Angriff registriert wird.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2023/10/2-1.png" class="kg-image" alt="" loading="lazy" width="1436" height="761">
		<figcaption>Cloudflare erkennt eine DDoS-Attacke anhand der Flow-Daten aus dem Netzwerk des Kunden.</figcaption>
	</figure>
	<p>Magic Network Monitoring-Kunden können entscheiden, ob Magic Transit automatisch aktiviert wird oder sie dies selbst tun, sobald ein DDoS-Angriff erkannt wird.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2023/10/3-1.png" class="kg-image" alt="" loading="lazy" width="1436" height="761">
		<figcaption>Zum Schutz vor DDoS-Angriffen sollte Magic Transit aktiviert werden</figcaption>
	</figure>
	<h3 id="nachverfolgung-des-traffics-im-firmennetzwerk">Nachverfolgung des Traffics im Firmennetzwerk</h3>
	<p>Cloudflare-Kunden, die Magic WAN und Cloudflare One nutzen, können ebenfalls vom Einsatz von Magic Network Monitoring profitieren. Sie haben zwar schon einen ausgezeichneten Überblick über die Daten, die sie über das Cloudflare-Netzwerk übermitteln, aber möglicherweise galt das bislang noch nicht in gleichem Maß für Traffic, der nicht mittels Cloudflare versandt wird. Dazu kann der Datenverkehr gehören, der im lokalen Netzwerk verbleibt, oder der zwischen Cloud-Umgebungen ausgetauscht wird. Magic WAN- und Cloudflare One-Kunden können ihre Produktlösungen um Magic Network Monitoring ergänzen, um sich einen lückenlosen Überblick über den gesamten Datenverkehr innerhalb ihres Netzwerks zu verschaffen.</p>
	<h3 id="n%C3%A4heres-zu-flows-undtraffic-stichproben-innerhalb-des-netzwerks">Näheres zu Flows und -Traffic-Stichproben innerhalb des Netzwerks</h3>
	<p>Magic Network Monitoring (MNM) verschafft Kunden einen besseren Überblick über den Traffic in ihrem Netzwerk, indem das Tool die zugehörigen Informationen erfasst und analysiert.</p>
	<p>Das Verfahren beginnt, wenn ein Router (oder ein anderes Gerät, das innerhalb des Netzwerks Datenflüsse generiert) <a href="https://en.wikipedia.org/wiki/Sampling_(statistics)" target="_blank">für die Statistik Datenproben</a> zu ein- und ausgehenden Paketen erhebt. Diese Proben werden erhoben, indem 1 von X Paketen geprüft wird, wobei X die auf dem Router konfigurierte Stichprobenquote ist. Normalerweise liegen die Stichprobequoten zwischen 1 von 1.000 und 1 von 4.000 Paketen. Die ideale Stichprobenquote hängt von der Menge und der Vielfalt des Traffics sowie der Rechen- und Speicherleistung der Routerhardware ab. Weitere Einzelheiten zu den <a href="https://developers.cloudflare.com/magic-network-monitoring/routers/recommended-sampling-rate" target="_blank">empfohlenen Stichprobenquoten für den Netzwerkdatenfluss</a> finden Sie in der Cloudflare-Entwicklerdokumentation zu MNM.<br><br>Die erhobenen Daten werden in einem der beiden branchenüblichen Standardformate für Netzwerk-Datenfluss-Informationen gebündelt: NetFlow oder sFlow. Bei NetFlow werden die stichprobenartig erhobenen Paket-Daten nach verschiedenen Paket-Eigenschaften wie IP-Adresse der Quelle / des Ziels, Port und Protokoll gruppiert. Jede dieser Gruppen umfasst auch eine Schätzung des Traffic-Volumens. Bei sFlow wird als repräsentative Probe die gesamte Kopfzeile des Pakets erfasst, eine weitere Datenzusammenfassung findet nicht statt. Insofern ist sFlow ein reichhaltigeres Datenformat, das mehr Angaben zum Netzwerk-Traffic enthält als NetFlow. Wenn die Datenproben in NetFlow oder sFlow erhoben wurden, werden sie zur Analyse und Erstellung von Warnmeldungen an Magic Network Monitoring geschickt.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/4-1.png" class="kg-image" alt="" loading="lazy" width="1600" height="400"></figure>
	<h3 id="weshalb-die-einfache-zufalls-stichprobenerhebung-f%C3%BCr-magic-network-monitoring-nicht-ausreicht">Weshalb die einfache Zufalls-Stichprobenerhebung für Magic Network Monitoring nicht ausreicht</h3>
	<p>Magic Network Monitoring hat sich Beginn der Early Access-Phase vor einem Jahr stark weiterentwickelt. Das Engineering-Team von Cloudflare hat insbesondere viel Zeit darin investiert, die Genauigkeit bei der Schätzung der Datenverkehrsmenge zu erhöhen. Bei der Early Access-Version hatten Kunden überraschend berichtet, dass die ihnen genannten Schätzwerte zu hoch waren oder nicht den Erwartungen entsprachen.<br><br>Magic Network Monitoring führt bei den der Lösung übermittelten NetFlow- oder sFlow-Daten eigene Stichproben durch. So können die im gesamten weltumspannenden Cloudflare-Netzwerk eingehenden Daten skaliert und verwaltet werden. Es war schwieriger als erwartet, die Genauigkeit der Schätzungen des Datenverkehrsvolumens zu verbessern, da die durch MNM aufgegliederten Daten bereits auf Stichproben von Paketdaten beruhen. Somit beruht die von der Lösung durchgeführte Analyse auf mehreren Ebenen von Stichproben.</p>
	<p>Bei der ersten Version von Magic Network Monitoring wurde <a href="https://en.wikipedia.org/wiki/Simple_random_sample" target="_blank">die Stichprobenerhebung nach dem Zufallsprinzip</a> durchgeführt. Es wurde zufällig eine Reihe von Netzwerk-Flow-Daten mit demselben Zeitstempel ausgewählt, um die Traffic-Menge zu diesem bestimmten Zeitpunkt abzubilden. Ein Merkmal solcher Netzwerk-Flow-Daten ist, dass manche Proben bedeutsamer als andere sind und eine größere Menge des Datenverkehrs im Netzwerk darstellen. Um die Bedeutung der jeweiligen Probe abzubilden, kann jeder Einzelprobe eine <a href="https://en.wikipedia.org/wiki/Weighting" target="_blank">Gewichtung</a> auf Grundlage der von ihr dargestellten Traffic-Menge zugewiesen werden. Bei dieser Gewichtung handelt es sich immer um positive Werte, die eine <a href="https://en.wikipedia.org/wiki/Long_tail" target="_blank">Long Tail-Verteilung</a> aufweisen. Diese Dateneigenschaften hatten zur Folge, dass bei der zufälligen Stichprobenerhebung von MNM die Menge des Datenverkehrs im Netzwerk eines Kunden falsch geschätzt wurde. Bei den Analysen ihres Traffic-Aufkommens wurden den Kunden falsche Spitzen angezeigt, wenn eine abweichende Datenprobe aus dem Long Tail zufällig als repräsentativ für den gesamten Traffic zu diesem Zeitpunkt ausgewählt wurde.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/5-1.png" class="kg-image" alt="" loading="lazy" width="1600" height="400"></figure>
	<h3 id="h%C3%B6here-korrektheit-durch-reservoir-stichproben-mit-varopt">Höhere Korrektheit durch Reservoir-Stichproben mit VarOpt</h3>
	<p>Um dieses Problem zu lösen, hat das Engineering-Team von Cloudflare ein alternatives Verfahren zur <a href="https://en.wikipedia.org/wiki/Reservoir_sampling" target="_blank">Reservoir-Stichprobennahme</a> namens <a href="https://arxiv.org/pdf/0803.0473.pdf" target="_blank">VarOpt</a> implementiert. Bei dieser Methode werden Stichproben aus dem Datenfluss entnommen, wenn dessen Länge nicht bekannt ist (diese Anwendung ist perfekt dafür geeignet, eingehende Netzwerk-Flow-Daten zu analysieren). Bei der MNM-Implementierung von VarOpt beginnen wir zunächst mit einem leeren Reservoir festgelegter Größe, das mit Stichproben von Netzwerk-Flow-Daten befüllt wird. Wenn das Reservoir voll ist und noch weitere Netzwerk-Flow-Daten eingehen, wird eine ältere Stichprobe aus dem Reservoir nach dem Zufallsprinzip ausgewählt, entfernt und durch eine neue ersetzt. </p>
	<p>Nach Erfassung einer bestimmten Anzahl von Stichproben errechnen wir die Datenverkehrsmenge anhand aller gewichteten Stichproben im Reservoir. Daraus ergibt sich unser Schätzwert des Traffic-Volumens eines Netzwerk-Flows zu diesem bestimmten Zeitpunkt. Anschließend wird das Reservoir geleert und die VarOpt-Schleife beginnt erneut mit der Befüllung des Reservoirs mit neuen Stichproben aus den neuesten Netzwerk-Flow-Daten.</p>
	<p>Diese neue VarOpt-Methode zur Stichprobenerhebung erlaubt erheblich genauere Schätzungen des Datenverkehrsvolumens mit Magic Network Monitoring und hat das Problem unserer Kunden gelöst. Diese Verbesserung hat den Weg zur allgemeinen Verfügbarkeit geebnet und wir freuen uns, jetzt präzise Netzwerk-Flow-Analysen bereitstellen zu können.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/6-1.png" class="kg-image" alt="" loading="lazy" width="1600" height="320"></figure>
	<h3 id="entwicklerdokumentation-und-discord-community">Entwicklerdokumentation und Discord-Community</h3>
	<p>In der <a href="https://developers.cloudflare.com/magic-network-monitoring" target="_blank">Entwicklerdokumentation für Magic Network Monitoring</a> werden die Funktionen des Produkts eingehend erläutert. Außerdem findet sich dort eine ausführliche Konfigurationsanleitung für Neukunden. Wenn Sie bei der Verwendung der Entwicklerdokumentation zu Magic Network Monitoring Anmerkungen haben, lassen Sie uns das gern über die Schaltfläche „Give Feedback“ oben rechts in der Entwicklerdokumentation wissen.</p>
	<p>Wir haben auch einen Kanal für die Discord-Community von Cloudflare geschaffen, in dem Sie sich mit anderen über das Debugging bei Konfigurationsproblemen und das Testen neuer Funktionen austauschen und uns Feedback zu dem Produkt geben können. Folgen Sie einfach dem folgenden Link, um sich beim <a href="https://discord.gg/cloudflaredev" target="_blank">Cloudflare Discord-Server</a> anzumelden.</p>
	<h3 id="kostenlose-version">Kostenlose Version</h3>
	<p>Eine <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">kostenlose Version von Magic Network Monitoring</a> steht allen Enterprise-Kunden auf Anfrage bei ihren Cloudflare-Ansprechpartern zur Verfügung. Damit können Enterprise-Kunden die Lösung schnell ausprobieren und begutachten, bevor sie sich für den Erwerb von Magic Transit, Magic WAN oder Cloudflare One entscheiden. Sie können Magic Network Monitoring vollständig selbst konfigurieren. Dafür müssen Sie nur der <a href="https://developers.cloudflare.com/magic-network-monitoring/get-started" target="_blank">ausführlichen Anleitung</a> in der Produktdokumentation folgen. Bei der kostenlosen Version bestehen einige <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">Beschränkungen</a> hinsichtlich der Menge des Traffics, die bearbeitet werden kann. Näheres dazu ist der Begleitdokumentation der Lösung zu entnehmen.</p>
	<p>Magic Network Monitoring steht auch allen Kunden, die den Free-, Pro- und Business-Tarif von Cloudflare nutzen, in der kostenlosen Closed Beta-Version zur Verfügung. Der Zugang dafür kann nach <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">Lektüre der Dokumentation zur Gratisversion</a> durch das Ausfüllen <a href="https://forms.gle/z93ghpydpKdAFZ7P9" target="_blank">dieses Formulars</a> beantragt werden. Vorzugszugang erhält jeder, der sich beim <a href="https://discord.com/invite/cloudflaredev" target="_blank">https://discord.com/invite/cloudflaredevDiscord-Server von Cloudflare</a> anmeldet und eine entsprechende Nachricht im Discord-Kanal von Magic Network Monitoring postet.</p>
	<h3 id="n%C3%A4chste-schritte">Nächste Schritte</h3>
	<p>Magic Network Monitoring ist jetzt allgemein verfügbar und für sämtliche Kunden, die Magic Transit und Magic WAN nutzen, wurde heute der Zugang zu dem Produkt automatisch freigeschaltet. Sie können auf die Lösung zugreifen, indem Sie auf Konten-Ebene im Cloudflare-Dashboard „Analytics &amp; Logs &gt; Magic Monitoring“ aufrufen.</p>
	<p>Sollten Sie zu den Enterprise-Kunden gehören, die Magic Transit und/oder Magic WAN nicht nutzen, und sich mit Magic Network Monitoring einen besseren Überblick über Ihren Datenverkehr verschaffen möchten, können Sie sich <a href="http://network-services/products/magic-network-monitoring" target="_blank">fachkundig zu MNM beraten lassen</a>.<br><br>Falls Sie Magic Transit und Magic Network Monitoring zur DDoS-Abwehr nutzen möchten, können Sie <a href="https://www.cloudflare.com/network-services/products/magic-transit" target="_blank">eine Demo von Magic Transit</a> beantragen. Sollten Sie Interesse daran haben, Magic WAN und Magic Network Monitoring zusammen einzusetzen, um sich einen lückenlosen Überblick über den Traffic in Ihrem Netzwerk zu verschaffen, sprechen Sie einfach mit einem/einer <a href="https://www.cloudflare.com/network-services/products/magic-wan" target="_blank">Fachmann/Fachfrau für Magic WAN</a>.</p>
</div>