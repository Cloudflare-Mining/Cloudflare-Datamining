<div class="mb2 gray5">11 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image5-19.png" class="kg-image" alt="How we detect route leaks and our new Cloudflare Radar route leak service" loading="lazy"></figure>
	<p>Heute stellen wir die Route-Leak-Daten und die API von Cloudflare Radar vor, damit sich alle Interessierten über Routen-Lecks im Internet informieren können. Wir haben ein umfassendes System entwickelt, das sowohl Daten aus öffentlichen Quellen einbezieht als auch Cloudfares Sicht auf das Internet, die aus unserem riesigen globalen Netzwerk stammt. Das System liefert jetzt Route-Leak-Daten auf den ASN-Seiten von Cloudflare Radar und über die API.</p>
	<p>Dieser Blogbeitrag besteht aus zwei Teilen. Zunächst geht es um BGP und Route-Leaks, gefolgt von Details zu unserem System zur Erkennung von Route-Leaks und wie es Cloudflare Radar mit Daten speist.</p>
	<h2 id="-ber-bgp-und-route-leaks">Über BGP und Route-Leaks</h2>
	<p>Inter-Domain Routing, d. h. der Austausch von Erreichbarkeitsinformationen zwischen Netzwerken, ist entscheidend für die Funktionsfähigkeit und Performance des Internets. Das <a href="https://www.cloudflare.com/de-de/learning/security/glossary/what-is-bgp" target="_blank">Border Gateway Protocol (BGP)</a> ist das de facto Routing-Protokoll, das Routing-Informationen zwischen Organisationen und Netzwerken austauscht. Im Kern geht BGP davon aus, dass die ausgetauschten Informationen echt und vertrauenswürdig sind, was im heutigen Internet <a href="https://blog.cloudflare.com/rpki">leider nicht mehr der Fall ist</a>. In vielen Fällen machen Netzwerke Fehler oder täuschen absichtlich Informationen über die Erreichbarkeit vor und verteilen diese an den Rest des Internets. Solche Vorfälle führen zu erheblichen Störungen des Normalbetriebs des Internets. Eine solche Störung sind <strong>Route-Leaks</strong>.</p>
	<p>Wir betrachten Route-Leaks als die Verteilung von Routenankündigungen über ihren beabsichtigten Umfang hinaus (<a href="https://www.rfc-editor.org/rfc/rfc7908.html" target="_blank">RFC7908</a>). Route-Leaks führen zu erheblichen Störungen für Millionen von Nutzern, wie wir bei vielen bemerkenswerten Vorfällen in der Vergangenheit gesehen haben. So wurde im <a href="https://blog.cloudflare.com/how-verizon-and-a-bgp-optimizer-knocked-large-parts-of-the-internet-offline-today">Juni 2019 durch eine Fehlkonfiguration</a> in einem kleinen Netzwerk im US-Bundesstaat Pennsylvania (<a href="https://radar.cloudflare.com/traffic/as396531" target="_blank">AS396531</a> – Allegheny Technologies Inc) versehentlich ein Cloudflare-Präfix an Verizon geleakt, das daraufhin die falsch konfigurierte Route an den Rest seiner Peers und Kunden verteilte. Infolgedessen wurde der Traffic eines großen Teils des Internets durch die kapazitätsbeschränkten Leitungen eines kleinen Netzwerks gequetscht. Die daraus resultierende Überlastung führte dazu, dass der Großteil des Traffics von und zu dem betroffenen IP-Bereich von Cloudflare verworfen wurde.</p>
	<p>Ein ähnlicher Vorfall im November 2018 führte zu einer weitreichenden Nichtverfügbarkeit von Google-Diensten, als ein nigerianischer ISP (<a href="https://radar.cloudflare.com/traffic/as37282" target="_blank">AS37282</a> – Mainone) versehentlich eine große Anzahl von Google-IP-Präfixen <a href="https://blog.cloudflare.com/how-a-nigerian-isp-knocked-google-offline">an seine Peers und Provider leakte</a> und damit das Prinzip der <a href="https://ieeexplore.ieee.org/document/974527" target="_blank">Valley-Free-Prinzip</a> verletzte.</p>
	<p>Diese Vorfälle zeigen nicht nur die großen Auswirkungen von Route-Leaks, sondern auch den Schneeballeffekt, den Fehlkonfigurationen in kleinen regionalen Netzwerken auf das globale Internet haben können.</p>
	<p>So kritisch es auch ist, Route-Leaks sofort zu erkennen und zu beheben, werden sie oft erst erkannt, wenn Nutzer über die spürbaren Auswirkungen der Leaks berichten. Die Herausforderung bei der Erkennung und Prävention von Route-Leaks liegt darin, dass die AS-Geschäftsbeziehungen und BGP-Routing-Richtlinien in der Regel <a href="https://ieeexplore.ieee.org/document/974523" target="_blank">nicht offengelegt</a> werden und das betroffene Netzwerk oft weit von der Ursache des Route-Leaks entfernt ist.</p>
	<p>In den letzten Jahren wurden Lösungsansätze zur Prävention der Verteilung von Route-Leaks vorgeschlagen. Zu diesen Vorschlägen gehören <a href="https://datatracker.ietf.org/doc/rfc9234" target="_blank">RFC9234</a> und <a href="https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-aspa-verification" target="_blank">ASPA</a>, die BGP erweitern, um Sitzungen mit dem Beziehungstyp zwischen den beiden verbundenen AS-Netzwerken zu kennzeichnen, sodass Route-Leaks aufgespürt und verhindert werden können.</p>
	<p>Ein anderer Vorschlag zur Implementierung einer ähnlichen Signalisierung von BGP-Rollen ist die Verwendung von <a href="https://en.wikipedia.org/wiki/Border_Gateway_Protocol#Communities" target="_blank">BGP-Communities</a>, einem transitiven Attribut zur Kodierung von Metadaten in BGP-Ankündigungen. Obwohl diese Ansätze langfristig vielversprechend sind, befinden sie sich noch in einem sehr frühen Stadium und mit einer baldigen Umsetzung in großem Maßstab ist nicht zu rechnen.</p>
	<p>Bei Cloudflare haben wir ein System entwickelt, das Route-Leak-Events automatisch erkennt und sie mit Benachrichtigungen an mehrere Kanäle sichtbar macht. Wir bemühen uns weiterhin, <a href="https://developers.cloudflare.com/radar" target="_blank">der Öffentlichkeit mehr relevante Daten zur Verfügung zu stellen</a> und geben mit Freude bekannt, dass wir heute eine <a href="https://developers.cloudflare.com/api/operations/radar_get_BGPRouteLeakEvents" target="_blank">offene Daten-API</a> für unsere Route-Leak-Erkennungsergebnisse starten und die Ergebnisse in die Seiten von <a href="https://radar.cloudflare.com" target="_blank">Cloudflare Radar</a> integrieren.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image4-32.png" class="kg-image" alt="" loading="lazy"></figure>
	<h2 id="definition-und-arten-von-route-leaks">Definition und Arten von Route-Leaks</h2>
	<p>Doch bevor wir näher auf die Entwicklung unserer Systeme eingehen, erklären wir zunächst kurz, was ein Route-Leak ist und warum er unbedingt erkannt werden muss.</p>
	<p>Zur Definition von Route-Leaks beziehen wir uns auf das von der IETF veröffentlichte Dokument RFC7908 <a href="https://www.rfc-editor.org/rfc/rfc7908.html" target="_blank"><em>„Problem Definition and Classification of BGP Route Leaks“</em></a>.</p>
	<p>&gt; Ein Route-Leak ist die Propagierung von Routenankündigungen über den beabsichtigten Geltungsbereich hinaus.</p>
	<p>Der <em>beabsichtigte Geltungsbereich</em> wird oft konkret als Inter-Domain-Routing-Richtlinien definiert, basierend auf Geschäftsbeziehungen zwischen Autonomen Systemen (AS). Diese Geschäftsbeziehungen <a href="https://ieeexplore.ieee.org/document/974527" target="_blank">lassen sich grob in vier Kategorien einteilen</a>: Kunden, Transit Provider, Peers und Siblings, aber auch komplexere Arrangements sind möglich.</p>
	<p>Bei einer Kunden-Anbieter-Beziehung vereinbart das Kunden-AS mit einem anderen Netzwerk, seinen Traffic in die globale Routing-Tabelle zu übertragen. In einer Peer-to-Peer-Beziehung vereinbaren zwei AS einen freien bilateralen Traffic-Austausch, allerdings nur zwischen ihren eigenen IPs und den IPs ihrer Kunden. AS, die derselben Verwaltungseinheit angehören, werden als Siblings betrachtet, und ihr Traffic-Austausch unterliegt oft keinen Beschränkungen. &nbsp;Die folgende Abbildung zeigt, wie sich die drei wichtigsten Beziehungstypen auf die Exportrichtlinien auswirken.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image7-7.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>Indem wir die Arten von Beziehungen auf AS-Ebene und ihre Auswirkungen auf die Propagierung von BGP-Routen kategorisieren, können wir mehrere Phasen einer Präfix-Ursprungsankündigung während der Propagierung definieren:</p>
	<ul>
		<li>upward: alle Pfadsegmente während dieser Phase sind vom <strong>Kunden zum Provider</strong></li>
		<li>Peering: ein Peer-Peer-Pfadsegment</li>
		<li>downward: alle Pfadsegmente in dieser Phase sind von <strong>Provider zu Kunde</strong></li>
	</ul>
	<p>Ein AS-Pfad, der dem <a href="https://ieeexplore.ieee.org/document/6363987" target="_blank">Prinzip des Valley-Free-Routing</a> folgt, hat <strong>Upward-, Peering- und Downward</strong>-Phasen, die alle optional sind, aber <strong>in dieser Reihenfolge</strong> erfolgen müssen. Hier ist ein Beispiel für einen AS-Pfad, der dem Valley-Free-Routing entspricht.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image11-4.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>In RFC7908, <a href="https://www.rfc-editor.org/rfc/rfc7908.html" target="_blank"><em>„Problem Definition and Classification of BGP Route Leaks“</em></a> definieren die Autoren sechs Arten von Route-Leaks, auf die wir uns bei unserem Systemaufbau beziehen. Im Folgenden stellen wir die einzelnen Typen von Route-Leaks vor.</p>
	<h3 id="typ-1-hairpin-turn-mit-vollem-pr-fix">Typ 1: Hairpin Turn mit vollem Präfix</h3>
	<p>&gt; Ein Multihomed-AS lernt eine Route von einem Upstream-ISP und verteilt sie einfach an einen anderen Upstream-ISP (was im Wesentlichen einer Serpentine ähnelt). &nbsp;Weder das Präfix noch der AS-Pfad werden in der Aktualisierung geändert.</p>
	<p>Ein AS-Pfad, der ein Provider-Kunden- und ein Kunden-Provider-Segment enthält, gilt als Typ-1-Leak. Das folgende Beispiel: AS4 → AS5 → AS6 bildet ein Typ-1-Leak.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image9-5.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>Typ 1 ist die bekannteste Art von Route-Leaks und hat große Auswirkungen. In vielen Fällen ist eine Kundenroute besser als eine Peer- oder Provider-Route. In diesem Beispiel wird AS6 den Traffic wahrscheinlich lieber über AS5 als über seine anderen Peer- oder Provider-Routen schicken, wodurch AS5 ungewollt zum Transit-Provider wird. Dies kann die Performance des Traffics im Zusammenhang mit dem geleakten Präfix erheblich beeinträchtigen oder zu Ausfällen führen, wenn das geleakte AS nicht für die Bewältigung eines großen Traffic-Aufkommens ausgelegt ist.</p>
	<p>Im Juni 2015 hat Telekom Malaysia (<a href="https://radar.cloudflare.com/traffic/as4788" target="_blank">AS4788</a>), ein regionaler ISP, <a href="https://www.bgpmon.net/massive-route-leak-cause-internet-slowdown" target="_blank">über 170.000</a> von seinen Providern und Peers erlernte Routen an seinen anderen Provider Level3 (<a href="https://radar.cloudflare.com/traffic/as3549" target="_blank">AS3549</a>, jetzt Lumen) geleakt. Level3 akzeptierte die Routen und verteilte sie weiter an seine nachgelagerten Netzwerke, was wiederum weltweit zu erheblichen Netzwerkproblemen führte.</p>
	<h3 id="typ-2-lateraler-isp-isp-isp-leak">Typ 2: Lateraler ISP-ISP-ISP-Leak</h3>
	<p>Ein Typ-2-Leak ist definiert als die Verteilung von Routen, die von einem Peer zu einem anderen Peer erhalten wurden, wodurch zwei oder mehr aufeinanderfolgende Peer-to-Peer-Pfadsegmente entstehen.</p>
	<p>Hier ist ein Beispiel: AS3 → AS4 → AS5 bildet einen Typ-2-Leak.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image1-70.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>Ein Beispiel für solche Leaks ist das Auftreten von <a href="https://archive.nanog.org/meetings/nanog41/presentations/mauch-lightning.pdf" target="_blank">mehr als drei sehr großen Netzwerken in Folge</a>. Sehr große Netzwerke (wie z. B. Verizon und Lumen) kaufen keine Transitleistungen voneinander, und wenn <a href="https://puck.nether.net/bgp/leakinfo.cgi" target="_blank">mehr als drei solcher Netzwerke</a> nacheinander auf dem Pfad auftauchen, ist das oft ein Hinweis auf ein Route-Leak.</p>
	<p>In der Praxis ist es jedoch nicht ungewöhnlich, dass mehrere kleine Peering-Netzwerke Routen austauschen und sich gegenseitig weiterleiten. Für diese Art von Netzwerkpfad gibt es legitime wirtschaftliche Gründe. Diese Art von Route-Leaks macht uns weniger Sorgen als Typ 1.</p>
	<h3 id="typ-3-und-4-provider-routet-zum-peer-peer-routet-zum-provider">Typ 3 und 4: Provider routet zum Peer; Peer routet zum Provider</h3>
	<p>Bei diesen beiden Arten werden die Routen von einem Provider oder einem Peer nicht an einen Kunden, sondern an einen anderen Peer oder Provider verteilt. Hier sind die Illustrationen der beiden Arten von Leaks:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image10-3.png" class="kg-image" alt="" loading="lazy"></figure>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image13-1.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>Wie <a href="https://blog.cloudflare.com/how-a-nigerian-isp-knocked-google-offline">in dem bereits erwähnten Beispiel</a> hat ein nigerianischer ISP, der mit Google zusammenarbeitet, versehentlich seine Route zu seinem Provider <a href="https://radar.cloudflare.com/traffic/as4809" target="_blank">AS4809</a> geleakt und damit ein Route-Leak vom Typ 4 erzeugt. Da Routen über Kunden in der Regel anderen vorgezogen werden, leitete der große Provider (AS4809) seinen Traffic über seinen Kunden, d. h. den „durchgesickerten“ ASN, zu Google um, überwältigte den kleinen ISP und legte Google für über eine Stunde lahm.</p>
	<h2 id="route-leaks-zusammenfassung">Route-Leaks Zusammenfassung</h2>
	<p>Bisher haben wir uns die vier in <a href="https://www.rfc-editor.org/rfc/rfc7908.html" target="_blank">RFC7908</a> definierten Arten von Route-Leaks angeschaut. Allen vier Arten von Route-Leaks ist gemeinsam, dass sie über AS-Beziehungen definiert sind, d. h. über Peers, Kunden und Provider. Wir fassen die Arten von Leaks zusammen, indem wir die Propagierung der AS-Pfade danach kategorisieren, woher die Routen gelernt werden und wohin sie verteilt werden. Die Ergebnisse sind in der folgenden Tabelle dargestellt.</p><!--kg-card-begin: html-->
	<table width="100%">
		<thead>
			<tr>
				<th>Routet von / verteilt zum</th>
				<th>Zum Provider</th>
				<th>Zum Peer</th>
				<th>Zum Kunden</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Vom Provider</td>
				<td>Typ 1</td>
				<td>Typ 3</td>
				<td>Normal</td>
			</tr>
			<tr>
				<td>Vom Peer</td>
				<td>Typ 4</td>
				<td>Typ 2</td>
				<td>Normal</td>
			</tr>
			<tr>
				<td>Vom Kunden</td>
				<td>Normal</td>
				<td>Normal</td>
				<td>Normal</td>
			</tr>
		</tbody>
	</table><!--kg-card-end: html-->
	<p>Wir können die gesamte Tabelle in einer einzigen Regel zusammenfassen: <strong>Routen, die von einem Nicht-Kunden-AS stammen, können nur an Kunden propagiert werden</strong>.</p>
	<p><em>Hinweis: Route-Leaks vom Typ 5 und 6 sind definiert als Re-Originierung von Präfixen und Ankündigung privater Präfixe. Typ 5 steht in engerem Zusammenhang mit </em><a href="https://www.cloudflare.com/learning/security/glossary/bgp-hijacking" target="_blank"><em>Präfix-Hijackings</em></a><em>, auf die wir unser System in den nächsten Schritten ausweiten wollen, während Leaks vom Typ 6 außerhalb des Rahmens dieser Arbeit liegen. Mehr dazu finden Sie in den Abschnitten 3.5 und 3.6 von </em><a href="https://www.rfc-editor.org/rfc/rfc7908.html" target="_blank"><em>RFC7908</em></a><em>.</em></p>
	<h2 id="das-route-leak-system-von-cloudflare-radar">Das Route-Leak-System von Cloudflare Radar</h2>
	<p>Nachdem wir nun wissen, was ein Route-Leak ist, schauen wir uns an, wie wir unser System zur Erkennung von Route-Leaks entwickelt haben.</p>
	<p>Auf einer sehr hohen Ebene unterteilen wir unser System in drei verschiedene Komponenten:</p>
	<ol>
		<li><strong>Modul zur Sammlung von Rohdaten</strong>: verantwortlich für das Sammeln von BGP-Daten aus verschiedenen Quellen und die Bereitstellung des BGP-Nachrichtenstroms für nachgelagerte Verbraucher.</li>
		<li><strong>Modul zur Erkennung von Leaks:</strong>Es erkennt, ob es sich bei einem bestimmten Pfad auf AS-Ebene um ein Route-Leak handelt, schätzt das Konfidenzniveau der Bewertung ab, aggregiert alle externen Beweise, die für die weitere Analyse des Events benötigt werden, und stellt sie bereit.</li>
		<li><strong>Modul zur Speicherung und Benachrichtigung:</strong>verantwortlich für den Zugriff auf erkannte Route-Leaks-Events und das Versenden von Benachrichtigungen an relevante Parteien. Dies könnte auch den Aufbau eines Dashboards für den einfachen Zugriff und die Suche nach vergangenen Events sowie die Bereitstellung der Nutzeroberfläche für die Analyse des Events auf höchster Ebene umfassen.</li>
	</ol>
	<h3 id="modul-zur-sammlung-von-daten">Modul zur Sammlung von Daten</h3>
	<p>Wir berücksichtigen drei Arten der Dateneingabe:</p><!--kg-card-begin: markdown-->
	<ol>
		<li>Historisch: BGP-Archivdateien für eine bestimmte Zeitspanne in der Vergangenheit<br>
			a. <a href="https://www.routeviews.org/routeviews" target="_blank">RouteViews</a> und <a href="https://ris.ripe.net/docs/20_raw_data_mrt.html#name-and-location" target="_blank">RIPE RIS</a> BGP-Archive</li>
		<li>Semi-Echtzeit: BGP-Archivdateien, sobald sie verfügbar sind, mit einer Verzögerung von 10–30 Minuten<br>
			a. RouteViews und RIPE RI-Archive mit Datenbroker, der regelmäßig neue Dateien prüft (z. B. <a href="https://bgpkit.com/broker" target="_blank">BGPKIT Broker</a>)</li>
		<li>Echtzeit: echte Echtzeit-Datenquellen<br>
			a. <a href="https://ris-live.ripe.net" target="_blank">RIPE RIS Live</a><br>
			b. Cloudflare-interne BGP-Quellen</li>
	</ol>
	<!--kg-card-end: markdown-->
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image6-11.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>In der aktuellen Version verwenden wir die Semi-Echtzeit-Datenquelle für das Erkennungssystem, d. h. die BGP-Update-Dateien von RouteViews und RIPE RIS. Der Vollständigkeit halber verarbeiten wir die Daten aller öffentlichen Collectors dieser beiden Projekte (insgesamt 63 Collectors und über 2.400 Collector-Peers) und implementieren eine Pipeline, die in der Lage ist, die BGP-Daten zu verarbeiten, sobald die Datendateien verfügbar sind.</p>
	<p>Für die Indizierung und Verarbeitung der Dateien haben wir eine lokale <a href="https://github.com/bgpkit/bgpkit-broker-backend" target="_blank">BGPKIT-Broker-Instanz</a> mit aktiviertem Kafka-Feature für die Nachrichtenübermittlung und eine benutzerdefinierte Pipeline eingerichtet, für die gleichzeitige Verarbeitung von <a href="https://www.rfc-editor.org/rfc/rfc6396.html" target="_blank">MRT</a>-Daten auf der Grundlage des <a href="https://github.com/bgpkit/bgpkit-parser" target="_blank">BGPKIT Parser</a> Rust SDK. Das Modul zur Datensammlung verarbeitet MRT-Dateien und konvertiert die Ergebnisse in einen BGP-Nachrichtenstrom mit über zwei Milliarden BGP-Nachrichten pro Tag (etwa 30.000 Nachrichten pro Sekunde).</p>
	<h3 id="route-leak-detection">Route Leak Detection</h3>
	<p>Das Modul zur Erkennung von Route-Leaks arbeitet auf der Ebene der einzelnen BGP-Ankündigungen. Die Erkennungskomponente untersucht eine BGP-Nachricht nach der anderen und schätzt ab, wie wahrscheinlich es sich bei einer bestimmten BGP-Nachricht um das Ergebnis eines Route-Leaks-Events handelt.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image8-5.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>Wir stützen unseren Erkennungsalgorithmus hauptsächlich auf das <a href="https://ieeexplore.ieee.org/document/6363987" target="_blank">Valley-Free-Modell</a> – wir glauben, dass damit die meisten bemerkenswerten Route-Leaks erkannt werden können. Wie bereits erwähnt, liegt der Schlüssel zu einer geringen Anzahl falsch-positiver Ergebnisse bei der Erkennung von Route-Leaks mit dem Valley-Free-Modell in genauen Beziehungen auf AS-Ebene. Obwohl diese Beziehungstypen nicht von jedem AS veröffentlicht werden, gibt es bereits seit über <a href="https://ieeexplore.ieee.org/document/6027863" target="_blank">zwei Jahrzehnten Forschungsarbeiten</a> zur Ableitung der Beziehungstypen unter Verwendung öffentlich beobachteter BGP-Daten.</p>
	<p>Zwar haben sich moderne Algorithmen zur Ableitung von Beziehungen als <a href="https://dl.acm.org/doi/10.1145/2504730.2504735" target="_blank">sehr genau</a> erwiesen, doch selbst eine geringe Fehlermarge kann bei der Erkennung von Route-Leaks noch zu Ungenauigkeiten führen. Um solche Artefakte zu vermeiden, fassen wir mehrere Datenquellen für die Ableitung von Beziehungen auf AS-Ebene zusammen, darunter die <a href="https://www.caida.org" target="_blank">CAIDA/UCSD</a> <a href="https://www.caida.org/catalog/datasets/as-relationships" target="_blank">AS-Beziehungsdaten</a> und unseren selbst erstellten AS-Beziehungsdatensatz. Aufbauend auf den beiden AS-Beziehungen erstellen wir einen wesentlich detaillierteren Datensatz auf der Ebene der einzelnen Präfixe und der einzelnen Peers. Mit dem verbesserten Datensatz können wir die Frage beantworten, wie die Beziehung zwischen AS1 und AS2 in Bezug auf das Präfix P aussieht, das von Collector Peer X beobachtet wird. Dies beseitigt einen Großteil der Mehrdeutigkeit in Fällen, in denen Netzwerke mehrere unterschiedliche Beziehungen auf der Grundlage von Präfixen und geografischen Standorten haben, und reduziert so die Anzahl der falsch-positiven Ergebnisse im System. Neben den AS-Beziehungsdatensätzen verwenden wir auch den <a href="https://ihr.iijlab.net/ihr/en-us/documentation#AS_dependency" target="_blank">AS-Hegemonie-Datensatz</a> von <a href="https://ihr.iijlab.net/ihr/en-us" target="_blank">IHR IIJ</a>, um falsch-positive Ergebnisse weiter zu reduzieren.</p>
	<h3 id="speicherung-und-pr-sentation-von-route-leaks">Speicherung und Präsentation von Route-Leaks</h3>
	<p>Nach der Verarbeitung jeder BGP-Nachricht speichern wir die generierten Route-Leak-Einträge in einer Datenbank zur langfristigen Aufbewahrung und Auswertung. Außerdem fassen wir einzelne BGP-Ankündigungen von Route-Leaks zusammen und gruppieren relevante Leaks aus demselben Leak-ASN innerhalb eines kurzen Zeitraums zu <strong>Route-Leak-Events</strong>. Die Route-Leak-Events können dann von verschiedenen nachgelagerten Anwendungen genutzt werden, z. B. Web-UIs, einer <a href="https://developers.cloudflare.com/api/operations/radar_get_BGPRouteLeakEvents" target="_blank">API</a> oder Warnmeldungen.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image12-2.png" class="kg-image" alt="" loading="lazy"></figure>
	<h2 id="route-leaks-auf-cloudflare-radar">Route-Leaks auf Cloudflare Radar</h2>
	<p>Cloudflare möchte zu einem besseren Internet beitragen, und dazu gehört auch, dass wir unsere Arbeit an der Überwachung und Sicherung des Internet-Routings teilen. Heute geben wir unser System zum Erkennen von Route-Leaks als öffentliche Beta-Version frei.</p>
	<p>Ab heute finden Nutzer auf den ASN-Seiten von Cloudflare Radar eine Liste der Route-Leaks, die diese AS betreffen. Wir gehen davon aus, dass eine AS betroffen ist, wenn die Leaker-AS in irgendeiner Richtung einen Hop von ihr entfernt ist, egal ob davor oder danach.</p>
	<p>Die ASN-Seite von Cloudflare Radar ist direkt über <strong>https://radar.cloudflare.com/as{ASN}</strong> zugänglich. Gehen Sie zum Beispiel auf <a href="https://radar.cloudflare.com/as174" target="_blank">https://radar.cloudflare.com/as174</a>, um die Übersichtsseite für Cogent AS174 anzuzeigen. Die ASN-Seiten zeigen jetzt eine spezielle Karte für Route-Leaks, die für den aktuellen ASN innerhalb des ausgewählten Zeitraums erkannt wurden.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image2-54.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>Nutzer können auch unsere <a href="https://developers.cloudflare.com/api/operations/radar_get_BGPRouteLeakEvents" target="_blank">öffentliche Daten-API</a> verwenden, um Route-Leak-Events in Bezug auf einen beliebigen ASN abzurufen. Unsere API unterstützt die Filterung der Ergebnisse von Route-Leaks nach Zeitspannen und beteiligten AS. Hier sehen Sie einen Screenshot der <a href="https://developers.cloudflare.com/api/operations/radar_get_BGPRouteLeakEvents" target="_blank">API-Dokumentationsseite zu Route-Leak-Events</a> auf der <a href="https://blog.cloudflare.com/building-a-better-developer-experience-through-api-documentation">neu aktualisierten API-Docs-Seite</a>.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/11/image3-44.png" class="kg-image" alt="" loading="lazy"></figure>
	<h2 id="mehr-zum-thema-routing-sicherheit">Mehr zum Thema Routing-Sicherheit</h2>
	<p>Was die Erkennung von Route-Leaks betrifft, haben wir noch viel mehr geplant. Weitere Features wie eine globale Ansichtsseite, Route-Leaks-Benachrichtigungen, erweiterte APIs, benutzerdefinierte Automatisierungsskripte und historische Archivdatensätze werden im Laufe der Zeit auf Cloudflare Radar verfügbar sein. Ihr Feedback und Ihre Vorschläge sind ebenfalls sehr wichtig für uns, damit wir unsere Erkennungsergebnisse weiter verbessern und der Öffentlichkeit bessere Daten zur Verfügung stellen können.</p>
	<p>Darüber hinaus werden wir unsere Arbeit an anderen wichtigen Themen der Internet-Routing-Sicherheit weiter ausbauen. Dazu gehören die globale Erkennung von BGP-Hijacks (nicht auf unsere Kundennetzwerke beschränkt), die Überwachung der RPKI-Überprüfung, Open-Sourcing-Tools und Architekturdesigns sowie ein zentrales Web-Gateway für Routing-Sicherheit. Unser Ziel ist es, den Communities die besten Daten und Tools für Routing-Sicherheit zur Verfügung zu stellen, damit wir gemeinsam ein besseres und sichereres Internet aufbauen können.</p>
	<p>In der Zwischenzeit haben wir einen <a href="https://discord.com/channels/595317990191398933/1035553707116478495" target="_blank">Radar-Raum</a> auf unserem Developers Discord Server eröffnet. <a href="https://discord.com/channels/595317990191398933/1035553707116478495" target="_blank">Treten Sie bei</a> und sprechen Sie mit uns. Das Team freut sich auf Ihr Feedback und beantwortet gerne Ihre Fragen.</p>
	<p>Besuchen Sie <a href="https://radar.cloudflare.com" target="_blank">Cloudflare Radar</a> für weitere Einblicke in das Internet. Folgen Sie uns auch gerne <a href="https://twitter.com/CloudflareRadar" target="_blank">auf Twitter</a> für weitere Radar-Updates.</p>
</div>