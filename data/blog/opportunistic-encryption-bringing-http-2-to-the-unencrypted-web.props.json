{
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Nick Sullivan",
				"slug": "nick-sullivan",
				"bio": "Nick Sullivan was Head of Research (& Cryptography) at Cloudflare until 2023. He is passionate about improving security and privacy through cutting-edge research and the development of open standards.",
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1awsFzXodRY6h5BEcWKcCE/85e0d04bb0360398b832e6476173945e/nick-sullivan.jpg",
				"location": "San Francisco",
				"website": "https://crypto.dance",
				"twitter": "@grittygrease",
				"facebook": null
			}
		],
		"excerpt": "Encrypting the web is not an easy task. Various complexities prevent websites from migrating from HTTP to HTTPS, including mixed content, which can prevent sites from functioning with HTTPS. ",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/49fkvGljCWUPOpOW4TsNNi/646f14b3fc9ac79381e1cccb2501c4bd/opportunistic-encryption-bringing-http-2-to-the-unencrypted-web.jpg",
		"featured": false,
		"html": "<p>Encrypting the web is not an easy task. Various complexities prevent websites from migrating from HTTP to HTTPS, including mixed content, which can prevent sites from functioning with HTTPS.</p><p>Opportunistic Encryption provides an additional level of security to websites that have not yet moved to HTTPS and the performance benefits of HTTP/2. Users will not see a security indicator for HTTPS in the address bar when visiting a site using Opportunistic Encryption, but the connection from the browser to the server is encrypted.</p><p>In December 2015, CloudFlare introduced <a href=\"https://www.cloudflare.com/http2/\">HTTP/2</a>, the latest version of HTTP, that can result in improved performance for websites. HTTP/2 can’t be used without encryption, and before now, that meant HTTPS. Opportunistic Encryption, based on an <a href=\"http://httpwg.org/http-extensions/draft-ietf-httpbis-http2-encryption.html\">IETF draft</a>, enables servers to accept HTTP requests over an encrypted connection, allowing HTTP/2 connections for non-HTTPS sites. This is a first.</p><p>Combined with <a href=\"/introducing-tls-1-3/\">TLS 1.3</a> and <a href=\"/announcing-support-for-http-2-server-push-2/\">HTTP/2 Server Push</a>, Opportunistic Encryption can result in significant performance gains, while also providing security benefits.</p><p>Opportunistic Encryption is now available to all CloudFlare customers, enabled by default for Free and Pro plans. The option is available in the Crypto tab of the CloudFlare dashboard:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/53Z7Qo7rd4AQlJC0kikjXS/706b5e4d9f4092518d08aa24c7839208/Screen-Shot-2016-09-21-at-16.19.03.png\" alt=\"\" class=\"kg-image\" width=\"968\" height=\"242\" loading=\"lazy\"/>\n            \n            </figure><h3>How it works</h3><p>Opportunistic Encryption uses <a href=\"http://httpwg.org/http-extensions/alt-svc.html\">HTTP Alternative Services</a>, a mechanism that allows servers to tell clients that the service they are accessing is available at another network location or over another protocol. When a supporting browser makes a request to a CloudFlare site with Opportunistic Encryption enabled, CloudFlare adds an Alternative Service header to indicate that the site is available over HTTP/2 (or SPDY) on port 443.</p><p>For customers with HTTP/2 enabled:<code>Alt-Svc: h2=”:443”; ma=60</code></p><p>For customers with HTTP/2 disabled:<code>Alt-Svc: spdy/3.1=”:443”; ma=60</code></p><p>This header simply states that the domain can be authoritatively accessed using HTTP/2 (“h2”) or SPDY 3.1 (“spdy/3.1”) at the same network address, over port 443 (the standard HTTPS port). The field “ma” (max-age) indicates how long in seconds the client should remember the existence of the alternative service.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2QNLkeEtnUSqIk1sg0yDZn/05a6d50115d92f4d81fb893ceea1e0e2/2829700354_4cb63ac45e_b.jpg\" alt=\"\" class=\"kg-image\" width=\"1024\" height=\"768\" loading=\"lazy\"/>\n            \n            </figure><p><a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC BY-SA 2.0</a> <a href=\"https://www.flickr.com/photos/jabberwocky381/2829700354/in/photolist-5j3Xk9-9ozwgL-CyXzMW-b9NypP-af3UAc-c5VG2j-7tCoKg-8iRnKw-4F2xWk-4F6MDS-g5xKwj-6t8Gpg-e7gmMh-ahbP86-aheB15-aheAzE-8ucqdq-aheBcf-DETnGc-8ogV2T-9PNooC-9PKwkx-9PNots-2hpkp-F3qYFL-xdQqLr-9PKwe2-9PKwhT-Fe87Tv-Fe88gK-GnUy7Z-HigQiP-H9VVcS-HigRaP-H9VUFw-HigQPZ-H9VVdy-H9VUA1-H9VV9W-HigPYR-H9VULm-HigRat-HigQUt-H9VVRC-HigQXV-HigQxg-H9VV6u-H9VUuQ-frEFs1-HfkgMN\">image</a> by <a href=\"https://www.flickr.com/photos/jabberwocky381/\">Evan Jackson</a></p><p>When Firefox (or any other browser that supports Opportunistic Encryption) receives an “h2” Alt-Svc header, it knows that the site is available using HTTP/2 over TLS on port 443. For any subsequent HTTP requests to that domain, the browser will connect using TLS on port 443, where the server will present a certificate for the domain signed by a trusted certificate authority. The browser will then validate the certificate. If the connection succeeds, the browser will send the requests over that connection using HTTP/2.</p><p>Opportunistically encrypted requests will contain “http” in the <a href=\"https://http2.github.io/http2-spec/#HttpRequest\"><code>:scheme</code> pseudo-header</a> instead of “https”. From a bit-on-the-wire perspective, this pseudo-header is the only difference between HTTP requests with Opportunistic Encryption over TLS and HTTPS. However, there is a big difference between how browsers treat assets fetched using HTTP vs. HTTPS URLs (as discussed below).</p><p>HTTP Alternative Services is a relatively new but widely used mechanism. For example, Alt-Svc is used by Google to advertise support for their experimental transport protocol, <a href=\"https://www.chromium.org/quic\">QUIC</a>, to browsers in much the same way as we use it to advertise support for Opportunistic Encryption.</p><h2>Why not just use HTTPS?</h2><p>CloudFlare enables HTTPS by default for customers on <a href=\"https://www.cloudflare.com/plans/\">all plans</a> using Universal SSL. However, some sites choose to continue to allow access to their sites via unencrypted HTTP. The main reason for this is mixed content. If a site contains references to HTTP images, or makes requests to HTTP URLs via embedded scripts, browsers will present warnings or even block requests outright, often breaking the functionality of the site.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/53q02AwHvDVUSNdgdmG2eX/feb6a004e11167e673bca934b80f4e7f/16467022408_789bc66bfb_z.jpg\" alt=\"\" class=\"kg-image\" width=\"640\" height=\"426\" loading=\"lazy\"/>\n            \n            </figure><p><a href=\"https://creativecommons.org/licenses/by/2.0/\">CC BY 2.0</a> <a href=\"https://www.flickr.com/photos/blondinrikard/16467022408/in/photolist-r68N4s-wdqoLL-wL6trG-vTynKb-vTyjDm-wbh17E-wawCrA-vw2iz8-wbofNT-w8RLP5-wboR8p-wscuys-wbgUu9-wPHQUT-wtmaGV-wsdj2U-wbo7Fv-wbgW9m-wtm9RM-wbgfb3-wqyuDm-wboXM6-wbp7jX-wsTgrP-wbALUc-wujVgK-vea2uj-wscmum-veiEag-vea12j-veiFGV-wbgLWS-wbaXWX-veiH66-wqznYf-vea193-vTyvb1-wucvcL-AKwG91-wbaZmk-vTFwsg-vTynJC-wucAZE-wawzEJ-AKCQWi-wawoMm-wbaWhV-wbaVVH-wbb8hv-wujW96\">image</a> by <a href=\"https://www.flickr.com/photos/blondinrikard/\">Blondinrikard Fröberg</a></p><p>Making sure a site can be fully migrated to HTTPS can be a manual and time-consuming process. It can require someone to manually inspect every page on a site or set up a <a href=\"https://content-security-policy.com/\">Content Security Policy (CSP)</a> reporting infrastructure, a complex task. Even after all this work, fixing mixed content issues may require changes in middleware or content management software that can’t be easily updated. Later this week, we’ll introduce Automatic HTTPS Rewrites, which helps fix mixed content for many sites, but not all. Some mixed content can’t be fixed because the included third party resources (such as ads) that are not available over HTTPS. Websites that can’t update fully to HTTPS will benefit most from Opportunistic Encryption.</p><p>With Opportunistic Encryption, supporting browsers can choose to access an HTTP site using HTTP/2 over an encrypted connection instead of HTTP/1.1 over plaintext (the default).</p><h2>Security Benefits</h2><p>It’s no secret that network operators have access to the data that travels through their equipment. This access can be used to modify data: ISPs have been caught injecting unwanted data (<a href=\"http://arstechnica.com/tech-policy/2013/04/how-a-banner-ad-for-hs-ok/\">such as advertisements</a> and <a href=\"http://www.theverge.com/2016/3/7/11173010/verizon-supercookie-fine-1-3-million-fcc\">tracking cookies</a>) into unencrypted requests. Countries <a href=\"https://en.wikipedia.org/wiki/Internet_censorship_in_India\">routinely filter content</a> by inspecting HTTP headers in unencrypted traffic, and <a href=\"https://citizenlab.org/2015/04/chinas-great-cannon/\">China’s Great Cannon</a> injected malicious code into unencrypted websites. Access to data in transit can also be used to perform dragnet surveillance, where vast swaths of data is collected and then <a href=\"https://www.theguardian.com/commentisfree/2013/jul/15/crux-nsa-collect-it-all\">shipped to a central location for analysis</a>.</p><p>Opportunistic Encryption does not fully protect against attackers who can simply remove the header that signals support for Opportunistic Encryption to the browser. However, once an opportunistically encrypted connection is established all requests sent over the connection are encrypted and cannot be read (or modified) by prying eyes.</p><h2>Terminology is hard</h2><p>Tim Berners-Lee initiated the development of HTTP in the late 1980s to facilitate the transfer of documents from servers to clients. Both websites and browsers were rudimentary compared to the today’s web ecosystem. The concept of web security was practically non-existent.</p><p>From <a href=\"https://www.w3.org/History/1989/proposal.html\">the original 1989 paper</a>:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2HwLp3ipQLBPQrABrqkM2/2ead9227cdf497376c87c957fb7a9de5/Screen-Shot-2016-09-21-at-16.47.03.png\" alt=\"\" class=\"kg-image\" width=\"671\" height=\"189\" loading=\"lazy\"/>\n            \n            </figure><p>As the use cases of the web expanded to include sensitive data transactions, some security was needed. Multiple encryption schemes were developed to help secure HTTP, including <a href=\"http://www.homeport.org/~adam/shttp.html\">S-HTTP</a> and the eventual winner, HTTPS.</p><p>Originally, the difference between HTTP and HTTPS was one of layering. In HTTP, messages were written to the network directly, and in HTTPS, a secure connection was established between the client and server using SSL (an encryption and authentication protocol), and standard HTTP messages were written to the encrypted connection. Browsers signaled HTTP websites with an open lock icon, whereas HTTPS websites received a closed lock. Later, SSL evolved into TLS, although people sometimes <a href=\"https://www.google.com/trends/explore?q=ssl,tls,https\">still refer to it as SSL</a>.</p><p>As websites became much more complex, embedded scripts and dynamic content became commonplace. Serving insecure content on a secure web page was identified as a risk and HTTPS started to take on a more nuanced meaning. Rather than just HTTP on an encrypted connection, HTTPS meant secure HTTP. For example, cookies became a popular way to store state in the client for managing web sessions. Cookies obtained over a secure connection were not allowed to be sent over insecure HTTP or modified by data obtained over HTTP. New privacy-sensitive features now require HTTPS (such as the <a href=\"https://developers.google.com/web/updates/2016/04/geolocation-on-secure-contexts-only\">Location API</a>). This distinction between HTTP and HTTPS has been further codified by the W3C, the standards body in charge of the web, in their <a href=\"https://w3c.github.io/webappsec-secure-contexts/\">Secure Contexts</a> document.</p><p>To break it down:</p><ul><li><p>HTTP is a protocol for transferring hypertext</p></li><li><p>TLS/SSL is a protocol for encrypted communication</p></li><li><p>HTTPS is a protocol for transferring secure hypertext</p></li></ul><p>HTTP</p><p>HTTPS</p><p>Unencrypted</p><p>✔️</p><p>❌</p><p>Encrypted with TLS</p><p>✔️</p><p>✔️</p><p>Opportunistic Encryption is the bottom left ✔️. While only HTTPS sites are treated as secure by the browser (as indicated by a green lock security indicator), encrypted HTTP is preferable to unencrypted HTTP.</p><h2>Browser support</h2><p>All versions of Firefox since Firefox 38 (May 2015) have supported Opportunistic Encryption in its original form (without certificate validation). Firefox has recently added support for certificate validation in Firefox Nightly and will support it in an upcoming official release. We believe that Opportunistic Encryption is a meaningful advance in web security. We hope that other browsers follow Firefox’s lead and enable Opportunistic Encryption.</p><p>To be clear, Opportunistic Encryption is not a replacement for HTTPS. HTTPS should always be used when both strong encryption and authentication are required. For sites that don’t have the resources to fully move to HTTPS, Opportunistic Encryption can help, providing both added security and performance. Every bit counts.</p>",
		"id": "4H5mFEHNBeu1B8biX0q6UO",
		"localeList": {
			"name": "Opportunistic Encryption: Bringing HTTP/2 to the unencrypted web Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2016-09-21T16:51:28.000+01:00",
		"reading_time": 6,
		"slug": "opportunistic-encryption-bringing-http-2-to-the-unencrypted-web",
		"tags": [
			{
				"id": "6QktrXeEFcl4e2dZUTZVGl",
				"name": "Product News",
				"slug": "product-news"
			},
			{
				"id": "3lxBe7kJ3IDjqgqMaBU1QJ",
				"name": "HTTP2",
				"slug": "http2"
			},
			{
				"id": "5US4l4wdDysuDpZ4ktL3yP",
				"name": "HTTPS",
				"slug": "https"
			},
			{
				"id": "56vA0Z6hqev6QaJBQmO2J8",
				"name": "TLS",
				"slug": "tls"
			},
			{
				"id": "14zCAfc7F9ROKtNbSxs2Pe",
				"name": "TLS 1.3",
				"slug": "tls-1-3"
			},
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			},
			{
				"id": "5grQBv96AL5Ck0c8I54a0f",
				"name": "Crypto Week",
				"slug": "crypto-week"
			}
		],
		"title": "Opportunistic Encryption: Bringing HTTP/2 to the unencrypted web",
		"updated_at": "2024-08-27T02:33:22.630Z",
		"url": "https://blog.cloudflare.com/opportunistic-encryption-bringing-http-2-to-the-unencrypted-web"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}