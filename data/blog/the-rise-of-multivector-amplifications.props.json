{
	"initialReadingTime": "3",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Marek Majkowski",
				"slug": "marek-majkowski",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1JuU5qavgwVeqR8BAUrd6U/bd09672287e7cf04d4347d9a47607eb5/marek-majkowski.jpeg",
				"location": null,
				"website": null,
				"twitter": "@majek04",
				"facebook": null
			}
		],
		"excerpt": "It's been a while since we last wrote about Layer 3/4 DDoS attacks on this blog. This is a good news - we've been quietly handling the daily onslaught of DDoS attacks. Since our last write-up, a handful of interesting L3/4 attacks have happened. Let's review them.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/6RHVtyjcC2Y3odEDnepL0T/acbeed5ca030bd01bde6fba35b7fa14d/the-rise-of-multivector-amplifications.png",
		"featured": false,
		"html": "<p>It&#39;s been a while since we last wrote about <a href=\"/reflections-on-reflections/\">Layer 3/4 DDoS attacks on this blog</a>. This is a good news - we&#39;ve been quietly handling the daily onslaught of DDoS attacks. Since our last write-up, a handful of interesting L3/4 attacks have happened. Let&#39;s review them.</p><h2>Gigantic SYN</h2><p>In April, <a href=\"https://twitter.com/jgrahamc/status/983278388059058181\">John tweeted about a gigantic 942Gbps SYN flood</a>:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/zDV2Skl4GNNghhywbXthQ/a6e9a7f8c2c372e646540cdd6ab82774/DaVOetFVMAI9W8m.jpg-large.jpeg.jpeg\" alt=\"DaVOetFVMAI9W8m.jpg-large\" class=\"kg-image\" width=\"1688\" height=\"454\" loading=\"lazy\"/>\n            \n            </figure><p>It was a notable event for a couple of reasons.</p><p>First, it was really large. Previously, we&#39;ve seen only amplification / reflection attacks at terabit scale. In those cases, the attacker doesn&#39;t actually have too much capacity. They need to bounce the traffic off other servers to generate a substantial load. This is different from typical &quot;direct&quot; style attacks, like SYN floods. In the SYN flood mentioned by John, all 942Gbps were coming directly from attacker-controlled machines.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/6PuzvyIN5DUCEoYioR7Ey/c0ed78a0959e528d44fdd387497c7ff3/image2018-4-13_12-45-12.png\" alt=\"image2018-4-13_12-45-12\" class=\"kg-image\" width=\"2000\" height=\"733\" loading=\"lazy\"/>\n            \n            </figure><p>Secondly, this attack was truly distributed. Normal SYN floods come from a small number of geographical locations. This one, was all over the globe, hitting all Cloudflare data centers:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/5dVX774vMX9ALTOhJbOADy/c07b75986d960e32dce9aa14e117150d/ams-1.png\" alt=\"ams-1\" class=\"kg-image\" width=\"2000\" height=\"1016\" loading=\"lazy\"/>\n            \n            </figure><p>Thirdly, the attack seem to be partially spoofed. While our analysis was not conclusive, we saw random, spoofed source IP addresses in the largest internet exchanges. The above <a href=\"https://en.wikipedia.org/wiki/Hilbert_curve\">Hilbert curve</a> shows the source IP distribution in AMS-IX. As you can see we even saw the 127.0.0.0/8 block attacking us!</p><p>Lastly, it was a one-off. We have seen a couple of smaller SYN floods with similar characteristics before, but not after this event.</p><p>We believe the traffic was caused by <a href=\"https://en.wikipedia.org/wiki/Xor_DDoS\">Xor.DDoS malware</a>. Others have <a href=\"https://www.yumpu.com/en/document/view/54673736/the-linux-xor-ddos-botnets\">investigated this</a> botnet <a href=\"https://blogs.akamai.com/2015/09/xor-ddos-threat-advisory.html\">in the past</a>.</p><h2>SYN landscape</h2><p>Apart from the gigantic one-off SYN floods, we are, as usual, the target of more common SYN floods coming mainly from Asia. Here is a chart from two days some time ago:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2heaW03y367UPwXganSr85/6a1ae36e54700c34c6de752d598e8288/syn-2d.png\" alt=\"syn-2d\" class=\"kg-image\" width=\"1888\" height=\"550\" loading=\"lazy\"/>\n            \n            </figure><p>These kind of SYN floods, reaching 600-650 Gbps, we consider a normal part of operating in the internet.</p><p>Apart from SYN floods we regularly see amplification attacks. The specific techniques come into and go out of fashion. We&#39;re happy to report that both SSDP and memcached reflections seem to be on their way out.</p><h2>The fall of SSDP</h2><p>Last year we were worried about rising volumes of SSDP amplification attacks:</p><ul><li><p><a href=\"/ssdp-100gbps/\">Stupidly Simple DDoS Protocol (SSDP) generates 100 Gbps DDoS</a></p></li></ul><p>After that event, we saw much larger SSDP attacks, peaking at 400Gbps. But this was back in 2017 - this year we have rarely seen major SSDP spikes. Over the last 30 days we haven&#39;t seen one crossing 180Gbps (which is puny):</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/42uBBo1vBkQ7mYkBlLBw0n/789eb5fd84413ae2edc9ecde5e952b56/ssdp-30-days.png\" alt=\"ssdp-30-days\" class=\"kg-image\" width=\"2000\" height=\"485\" loading=\"lazy\"/>\n            \n            </figure><p>These attacks employ 60k-100k vulnerable IPs, which are mostly in Russia, China, the USA and Italy; here is per-country unique IP map:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/JN7Pnvpp34WV9zz3F2Aet/66a84424a92b1ab76bcb316b04dcb295/ssdp-30-days-ips-1.png\" alt=\"ssdp-30-days-ips-1\" class=\"kg-image\" width=\"2000\" height=\"693\" loading=\"lazy\"/>\n            \n            </figure><h2>The fall of memcached</h2><p>Similarly, in late February we blogged about memcached-based amplification attacks:</p><ul><li><p><a href=\"/memcrashed-major-amplification-attacks-from-port-11211/\">Memcrashed - Major amplification attacks from UDP port 11211</a></p></li></ul><p>Initially the attacks were scary, starting at 260Gbps when first reported, reaching a <a href=\"https://githubengineering.com/ddos-incident-report/\">terabit a day later</a>. But after the initial hype the attacks have weakened - the industry reacted rapidly and cleaned up the vulnerable servers. Nowadays, we don&#39;t see very large attacks of this type. Here is a chart for the last 30 days, with memcached reaching 80Gbps tops:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/4ypEYQgJt0L1ShN5t6b60e/fb9bc4656850460c5fc142e29fc461b1/memcached.png\" alt=\"memcached\" class=\"kg-image\" width=\"1972\" height=\"552\" loading=\"lazy\"/>\n            \n            </figure><h2>Multivector amplifications</h2><p>About two months ago, we started observing a new interesting trend. Instead of trying to do much damage using one amplification type - like SSDP or memcached, attackers started pooling them. We saw attacks employing many different amplification categories hitting us all at once.</p><p>The industry calls this &quot;multivector attacks&quot;, and while it&#39;s rather standard and has existed for years, we haven&#39;t seen it on this scale before. For example, here is one such an attack reaching a combined 800Gbps:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/AjwoeLkG5qwx1dRTbzFZG/0f6cf26b6bedc7431af9caf6a904d2e3/multivector-800.png\" alt=\"multivector-800\" class=\"kg-image\" width=\"1430\" height=\"566\" loading=\"lazy\"/>\n            \n            </figure><p>You can see all the different amplifications started and ended at the same time. The amplification types list is somewhat intriguing:</p><ul><li><p>port 53 and port 0 (fragmentation) - DNS at 130 Gbps</p></li><li><p>port 111 - Portmap at 337 Gbps</p></li><li><p>port 123 - NTP at 16 Gbps</p></li><li><p>port 137 - NetBIOS Name Service at 31 Gbps</p></li><li><p>port 161 - SNMP at 115 Gbps</p></li><li><p>port 389 - LDAP at 10 Gbps</p></li><li><p>port 1900 - SSDP at 177 Gbps</p></li></ul><p>We almost forgot about SNMP and Portmap amplifications - but there they are, together they compose a large part of the generated traffic.</p><h2>Summary</h2><p>It&#39;s important to keep a perspective on the Layer 3/Layer 4 attacks. About three years ago direct DNS attacks (like random prefix attacks) were a daily occurance. Attackers changed their techniques and today we don&#39;t see DNS spikes too often.</p><p>Two years ago, SYN floods were on the rise. Starting with about the Olympic Games in Rio in 2016, the frequency and volume decreased. For about a year after that, it was rather quiet. Recently major SYN floods started happening again and we are watching them carefully.</p><p>In the past we&#39;ve described SSDP and memcached amplifications as significant threats. They still happen, but seem to be decreasing. Recently, we noticed that &quot;multivector&quot; amplifications had become more common. This is a sign that the attackers need to pool the techniques in order to generate substantial traffic.</p><p>We are optimistic. By and large, the Internet seems less violent these days. Volumetric attacks still happen, but on a smaller scale than couple of years ago. But when they do happen they are huge.</p>",
		"id": "mSq7okRomOSsO82PsnwTy",
		"localeList": {
			"name": "The rise of multivector DDoS attacks Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2018-11-12T11:27:01.000+00:00",
		"slug": "the-rise-of-multivector-amplifications",
		"tags": [
			{
				"id": "6Mp7ouACN2rT3YjL1xaXJx",
				"name": "Security",
				"slug": "security"
			},
			{
				"id": "64g1G2mvZyb6PjJsisO09T",
				"name": "DDoS",
				"slug": "ddos"
			},
			{
				"id": "5kIxDMJCg3PXQxVINDL0Cw",
				"name": "Attacks",
				"slug": "attacks"
			},
			{
				"id": "48r7QV00gLMWOIcM1CSDRy",
				"name": "Speed & Reliability",
				"slug": "speed-and-reliability"
			}
		],
		"title": "The rise of multivector DDoS attacks",
		"updated_at": "2024-08-27T02:17:18.852Z",
		"url": "https://blog.cloudflare.com/the-rise-of-multivector-amplifications"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}