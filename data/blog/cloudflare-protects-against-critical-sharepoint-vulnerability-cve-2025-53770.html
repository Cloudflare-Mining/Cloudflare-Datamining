<div class="mb2 gray5">3 min read</div>
<div class="mt4">This post is also available in <a href="https://blog.cloudflare.com/zh-cn/cloudflare-protects-against-critical-sharepoint-vulnerability-cve-2025-53770">简体中文</a> and <a href="https://blog.cloudflare.com/ja-jp/cloudflare-protects-against-critical-sharepoint-vulnerability-cve-2025-53770">日本語</a>.</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/16ZJEkoe48R6L5ehGJtBB9/82323ac617d8ed244dac29221f39b7d3/image1.png" alt="">
<div class="post-content lh-copy gray1">
	<p>On July 19, 2025,<a href="https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770"> <u>Microsoft disclosed CVE-2025-53770</u></a>, a critical zero-day Remote Code Execution (RCE) vulnerability. Assigned a CVSS 3.1 base score of 9.8 (Critical), the vulnerability affects SharePoint Server 2016, 2019, and the Subscription Edition, along with unsupported 2010 and 2013 versions. Cloudflare’s WAF Managed Rules now includes 2 emergency releases that mitigate these vulnerabilities for WAF customers.</p>
	<div class="flex anchor relative">
		<h3 id="unpacking-cve-2025-53770">Unpacking CVE-2025-53770</h3>
		<a href="https://blog.cloudflare.com/#unpacking-cve-2025-53770" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>The vulnerability's root cause is <a href="https://nvd.nist.gov/vuln/detail/CVE-2025-53770"><u>improper deserialization of untrusted data</u></a>, which allows a remote, unauthenticated attacker to execute arbitrary code over the network without any user interaction. Moreover, what makes CVE-2025-53770 uniquely threatening is its methodology – the exploit chain, labeled "ToolShell." ToolShell is engineered <i>to play the long-game</i>: attackers are not only gaining temporary access, but also taking the server's cryptographic machine keys, specifically the <code>ValidationKey</code> and <code>DecryptionKey</code>. Possessing these keys allows threat actors to independently forge authentication tokens and <code>__VIEWSTATE</code> payloads, granting them persistent access that can survive standard mitigation strategies such as a server reboot or removing web shells.</p>
	<p>In response to the active nature of these attacks, the U.S. Cybersecurity and Infrastructure Security Agency (CISA) added CVE-2025-53770 to its<a href="https://www.cisa.gov/news-events/alerts/2025/07/20/cisa-adds-one-known-exploited-vulnerability-cve-2025-53770-toolshell-catalog"> <u>Known Exploited Vulnerabilities (KEV) catalog</u></a> with an emergency remediation deadline. The security community's consensus is clear: any organization with an on-premise SharePoint server on the Internet should assume it has been compromised and take immediate action to fully address this vulnerability.</p>
	<p>Since releasing our vulnerability patch in Cloudflare’s WAF Managed Ruleset, we’ve tracked the number of HTTP request matches for the vulnerability, which you can see in the graph below. Notably, we observed a significant peak around 11AM UTC, the morning of July 22, at around 300,000 hits at one point in time.&nbsp;</p>
	<figure class="kg-card kg-image-card">
		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1lIEI0Bq0Y9KKfejkUo2sB/3e0ae3f0ccfe0d4eec09ef837157323b/image2.png" alt="A graph showing the number of HTTP request matches, or “hits,” for the WAF Managed Rules that patch this vulnerability over the last 12 hours. The graph peaks at around 300,000 matches around 11AM UTC on July 22." class="kg-image" width="1999" height="992" loading="lazy">
	</figure>
	<div class="flex anchor relative">
		<h3 id="how-does-the-toolshell-exploit-chain-work">How does the ToolShell exploit chain work?</h3>
		<a href="https://blog.cloudflare.com/#how-does-the-toolshell-exploit-chain-work" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>The ToolShell exploit chain was first demonstrated at the <a href="https://www.zerodayinitiative.com/blog/2025/5/16/pwn2own-berlin-2025-day-two-results"><u>Pwn2Own hacking competition</u></a> in May 2025, where researchers chained an authentication bypass (CVE-2025-49706) with a deserialization RCE (CVE-2025-49704). Unfortunately, this was not the end of ToolShell’s lifespan. Threat actors evidently analyzed the patches to find weaknesses and exploit them in the wild, forcing Microsoft to assign new identifiers and call out CVE-2025-53771 for the authentication bypass. This rapid exploit → patch → bypass cycle shows that threat actors are not merely discovering vulnerabilities, but also systematically reverse-engineering <i>patches</i> to weaponize bypasses. For responders, this closes the window – or hides it altogether – to respond and put up defenses, highlighting the need for evolving, proactive security postures.</p>
	<p>The ToolShell exploit works in 3 stages:</p>
	<ol>
		<li>
			<p><b>Authentication Bypass, leveraging CVE-2025-53771</b>: The attack begins with a <code>POST</code> request sent to the <code>/_layouts/15/ToolPane.aspx</code> endpoint, a legacy component of SharePoint. The crutch of this authentication bypass happens by setting the <code>Referer</code> header to <code>/_layouts/SignOut.aspx</code>, which tricks the SharePoint server into trusting the attacker. With trust in hand, the attacker is able to skip authentication checks and move forward with authenticated access.</p>
		</li>
		<li>
			<p><b>Remote Code Execution via Deserialization, CVE-2025-53770: </b>With privileged access, the attacker can interact with the <code>ToolPane.aspx</code> endpoint. The attacker submits a malicious payload in the body of the <code>POST</code> request, triggering the core vulnerability: a deserialization flaw in which the SharePoint application deserializes the object into executable code on the server. At this point, the attacker can execute commands as they wish.</p>
		</li>
		<li>
			<p><b>The Long-Game: Possessing Cryptographic Keys:</b> Finally, to play the long-game and maintain continued access, the attacker will use a specific web shell to steal the server's cryptographic machine keys. By taking the <code>ValidationKey</code> and the <code>DecryptionKey</code>, the attacker obtains the state information used by SharePoint. Possessing these keys allows the attacker to operate independently, long after the original exploit; this means they can continue to execute new malicious payloads on the exploited server. This permanent backdoor makes this attack method uniquely dangerous.</p>
		</li>
	</ol>
	<div class="flex anchor relative">
		<h3 id="cloudflares-new-waf-managed-rules-for-cve-2025-53770-cve-2025-53771">Cloudflare’s new WAF Managed Rules for CVE-2025-53770, CVE-2025-53771&nbsp;</h3>
		<a href="https://blog.cloudflare.com/#cloudflares-new-waf-managed-rules-for-cve-2025-53770-cve-2025-53771" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>CVE-2025-53770 is a clear example of how modern cyber threats are two-sided, combining an initial breach vector with a mechanism for long-term persistence. This means that a successful defense will address both the immediate RCE vulnerability and the subsequent threat of unwelcome access.&nbsp;</p>
	<p>Once a <a href="https://github.com/soltanali0/CVE-2025-53770-Exploit/blob/main/exploit.py">public proof-of-concept</a> became available for this exploit, Cloudflare’s security analysts crafted and tested new patches, ensuring that they would address not only the initial attack, but also the longer-term threat. </p>
	<p>The team began researching the exploit the evening of July 20, and on July 21, 2025, Cloudflare deployed our emergency WAF Managed Rules to patch the vulnerability, meaning every customer using the Cloudflare Managed Ruleset will automatically be protected from this critical SharePoint vulnerability. These rules have been announced on the <a href="https://developers.cloudflare.com/waf/change-log/2025-07-21-emergency">WAF changelog</a> and will take effect immediately.</p>
</div>