<div class="post-content lh-copy gray1">
	<!--kg-card-begin: markdown-->
	<p><em><small>This post is also available in <a href="https://blog.cloudflare.com/zh-cn/api-gateway-zh-cn/">简体中文</a>, <a href="https://blog.cloudflare.com/zh-tw/api-gateway-zh-tw/">繁體中文</a>, <a href="https://blog.cloudflare.com/ja-jp/api-gateway-ja-jp/">日本語</a>, <a href="https://blog.cloudflare.com/ko-kr/api-gateway-ko-kr/">한국어</a>, <a href="https://blog.cloudflare.com/de-de/api-gateway-de-de/">Deutsch</a>, <a href="https://blog.cloudflare.com/fr-fr/api-gateway-fr-fr/">Français</a>, <a href="https://blog.cloudflare.com/es-es/api-gateway-es-es/">Español</a>, <a href="https://blog.cloudflare.com/it-it/api-gateway-it-it/">Italiano</a>.</small></em></p>
	<!--kg-card-end: markdown-->
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image5-4.png" class="kg-image" alt="Announcing the Cloudflare API Gateway"></figure>
	<p>Over the past decade, the Internet has experienced a tectonic shift. It used to be composed of static websites: with text, images, and the occasional embedded movie. But the Internet has grown enormously. We now rely on API-driven applications to help with almost every aspect of life. Rather than just download files, we are able to <em>engage</em> with apps by exchanging rich data. We track workouts and send the results to the cloud. We use smart locks and all kinds of IoT devices. And we interact with our friends online.</p>
	<p>This is all wonderful, but it comes with an explosion of complexity on the back end. Why? Developers need to manage APIs in order to support this functionality. They need to monitor and authenticate every single request. And because these tasks are so difficult, they’re usually outsourced to an API gateway provider.</p>
	<p>Unfortunately, today’s gateways leave a lot to be desired. First: they’re not cheap. Then there’s the performance impact. And finally, there’s a data and privacy risk, since <a href="https://blog.cloudflare.com/landscape-of-api-traffic/">more than 50% of traffic</a> reaches APIs (and is presumably sent through a third party gateway). What a mess.</p>
	<p>Today we’re announcing the Cloudflare API Gateway. <strong>We’re going to completely replace your existing gateway at a fraction of the cost.</strong> And our solution uses the technology behind <a href="https://workers.cloudflare.com/" target="_blank">Workers</a>, <a href="https://www.cloudflare.com/products/bot-management/" target="_blank">Bot Management</a>, <a href="https://www.cloudflare.com/products/zero-trust/access/" target="_blank">Access</a>, and <a href="https://developers.cloudflare.com/rules/transform/" target="_blank">Transform Rules</a> to provide the most advanced API toolset on the market.</p>
	<h2 id="what-is-api-gateway">What is API Gateway?</h2>
	<p>In short, it’s a package of features that will do everything for your APIs. We break it down into three categories:</p>
	<p><strong>Security</strong><br>These are the products we have already blogged about. Tools like <a href="https://developers.cloudflare.com/api-shield/products/api-discovery/" target="_blank">Discovery</a>, <a href="https://developers.cloudflare.com/api-shield/products/schema-validation/" target="_blank">Schema Validation</a>, <a href="https://developers.cloudflare.com/api-shield/products/volumetric-abuse-detection/" target="_blank">Abuse Detection</a>, and more. We’ve spent a lot of time applying our security expertise to the world of APIs.</p>
	<p><strong>Management &amp; Monitoring</strong><br>These are the foundational tools that keep your APIs in order. Some examples: analytics, routing, and authentication. We are already able to do these things with existing products like <a href="https://www.cloudflare.com/products/zero-trust/access/" target="_blank">Cloudflare Access</a>, and more features are on the way.</p>
	<p><strong>Everything Else</strong><br>These are the small (but crucial) items that keep everything running. Cloudflare already offers SSL/TLS termination, load balancing, and proxy services that can run by default.</p>
	<p>Today’s blog post describes each feature in detail. We’re excited to announce that <em>all </em>the security features are now generally available, so let’s start by discussing those.</p>
	<h2 id="discovery">Discovery</h2>
	<p>Our customers are eager to protect their APIs. Unfortunately, they don’t always have these endpoints documented—or worse, they <em>think</em> everything is documented, but have unknowingly lost or modified endpoints. These hidden endpoints are sometimes called <a href="https://www.bearer.com/resources/shadow-apis-detect-business-risk" target="_blank">shadow APIs</a>. We need to begin our journey with an exhaustive (and accurate) picture of API surface area.</p>
	<p>That’s where Discovery comes in. Head to the <a href="https://dash.cloudflare.com/?to=/:account/:zone/security/api-shield" target="_blank">Cloudflare dashboard</a>, select the <strong>Security</strong> tab, then choose “API Shield.” Activate the feature and tell us how you want to identify your API traffic. Most users provide a header (available today), but we can also use the request body or cookie (available soon).</p>
	<figure class="kg-card kg-image-card kg-width-wide"><img src="https://blog.cloudflare.com/content/images/2022/03/image7.jpg" class="kg-image" alt="The Cloudflare API Shield tab, showing various endpoints that have been discovered and a set of recommended rate limiting thresholds."></figure>
	<p>We provide an exhaustive list of your API endpoints. Cloudflare lists each method, path, and additional metadata to help you understand your surface area. We even <em>collapse</em> endpoints that include variables (e.g., <em>/account/<strong>217</strong></em>) to become generally applicable (e.g., <em>/account/<strong>{var1}</strong></em>).</p>
	<p>Discovery is a powerful countermeasure to entropy. Our customers often expect to find 30 endpoints, but are surprised to learn they have over <em>100</em> active endpoints.</p>
	<h2 id="schema-validation">Schema Validation</h2>
	<p>Perhaps you already have a schema for your API endpoints. A schema is like a template: it provides the paths, methods, and additional data you expect API requests to include. Many developers follow the <a href="https://swagger.io/specification/" target="_blank">OpenAPI standard</a> to generate (and maintain) a schema.</p>
	<p>To harden your security, we can <em>validate</em> incoming traffic against this schema. This is a great way to stop basic attacks. Cloudflare will turn away nonconforming requests, discarding nonsense traffic that ignored the dress code. Simply upload your schema to the dashboard, select the actions you want to take, and deploy:</p>
	<figure class="kg-card kg-image-card kg-width-wide"><img src="https://blog.cloudflare.com/content/images/2022/03/image9.jpg" class="kg-image" alt="A step in the schema upload process, after a schema has already been provided. Cloudflare lists out each endpoint with path, query, header, cookies, and body provided as metadata."></figure>
	<p>Schema Validation has already vetted traffic for some of the world’s largest crypto sites, delivery services, and payment platforms. It’s available now, and we’ll add body validation soon.</p>
	<h2 id="abuse-detection">Abuse Detection</h2>
	<p>A robust security approach will use Schema Validation <em>and</em> Discovery in tandem, ensuring traffic matches the expected format. But what about abusive traffic that makes it through?</p>
	<p>As Cloudflare discovers new API endpoints, we actually <em>suggest rate limits</em> for each one. That’s the role of Abuse Detection, and it opens the door to a more sophisticated kind of security.</p>
	<p>Consider an API endpoint that returns weather updates. Specifically, the endpoint will return “yes” if it is likely to snow in the next hour, and “no” otherwise. Our algorithm might detect that the average user requests this data once every 10 minutes. A small group of scrapers, however, makes 37 requests per 10 minutes. Cloudflare automatically recommends a threshold in between, weighted to provide normal users with some breathing room. This would prevent abusive scraping services from fetching the weather too often.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image3-18.png" class="kg-image"></figure>
	<p>We provide the option to create a rule using our new <a href="https://blog.cloudflare.com/advanced-rate-limiting/">Advanced Rate Limiting</a> engine. You can use cookies, headers, and more to tune thresholds. We’ve been using Abuse Detection to protect <a href="https://api.cloudflare.com/" target="_blank">api.cloudflare.com</a> for months now.</p>
	<p>Our favorite part of this feature: it relies on the machine learning approach we use for <a href="https://www.cloudflare.com/products/bot-management/" target="_blank">Bot Management</a>. Just another way our products can feed into (and benefit from) each other.</p>
	<p>Abuse Detection is available now. If you’re interested in <em>Sequential</em> Abuse Detection, which we use to flag anomalous request flows, check out our <a href="https://blog.cloudflare.com/api-abuse-detection/">previous blog post</a>. The sequential piece is in early access, and we’re continuing to tune it before an official launch.</p>
	<h2 id="mtls">mTLS</h2>
	<p>Mutual TLS takes security to a new level. You can use certificates to validate incoming traffic as it reaches your APIs—which is especially useful for mobile and IoT devices. Moreover, this is an excellent positive security model that can (and should) be adopted for most device ecosystems.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image1-48.png" class="kg-image"></figure>
	<p>As an example, let’s return to our weather API. Perhaps this service includes a second endpoint that <em>receives</em> the current temperature from a thermometer. But there’s a problem: anyone can make fake requests, providing inaccurate readings to the endpoint. To prevent this, use mTLS to install a client certificate on the <em>legitimate</em> thermometer, then let Cloudflare validate that certificate. Any other requests will be turned away. Problem solved!</p>
	<p>We already offer a set of free certificates to every Cloudflare customer. That will continue. But starting today, API Gateway customers get <em>unlimited</em> certificates by default.</p>
	<h2 id="authentication">Authentication</h2>
	<p>Many modern APIs require authentication. In fact, authentication unlocks all sorts of capabilities—it allows sessions (with login), personal data exchange, and infrastructure efficiency. And of course, Cloudflare protects authenticated traffic as it passes through our network.</p>
	<p>But with API Gateway, Cloudflare plays a more active role in authenticating traffic, helping to <strong>issue</strong> and <strong>validate</strong> the following:</p>
	<ul>
		<li>API keys</li>
		<li>JSON web tokens (JWT)</li>
		<li>OAuth 2.0 tokens</li>
	</ul>
	<p>Using access control lists, we help you manage different user groups with varying permissions. And this matters—because your current provider is introducing tons of latency and unnecessary data exchange. If a request has to go somewhere <em>outside</em> the Cloudflare ecosystem, it’s traveling farther than it needs to:</p>
	<figure class="kg-card kg-image-card kg-width-wide"><img src="https://blog.cloudflare.com/content/images/2022/03/image2-39.png" class="kg-image" alt="Additional latency incurred by sending requests out of the Cloudflare network for authentication."></figure>
	<p>Cloudflare can authenticate on our global network and handle requests in a fraction of the time. This kind of technology is difficult to implement, but we felt it was too important to ignore. How did we build it so quickly? <a href="https://www.cloudflare.com/products/zero-trust/access/" target="_blank">Cloudflare Access</a>. We took our experience working with identity providers and, once again, ported it over to the world of APIs. Our gateway includes unlimited authentication and token exchange. These features will be available soon.</p>
	<h2 id="routing-management">Routing &amp; Management</h2>
	<p>Let’s talk briefly about <a href="https://www.cloudflare.com/learning/serverless/glossary/serverless-microservice/" target="_blank">microservices</a>. Modern applications are behemoths, so developers break them up into smaller chunks called “microservices.”</p>
	<p>Consider an application that helps you book a hotel room. It might use a microservice to fetch available dates, another to fetch prices, and still another to fetch room types. Perhaps a different team manages each microservice, but they all need to be available from a single public entry point:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image8.png" class="kg-image" alt="Various steps in an architecture that relies on microservices. A visitor makes a request to a hotel API, which is then routed towards available dates, prices, or room types."></figure>
	<p>That single entry point—traditionally managed by an API gateway—is responsible for <em>routing</em> each request to the right microservice. Many of our customers have been paying standalone services to do this for years. That’s no longer necessary. We’ve built on our <a href="https://blog.cloudflare.com/introducing-transform-rules-with-url-rewriting-at-the-edge/">Transform Rules</a> product to dynamically re-write and re-route at our edge. It’s easy to configure, fast to deploy, and natively built into API Gateway. Cloudflare can now be your API’s single point of entry.</p>
	<p>That’s just the tip of the iceberg. API Gateway can actually <em>replace</em> your microservices through an integration with our <a href="https://workers.cloudflare.com/" target="_blank">Workers</a> product. How? Consider writing a Worker that performs some action; perhaps return hotel prices, which are stored with <a href="https://blog.cloudflare.com/durable-objects-ga/">Durable Objects</a> on our network. With API Gateway, requests arrive at our network, are routed to the correct microservice with Transform Rules, and then are fully served with Workers (still on our network!). These Workers may contact your origin for additional information, where necessary.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image4-3.png" class="kg-image" alt="Cloudflare’s simplified API architecture. With authentication, routing, management, and storage handled at the edge, several hops are eliminated."></figure>
	<p>Workers are faster, cheaper, and simpler than microservice alternatives. This integration will be available soon.</p>
	<h2 id="api-analytics">API Analytics</h2>
	<p>Customers tell us that <em>seeing</em> API traffic is sometimes more important than even acting on it. In fact, this trend isn’t specific to APIs. We published <a href="https://blog.cloudflare.com/envoy-media-machine-learning-bot-management/">another blog</a> today that explores how one customer uses our bot intelligence to passively log information about threats.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image6.png" class="kg-image"></figure>
	<p>With API Analytics, we’ve drawn on our other products to show useful data in real time. You can view popular endpoints, filter by ML-driven insights, see histograms of abuse thresholds, and capture trends.</p>
	<p>API Analytics will be available soon. When this happens, you’ll also be able to export custom reports and share insights within your organization.</p>
	<h2 id="logging-quota-management-and-more">Logging, Quota Management, and More</h2>
	<p><em>All</em> of our established features, like caching, load balancing, and log integrations work natively with API Gateway. These shouldn’t be overlooked as primitive gateway features; they’re essential. And because Cloudflare performs all of these functions in the same place, you get the latency benefits without having to do a thing.</p>
	<p>We are also expanding our Enterprise Logs functionality to perform real-time logging. If you choose to authenticate on Cloudflare’s network, you can view detailed logs of each user who has accessed an API. Similarly, we keep track of each request’s lifespan as it is received, validated, routed, and responded to. Everything is logged.</p>
	<p>Finally, we are building Quota Management, a feature that counts API requests over a longer period of time (like a month) and allows you to manage thresholds for your users. We’ve also launched <a href="https://blog.cloudflare.com/advanced-rate-limiting/">Advanced Rate Limiting</a> to help with more sophisticated cases (including body inspection for GraphQL).</p>
	<h2 id="conclusion">Conclusion</h2>
	<p>Our API security features—Discovery, Schema Validation, Abuse Detection, and mTLS—are available now! We call these features <a href="https://developers.cloudflare.com/api-shield/" target="_blank">API Shield</a> because they form the shield that protects the remaining gateway functions. Enterprise customers can ask their account teams for access today.</p>
	<p>Many of the other portions of API Gateway are now in early access. According to Gartner®, “by 2025, less than 50% of enterprise APIs will be managed, as explosive growth in APIs surpasses the capabilities of API management tools.” Our goal is to offer an affordable gateway that will fight this trend. If you have a specific feature you want to test, let your account team know, so we can onboard you as soon as possible.</p>
	<!--kg-card-begin: markdown-->
	<p><small>Source: Gartner, “Predicts 2022: APIs Demand Improved Security and Management”, Shameen Pillai, Jeremy D'Hoinne, John Santoro, Mark O'Neill, Sham Gill, 6 December 2021. GARTNER is a registered trademark and service mark of Gartner, Inc. and/or its affiliates in the U.S. and internationally and is used herein with permission. All rights reserved.</small></p>
	<!--kg-card-end: markdown-->
</div>