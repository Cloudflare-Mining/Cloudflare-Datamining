{
	"initialReadingTime": "2",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Joshua Nelson",
				"slug": "joshua",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/EhFlF4NI5ALIi5EzKYbkY/a1fb3ab0a09fae70276493967bc916b8/joshua.jpg",
				"location": null,
				"website": null,
				"twitter": null,
				"facebook": null
			},
			{
				"name": "Kabir Sikand",
				"slug": "kabir",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4jzKtdeKj1v1yq0mxargwO/980b0b0f1d721a4a354025082ffa4515/kabir.jpeg",
				"location": null,
				"website": null,
				"twitter": "@kabirsikand",
				"facebook": null
			}
		],
		"excerpt": "To help measure performance of our customers’ Workers, we’re beginning to integrate with the Chrome DevTools protocol.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4xrYauduot0GxbvLoHbVpF/236438c7dc964c7e787cd4e0cd2e3b3a/profiling-your-workers-with-wrangler.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/1u6Gbp3Mqf2z9LL76R0e7j/31564768c757800fe7e9f29ab698b3c8/image6-16.png\" alt=\"\" class=\"kg-image\" width=\"1943\" height=\"1000\" loading=\"lazy\"/>\n            \n            </figure><p>In the year since Cloudflare’s launch of Workers Unbound, developers have unlocked the ability to run computationally intensive workloads on the Cloudflare edge network — like image processing, game logic, and other complex algorithms. With all that additional computing power comes a host of questions around performance. Our customers often ask us how they can profile or monitor their Workers to see where they spend the most CPU time, or to see whether their changes improve performance.</p><p>Here at Cloudflare, we not only want to build the fastest, most affordable, and most flexible compute platform at the edge; we also want to make the lives of our developers easier in building their applications. To do this, Cloudflare has begun to integrate with existing tools — places our developers feel comfortable and efficient in their day-to-day work. To help measure performance of our customers’ Workers, we’re beginning to integrate with the Chrome DevTools protocol. Just like you can use chrome://inspect to debug your Node backend, you can also use it to profile your Cloudflare Workers.</p><h3>Introducing Chrome DevTools Integration (Beta)</h3><p>We’re starting off this integration with beta support for local CPU profiling, using Wrangler. To show off how to use this feature, I’m going to be optimizing a simple JavaScript program which outputs the first thousand integers separated by a space. Let’s start by installing the latest version of <a href=\"https://github.com/cloudflare/wrangler/#installation\">Wrangler</a>. We’ll also need a Worker cloned down to your local machine. I’ll be using <a href=\"https://github.com/kabirsikand/workers-profiling-example/blob/main/slow-worker.js\">Workers Profiling Example</a>, but feel free to use any CPU intensive Worker for this tutorial.</p><p>For reference, my sample code is below. You’ll notice this code is intentionally performing a computation that will slow down our Worker.</p>\n            <pre class=\"language-js\"><code class=\"language-js\">addEventListener(&quot;fetch&quot;, event =&gt; {\n  event.respondWith(handleRequest(event.request));\n});\n\nasync function handleRequest(request) {\n  let body = &#039;&#039;;\n  for (let i = 0; i &lt; 1000; ++i) {\n    body = body + &#039; &#039; + i;\n  }\n\n  return new Response(body, {\n    headers: { &#039;content-type&#039;: &#039;text/plain&#039; },\n  });\n}</pre></code>\n            <p>To confirm this, we’ll run Chrome DevTools and profile our Worker locally. In the directory of your sample project, <code>run wrangler dev --inspect</code>. To launch the DevTools, open <code>chrome://inspect</code> in Chrome or Chromium. You’ll see Chrome’s DevTools homepage pop up:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/79e6ioOYPp1SjNBLWEhLWK/62d62180db82ffea747f221ffae6c4e2/image1-22.png\" alt=\"Open up Chrome DevTools using chrome://inspect in your browser\" class=\"kg-image\" width=\"1872\" height=\"1016\" loading=\"lazy\"/>\n            \n            </figure><p>Click ‘Configure’ and add <code>localhost://9230</code> as one of the targets. You should see <code>wrangler[{Worker name}]</code> appear under “Remote Targets”, where {Worker name} is the name of your project.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/5i0wiIOb2mQG9ZPZseyEdk/1e73b7a9d72159f8797b47f970fbbee6/image2-27.png\" alt=\"Click ‘Configure’ and add localhost://9230 as a target\" class=\"kg-image\" width=\"1894\" height=\"1022\" loading=\"lazy\"/>\n            \n            </figure><p>Click ‘inspect’, then in the popup, ‘Profiler’.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2Kc0LIb3k3O1ldfl18jCBP/0b038da2b8bdba05844026e8a343221e/image4-21.png\" alt=\"Once in inspect mode, open up the Profiler\" class=\"kg-image\" width=\"1892\" height=\"984\" loading=\"lazy\"/>\n            \n            </figure><p>Click ‘Start’ and, in a different browser tab, make a few requests to your site, then click ‘Stop’. It should be available locally on localhost:8787.</p><p>Analyze the flame graph. For my Slow Worker, I see the following graph:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/4cA7Ng90JMS4Nt6LOOZI0p/a99aff2cc034022cafc74706cc8c2d45/image3-25.png\" alt=\"Flame graph generated from the recorded profile of our sample Worker\" class=\"kg-image\" width=\"1888\" height=\"404\" loading=\"lazy\"/>\n            \n            </figure><p>When I click on <code>handleRequest</code>, I see the following annotated source of my Worker:</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2rQDvm2MGfpBNwWgT7nobE/3fe410fd588dcaf2ca91a28fb41223cc/image5-19.png\" alt=\"Click on one of your functions to view the source code\" class=\"kg-image\" width=\"1884\" height=\"480\" loading=\"lazy\"/>\n            \n            </figure><p>In particular, it shows that, unsurprisingly, most of the time is being spent on memory allocations in the body of the loop. Note that the profiler is not always accurate with regard to exact timing, but does paint a picture of your largest bottlenecks.</p><h3>Understanding the Profile</h3><p>The profiler works by gathering a stack trace of your program at a sampled rate, so remember that the profile is an approximation of where your code tends to spend the majority of its execution time, and is not meant to be perfectly accurate. In fact, functions that execute in less than 100 microseconds have a chance to not appear in the profile at all.</p><h3>What’s Next?</h3><p>With the Workers platform, we’re striving to build in the observability our users expect out of a robust compute platform. We’d love to hear more from the community about ways we can improve visibility into the code you’re writing on the edge. If you haven’t already, please join the Cloudflare Workers Discord community at <a href=\"https://discord.gg/PX8s2TmJ7s\">https://discord.gg/PX8s2TmJ7s</a>. Happy building!</p><!--kg-card-begin: html--><div style=\"position: relative; padding-top: 56.25%;\"><iframe src=\"https://iframe.videodelivery.net/f11809a382160334e9be9a2aedf13d1d?preload=true\" style=\"border: none; position: absolute; top: 0; height: 100%; width: 100%;\"  allow=\"accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;\" allowfullscreen=\"true\"></iframe></div><!--kg-card-end: html-->",
		"id": "5qfyGhFsuFodg8NQiKq0BX",
		"localeList": {
			"name": "Profiling Your Workers with Wrangler Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "To help measure performance of our customers’ Workers, we’re beginning to integrate with the Chrome DevTools protocol.",
		"metadata": {
			"title": "Profiling Your Workers with Wrangler",
			"description": "To help measure performance of our customers’ Workers, we’re beginning to integrate with the Chrome DevTools protocol.",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/5tC8Tq2GyBdjQb74F9ed9g/4bdba8b4fcea8182505a5bcf8bfed81d/profiling-your-workers-with-wrangler-C5y2ek.png"
		},
		"primary_author": {},
		"published_at": "2021-09-18T13:59:17.000+01:00",
		"slug": "profiling-your-workers-with-wrangler",
		"tags": [
			{
				"id": "7a1NuQRjeZo9DhGt97wDwe",
				"name": "Speed Week",
				"slug": "speed-week"
			},
			{
				"id": "3CHhhmZIu8jnzcZ81VLRUQ",
				"name": "Wrangler",
				"slug": "wrangler"
			},
			{
				"id": "6hbkItfupogJP3aRDAq6v8",
				"name": "Cloudflare Workers",
				"slug": "workers"
			},
			{
				"id": "4HIPcb68qM0e26fIxyfzwQ",
				"name": "Developers",
				"slug": "developers"
			},
			{
				"id": "3JAY3z7p7An94s6ScuSQPf",
				"name": "Developer Platform",
				"slug": "developer-platform"
			}
		],
		"title": "Profiling Your Workers with Wrangler",
		"updated_at": "2024-08-27T01:45:13.206Z",
		"url": "https://blog.cloudflare.com/profiling-your-workers-with-wrangler"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}