{
	"initialReadingTime": "5",
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Kenny Johnson",
				"slug": "kenny",
				"bio": "Cloudflare Zero Trust PM\nAustin TX",
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4sLNWTlos4CkLxMZ9WzkKg/4cec366f9d9df7ca187d104e23b112f5/kenny.jpeg",
				"location": null,
				"website": null,
				"twitter": "@KennyJohnsonATX",
				"facebook": null
			}
		],
		"excerpt": "As a follow-up to the most recent Okta breach, we are making a HAR file sanitizer available to everyone, not just Cloudflare customers, at no cost.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/3TdJGvwWTHyyCrcIqeMZaq/83695530c5edb9253070c9dbb90f9816/introducing-har-sanitizer-secure-har-sharing.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/6SLumYs48sPRowoZrb0BCp/01e019efdbee7c688a20f9f106e4b79e/image2-8.png\" alt=\"Introducing HAR Sanitizer: secure HAR sharing\" class=\"kg-image\" width=\"1805\" height=\"1007\" loading=\"lazy\"/>\n            \n            </figure><p>On Wednesday, October 18th, 2023, Cloudflare’s Security Incident Response Team (SIRT) discovered an attack on our systems that originated from an <a href=\"/how-cloudflare-mitigated-yet-another-okta-compromise/\">authentication token stolen from one of Okta’s support systems</a>. No Cloudflare customer information or systems were impacted by the incident, thanks to the real-time detection and rapid action of our Security Incident Response Team (SIRT) in tandem with our <a href=\"https://www.cloudflare.com/learning/security/glossary/what-is-zero-trust/\">Zero Trust security posture</a> and use of hardware keys. With that said, we’d rather not repeat the experience — and so we have built a new security tool that can help organizations render this type of attack obsolete for good.</p><p>The bad actor in the Okta breach compromised user sessions by capturing session tokens from administrators at Cloudflare and other impacted organizations. They did this by infiltrating Okta’s customer support system and stealing one of the most common mechanisms for troubleshooting — an HTTP Response Archive (HAR) file.</p><p>HAR files contain a record of a user’s browser session, a kind of step-by-step audit, that a user can share with someone like a help desk agent to diagnose an issue. However, the file can also contain sensitive information that can be used to launch an attack.</p><p>As a follow-up to the Okta breach, we are making a <a href=\"http://har-sanitizer.pages.dev/\">HAR file sanitizer</a> available to everyone, not just Cloudflare customers, at no cost. We are publishing this tool under an <a href=\"https://github.com/cloudflare/har-sanitizer\">open source license</a> and are making it available to any support, engineering or security team. At Cloudflare, we are committed to making the Internet a better place and using HAR files without the threat of stolen sessions should be part of the future of the Internet.</p><h2>HAR Files - a look back in time</h2><p>Imagine being able to rewind time and revisit every single step a user took during a web session, scrutinizing each request and the responses the browser received.</p><p><a href=\"https://en.wikipedia.org/wiki/HAR_%28file_format%29\">HAR (HTTP Archive)</a> files are a JSON formatted archive file of a web browser’s interaction with a web application. HAR files provide a detailed snapshot of every request, including headers, cookies, and other types of data sent to a web server by the browser. This makes them an invaluable resource to troubleshoot web application issues especially for complex, layered web applications.</p><p>The snapshot that a HAR file captures can contain the following information:</p><p><b>Complete Request and Response Headers:</b> Every piece of data sent and received, including method types (GET, POST, etc.), status codes, URLs, cookies, and more.</p><p><b>Payload Content:</b> Details of what was actually exchanged between the client and server, which can be essential for diagnosing issues related to data submission or retrieval.</p><p><b>Timing Information:</b> Precise timing breakdowns of each phase – from DNS lookup, connection time, SSL handshake, to content download – giving insight into performance bottlenecks.</p><p>This information can be difficult to gather from an application’s logs due to the diverse nature of devices, browsers and networks used to access an application. A user would need to take dozens of manual steps. A HAR file gives them a one-click option to share diagnostic information with another party. The file is also standard, providing the developers, support teams, and administrators on the other side of the exchange with a consistent input to their own tooling. This minimizes the frustrating back-and-forth where teams try to recreate a user-reported problem, ensuring that everyone is, quite literally, on the same page.</p><h2>HAR files as an attack vector</h2><p>HAR files, while powerful, come with a cautionary note. Within the set of information they contain, session cookies make them a target for malicious actors.</p><h3>The Role of Session Cookies</h3><p>Before diving into the risks, it&#39;s crucial to understand the role of session cookies. A session cookie is sent from a server and stored on a user&#39;s browser to maintain stateful information across web sessions for that user. In simpler terms, it’s how the browser keeps you logged into an application for a period of time even if you close the page. Generally, these cookies live in local memory on a user’s browser and are not often shared. However, a HAR file is one of the most common ways that a session cookie could be inadvertently shared.</p><h3>Dangers of a stolen session cookie</h3><p>If a HAR file with a valid session cookie is shared, then there are a number of potential security threats that user, and company, may be exposed to:</p><p><b>Unauthorized Access:</b> The biggest risk is unauthorized access. If a HAR file with a session cookie lands in the wrong hands, it grants entry to the user’s account for that application. For platforms that store personal data or financial details, the consequences of such a breach can be catastrophic. Especially if the session cookie of a user with administrative or elevated permissions is stolen.</p><p><b>Session Hijacking:</b> Armed with a session cookie, attackers can impersonate legitimate users, a tactic known as session hijacking. This can lead to a range of malicious activities, from spreading misinformation to siphoning off funds.</p><p><b>Persistent Exposure:</b> Unlike other forms of data, a session cookie&#39;s exposure risk doesn&#39;t necessarily end when a user session does. Depending on the cookie&#39;s lifespan, malicious actors could gain prolonged access, repeatedly compromising a user&#39;s digital interactions.</p><p><b>Gateway to Further Attacks:</b> With access to a user&#39;s session, especially an administrator’s, attackers can probe for other vulnerabilities, exploit platform weaknesses, or jump to other applications.</p><h2>Mitigating the impact of a stolen HAR file</h2><p>Thankfully, there are ways to render a HAR file inert even if stolen by an attacker. One of the most effective methods is to “sanitize” a HAR file of any session related information before sharing it for debugging purposes.</p><p>The <a href=\"http://har-sanitizer.pages.dev/\">HAR sanitizer</a> we are introducing today allows a user to upload any HAR file, and the tool will strip out any session related cookies or JSON Web Tokens (JWT). The tool is built entirely on Cloudflare Workers, and all sanitization is done client-side which means Cloudflare never sees the full contents of the session token.</p>\n            <figure class=\"kg-card kg-image-card kg-width-wide\">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/50hGJi9BlyGNoT428LPEJL/afc2c85d3c06b73be7d342a9e2c246e3/image1-8.png\" alt=\"\" class=\"kg-image\" width=\"1623\" height=\"499\" loading=\"lazy\"/>\n            \n            </figure><h3>Just enough sanitization</h3><p>By default, the sanitizer will remove all session-related cookies and tokens — but there are some cases where these are essential for troubleshooting. For these scenarios, we are implementing a way to conditionally strip “just enough” data from the HAR file to render them safe, while still giving support teams the information they need.</p><p>The first product we’ve optimized the HAR sanitizer for is <a href=\"https://developers.cloudflare.com/cloudflare-one/policies/access/\">Cloudflare Access</a>. Access relies on a user’s <a href=\"https://developers.cloudflare.com/cloudflare-one/identity/authorization-cookie/application-token/\">JWT</a> — a compact token often used for secure authentication — to verify that a user should have access to the requested resource. This means a JWT plays a crucial role in troubleshooting issues with Cloudflare Access. We have tuned the HAR sanitizer to strip the cryptographic signature out of the Access JWT, rendering it inert, while still providing useful information for internal admins and Cloudflare support to debug issues.</p><p>Because HAR files can include a diverse array of data types, selectively sanitizing them is not a case of ‘one size fits all’. We will continue to expand support for other popular authentication tools to ensure we strip out “just enough” information.</p><h2>What’s next</h2><p>Over the coming months, we will launch additional security controls in Cloudflare Zero Trust to further mitigate attacks stemming from session tokens stolen from HAR files. This will include:</p><ul><li><p>Enhanced Data Loss Prevention (DLP) file type scanning to include HAR file and session token detections, to ensure users in your organization can not share unsanitized files.</p></li><li><p>Expanded API CASB scanning to detect HAR files with session tokens in collaboration tools like Zendesk, Jira, Drive and O365.</p></li><li><p>Automated HAR sanitization of data in popular collaboration tools.</p></li></ul><p>As always, we continue to expand our Cloudflare One Zero Trust suite to protect organizations of all sizes against an ever-evolving array of threats. Ready to get started? <a href=\"https://www.cloudflare.com/products/zero-trust/\">Sign up here</a> to begin using Cloudflare One at no cost for teams of up to 50 users.</p>",
		"id": "5Le8RmeoVTzjhB1qvPodhM",
		"localeList": {
			"name": "Introducing HAR Sanitizer: secure HAR sharing Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "As a follow-up to the most recent Okta breach, we are making a HAR file sanitizer available to everyone, not just Cloudflare customers, at no cost.",
		"metadata": {
			"title": "Introducing HAR Sanitizer: secure HAR sharing",
			"description": "As a follow-up to the most recent Okta breach, we are making a HAR file sanitizer available to everyone, not just Cloudflare customers, at no cost.",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/7Izkw21T7PAunMYdvmBQEA/3b095f44aeb1609b812c7011c14f5d3f/introducing-har-sanitizer-secure-har-sharing-G5Q7gd.png"
		},
		"primary_author": {},
		"published_at": "2023-10-26T14:20:05.000+01:00",
		"slug": "introducing-har-sanitizer-secure-har-sharing",
		"tags": [
			{
				"id": "1fCflWFtZIDnGI4cd3gRgx",
				"name": "Tools",
				"slug": "tools"
			},
			{
				"id": "3txfsA7N73yBL9g3VPBLL0",
				"name": "Open Source",
				"slug": "open-source"
			}
		],
		"title": "Introducing HAR Sanitizer: secure HAR sharing",
		"updated_at": "2024-08-27T01:03:12.101Z",
		"url": "https://blog.cloudflare.com/introducing-har-sanitizer-secure-har-sharing"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}