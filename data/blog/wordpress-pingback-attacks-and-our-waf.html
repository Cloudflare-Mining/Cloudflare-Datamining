<div class="mb2 gray5">2 min read</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5rQYY7vIqPpuutpXFxoyuZ/f4750bd79288e3ec51a797fd1d72bd5a/wordpress-pingback-attacks-and-our-waf.png" alt="">
<div class="post-content lh-copy gray1">
	<p>At CloudFlare a lot of our customers use WordPress, that's why we have our own <a href="http://wordpress.org/plugins/cloudflare">plugin</a>, we hang out at <a href="https://twitter.com/CloudFlare/status/424232493282107392">WordCamp</a> and we wrote a WordPress specific ruleset for our <a href="https://www.cloudflare.com/waf">Web Application Firewall</a>.</p>
	<p>WordPress' ubiquity on the web can make it an ideal target for <a href="https://en.wikipedia.org/wiki/OSI_model#Layer_7:_application_layer">Layer 7</a> attacks, and its powerful features as a blogging platform can be demanding on small web and database servers, meaning Layer 7 attacks can be effective in making a WordPress server go offline using a relatively low number of requests.</p>
	<p>Recently the folks at <a href="http://blog.sucuri.net/2014/03/more-than-162000-WordPress-sites-used-for-distributed-denial-of-service-attack.html">Sucuri</a> observed a large DDoS using WordPress' pingback mechanism. A <a href="https://en.wikipedia.org/wiki/Pingback">pingback</a> is a way of one website telling another that it has linked to their content. We’ve seen this attack in the past and already had WAF rules in place to block it.</p>
	<p>WordPress exposes an <a href="https://en.wikipedia.org/wiki/XML-RPC#PHP">XMLRPC</a> endpoint - xmlrpc.php - which other sites can make POST requests to in a standard format to inform a blog that their content has been linked to. The message it sends contains the blog link they referred to, and the page on which they placed that link.</p>
	<p>When WordPress receives a pingback, it makes a request back to the source page to check that the link is actually there. Attackers can use this mechanism to specify a genuine link on a WordPress site and an intended victim, which will trigger a HTTP request to the victim's site. You can think of this as a kind of HTTP Reflection attack, in that the attacker can send a relatively small request to an XMLRPC endpoint that supports pingbacks, and trigger a much larger amount of effort and response on the victim's server.</p>
	<p>Fortunately, our WordPress WAF rule WP0001 "WordPress Pingback Blocker" will immediately stop your WordPress blog from being used for this type of pingback abuse. If you run WordPress, you may want to consider enabling this today.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1tbprIqovu6zSt0IYPfzkv/1f373113a25886b9e4df8eca83ff2ed6/cloudflare_waf_wordpress_ruleset_1.png" alt="CloudFlare WAF rules for WordPress" class="kg-image" width="1122" height="827" loading="lazy">

	</figure>
	<p>You can find the “CloudFlare WordPress” ruleset under the CloudFlare Settings &gt; Security &gt; Manage WAF section, toggle the switch to turn the CloudFlare Wordpress ruleset on, and you’re all set.</p>
	<p>For an added sting in the tail, the attack Sucuri observed also used a mutating query string when specifying a URL on which they had placed a link. This bogus mutating URL will neutralise most caches and means a server has to expend the effort of producing a page from scratch over and over again. Fortunately we also have CloudFlare WordPress rule 100000 "WordPress Numbers Botnet" which will block this type of behaviour.</p>
	<p>So whether your blog is used to attack others or to be attacked itself, our WAF can help. For more information on our WAF <a href="https://www.cloudflare.com/waf">cloudflare.com/waf</a></p>
</div>