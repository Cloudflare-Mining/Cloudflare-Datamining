{
	"locale": "en-us",
	"localesAvailable": [
		"zh-cn",
		"ja-jp"
	],
	"post": {
		"authors": [
			{
				"name": "Kristian Freeman",
				"slug": "kristian",
				"bio": "Manager, Developer Advocacy team at Cloudflare. We help developers build amazing apps on Cloudflare, with tools like Workers, Pages, and more!",
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/3VUYoHwDSenpoOr2qQ5rQe/f6c20c05395cf1e49aa28d708c396a4e/kristian.jpg",
				"location": "Austin, TX",
				"website": "https://www.signalnerve.com",
				"twitter": "@kristianf_",
				"facebook": null
			}
		],
		"excerpt": "Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is Stripe. ",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/5eN4PbPb1cRLCGDVj71hGn/7d7f377923c19d6421f07abffc2c916f/announcing-stripe-support-in-workers.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/6Pnl0vB1GT7f3KcKLZCipU/8e9a6c8f345b42c07310c709981b25a6/image1-50.png\" alt=\"Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers\" class=\"kg-image\" width=\"1200\" height=\"675\" loading=\"lazy\"/>\n            \n            </figure><p>Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is <a href=\"https://stripe.com/\">Stripe</a>. Since my first encounter with Stripe about seven years ago, the service has evolved far beyond simple payment processing. In the <a href=\"/building-black-friday-e-commerce-experiences-with-jamstack-and-cloudflare-workers/\">e-commerce example application I shared last year</a>, Stripe managed a complete seller marketplace, using the <a href=\"https://stripe.com/connect\">Connect</a> product. Stripe&#39;s product suite is great for developers looking to go beyond accepting payments.</p><p>Earlier versions of Stripe&#39;s SDK had core Node.js dependencies, like many popular JavaScript packages. In Stripe’s case, it interacted directly with core Node.js libraries like <code>net/http</code>, to handle HTTP interactions. For Cloudflare Workers, a V8-based runtime, this meant that the official Stripe JS library didn’t work; you had to fall back to using Stripe’s (very well-documented) REST API. By doing so, you’d lose the benefits of using Stripe’s native JS library — things like automatic type-checking in your editor, and the simplicity of function calls like <code>stripe.customers.create()</code>, instead of manually constructed HTTP requests, to interact with Stripe’s various pieces of functionality.</p><p>In April, we wrote that we were <a href=\"/node-js-support-cloudflare-workers/\">focused on increasing</a> the number of JavaScript packages that are <a href=\"https://workers.cloudflare.com/works\">compatible with Workers</a>:</p><blockquote><p>We won’t stop until our users can import popular Node.js libraries seamlessly. This effort will be large-scale and ongoing for us, but we think it’s well worth it.</p></blockquote><p>I’m excited to announce general availability for the <a href=\"https://github.com/stripe/stripe-node\"><code>stripe</code></a> JS package for Cloudflare Workers. You can now use the native Stripe SDK directly in your projects! To get started, install <code>stripe</code> in your project: <code>npm i stripe</code>.</p><p>This also opens up a great opportunity for developers who have deployed sites to Cloudflare Pages to begin using Stripe right alongside their applications. With this week’s announcement of serverless function support in Cloudflare Pages, you can accept payments for your digital product, or handle subscriptions for your membership site, with a few lines of JavaScript added to your Pages project. There’s no additional configuration, and it scales automatically, just like your Pages site.</p><p>To showcase this, we’ve prepared an example open-source repository, showing how you can integrate <a href=\"https://stripe.com/payments/checkout\">Stripe Checkout</a> into your Pages application. There’s no additional configuration needed — as we announced yesterday, Pages’ new Workers Functions features allows you to deploy infinitely-scalable functions just by adding a new <code>functions</code> folder to your project. See it in action at <a href=\"https://stripe.pages.dev\">stripe.pages.dev</a>, or <a href=\"https://github.com/cloudflare/stripe.pages.dev\">check out the open-source repository on GitHub</a>.</p><p>With the SDK installed, you can begin accepting payments directly in your applications. The below example shows <a href=\"https://stripe.com/docs/payments/accept-a-payment?integration=checkout\">how to initiate a new Checkout session</a> and redirect to Stripe’s hosted checkout page:</p>\n            <pre class=\"language-js\"><code class=\"language-js\">import Stripe from &#039;stripe/lib/stripe.js&#039;;\n\n// use web crypto \nexport const webCrypto = Stripe.createSubtleCryptoProvider();\n\nexport function getStripe({env}){\n  if(!env?.STRIPE_KEY){\n    throw new Error(&#039;Can not initialize Stripe without STRIPE_KEY&#039;);\n  }\n  const client = Stripe(env.STRIPE_KEY, {\n      httpClient: Stripe.createFetchHttpClient(), // ensure we use a Fetch client, and not Node&#039;s `http`\n  });\n  return client;\n}\n\n\n\nexport default {\n  async fetch(request, env) {\n    const stripe = getStripe({ env })\n    const session = await stripe.checkout.sessions.create({\n      line_items: [{\n        price_data: {\n          currency: &#039;usd&#039;,\n          product_data: {\n            name: &#039;T-shirt&#039;,\n          },\n          unit_amount: 2000,\n        },\n        quantity: 1,\n      }],\n      payment_method_types: [\n        &#039;card&#039;,\n      ],\n      mode: &#039;payment&#039;,\n      success_url: `${YOUR_DOMAIN}/success.html`,\n      cancel_url: `${YOUR_DOMAIN}/cancel.html`,\n    });\n\n    return Response.redirect(session.url)\n  }\n}</pre></code>\n            <p>With support for the Stripe SDK natively in Cloudflare Workers, you aren’t just limited to payment processing either. Any JavaScript example that&#39;s currently in <a href=\"https://stripe.com/docs/api?lang=node\">Stripe’s extensive documentation</a> works directly in Workers, without needing to make any changes.</p><p>In particular, using Workers to handle the multitude of available Stripe webhooks means that you can get better visibility into how your existing projects are working, without needing to spin up any new infrastructure. The below example shows how you can securely validate incoming webhook requests to a Workers function, and perform business logic by parsing the data inside that webhook:</p>\n            <pre class=\"language-js\"><code class=\"language-js\">import Stripe from &#039;stripe/lib/stripe.js&#039;;\n\n// use web crypto \nexport const webCrypto = Stripe.createSubtleCryptoProvider();\n\nexport function getStripe({env}){\n  if(!env?.STRIPE_KEY){\n    throw new Error(&#039;Can not initialize Stripe without STRIPE_KEY&#039;);\n  }\n  const client = Stripe(env.STRIPE_KEY, {\n      httpClient: Stripe.createFetchHttpClient(), // ensure we use a Fetch client, and not Node&#039;s `http`\n  });\n  return client;\n}\n\nexport default {\n  async fetch(request, env) {\n    const stripe = getStripe({ env })\n    const body = await request.text()\n    const sig = request.headers.get(&#039;stripe-signature&#039;)\n    \nconst event = await stripe.webhooks.constructEventAsync(\n      body\n      sig,\n      env.STRIPE_ENDPOINT_SECRET,\n      undefined,\n      webCrypto\n    );\n\n\n    // Handle the event\n    switch (event.type) {\n      case &#039;payment_intent.succeeded&#039;:\n        const paymentIntent = event.data.object;\n        // Then define and call a method to handle the successful payment intent.\n        // handlePaymentIntentSucceeded(paymentIntent);\n        break;\n      case &#039;payment_method.attached&#039;:\n        const paymentMethod = event.data.object;\n        // Then define and call a method to handle the successful attachment of a PaymentMethod.\n        // handlePaymentMethodAttached(paymentMethod);\n        break;\n      // ... handle other event types\n      default:\n        console.log(`Unhandled event type ${event.type}`);\n    }\n\n    // Return a response to acknowledge receipt of the event\n    return new Response(JSON.stringify({ received: true }), {\n      headers: { &#039;Content-type&#039;: &#039;application/json&#039; }\n    })\n  }\n}\n</pre></code>\n            <p>We’re also announcing <a href=\"https://github.com/stripe-samples/stripe-node-cloudflare-worker-template\">a new Workers template</a> in partnership with Stripe. The template will help you get up and running with Stripe and Workers, using our best practices.</p><p>In less than five minutes, you can begin accepting payments for your next digital product or membership business. You can also handle and validate incoming webhooks at the edge, from a single codebase. This comes with no upfront cost, server provisioning, or any of the standard scaling headaches. Take your serverless functions, deploy them to Cloudflare’s edge, and start making money!</p><blockquote><p>“We&#39;re big fans of Cloudflare Workers over here at Stripe. Between the wild performance at the edge and fantastic serverless development experience, we&#39;re excited to see what novel ways you all use Stripe to make amazing apps.”— <b>Brian Holt, Stripe</b></p></blockquote><p>We’re thrilled with this incredible update to Stripe’s JavaScript SDK. We’re also excited to see what you’ll build with native Stripe support in Workers. Join our Discord server and share what you’ve built in the #what-i-built channel — <a href=\"https://cloudflare.community/\">get your invite here</a>.</p>",
		"id": "2jyffZ43SV9rphtVcGSHbM",
		"localeList": {
			"name": "Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers Config",
			"enUS": "English for Locale",
			"zhCN": "Translated for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "Translated for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is Stripe. ",
		"metadata": {
			"title": "Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers",
			"description": "Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is Stripe. ",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/WbcnhTX7HiS0eVSFU3VA3/7c2a1bb4508a0732983a05b9c085cf7f/announcing-stripe-support-in-workers-SMyg1o.png"
		},
		"primary_author": {},
		"published_at": "2021-11-19T13:59:58.000+00:00",
		"reading_time": 3,
		"slug": "announcing-stripe-support-in-workers",
		"tags": [
			{
				"id": "4Q1oXZOskZczYetWpWXIsl",
				"name": "Full Stack Week",
				"slug": "full-stack-week"
			},
			{
				"id": "6hbkItfupogJP3aRDAq6v8",
				"name": "Cloudflare Workers",
				"slug": "workers"
			},
			{
				"id": "78aSAeMjGNmCuetQ7B4OgU",
				"name": "JavaScript",
				"slug": "javascript"
			},
			{
				"id": "4HIPcb68qM0e26fIxyfzwQ",
				"name": "Developers",
				"slug": "developers"
			},
			{
				"id": "3JAY3z7p7An94s6ScuSQPf",
				"name": "Developer Platform",
				"slug": "developer-platform"
			}
		],
		"title": "Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers",
		"updated_at": "2024-08-27T01:40:38.664Z",
		"url": "https://blog.cloudflare.com/announcing-stripe-support-in-workers"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}