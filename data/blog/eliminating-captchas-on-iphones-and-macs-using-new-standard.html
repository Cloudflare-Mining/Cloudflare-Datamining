<div class="mb2 gray5">6 min read</div>
<div class="mt4">This post is also available in <a href="https://blog.cloudflare.com/zh-cn/eliminating-captchas-on-iphones-and-macs-using-new-standard">简体中文</a>, <a href="https://blog.cloudflare.com/es-es/eliminating-captchas-on-iphones-and-macs-using-new-standard">Español</a> and <a href="https://blog.cloudflare.com/ja-jp/eliminating-captchas-on-iphones-and-macs-using-new-standard">日本語</a>.</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/1MXprIYDqrhnoQhWnQ9V5x/f22d5208ee90cf8805620be5ae0c73ef/Private-Authentication-Token-open-source-standard-to-eliminate-CAPTCHAs.png" alt="" class="kg-image" width="1600" height="900" loading="lazy">

	</figure>
	<p>Today we’re announcing Private Access Tokens, a completely invisible, private way to validate that real users are visiting your site. Visitors using operating systems that support these tokens, including <a href="https://developer.apple.com/wwdc22/10077">the upcoming versions of macOS or iOS</a>, can now prove they’re human without completing a CAPTCHA or giving up personal data. This will eliminate nearly 100% of CAPTCHAs served to these users.</p>
	<p>What does this mean for you?</p>
	<p>If you’re an Internet user:</p>
	<ul>
		<li>
			<p>We’re making your mobile web experience more pleasant and more private than other networks at the same time.</p>
		</li>
		<li>
			<p>You won’t see a CAPTCHA on a supported iOS or Mac device (other devices coming soon!) accessing the Cloudflare network.</p>
		</li>
	</ul>
	<p>If you’re a web or application developer:</p>
	<ul>
		<li>
			<p>Know your user is coming from an authentic device and signed application, verified by the device vendor directly.</p>
		</li>
		<li>
			<p>Validate users without maintaining a cumbersome SDK.</p>
		</li>
	</ul>
	<p>If you’re a Cloudflare customer:</p>
	<ul>
		<li>
			<p>You don’t have to do anything! &nbsp;Cloudflare will automatically ask for and utilize Private Access Tokens</p>
		</li>
		<li>
			<p>Your visitors won’t see a CAPTCHA, and we’ll ask for less data from their devices.</p>
		</li>
	</ul>
	<div class="flex anchor relative">
		<h3 id="introducing-private-access-tokens">Introducing Private Access Tokens</h3>
		<a href="https://blog.cloudflare.com/#introducing-private-access-tokens" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Over the past year, Cloudflare has collaborated with Apple, Google, and other industry leaders to extend the <a href="https://www.ietf.org/archive/id/draft-ietf-privacypass-auth-scheme-01.html">Privacy Pass protocol</a> with support for a new cryptographic token. These tokens simplify application security for developers and security teams, and obsolete legacy, third-party SDK based approaches to determining if a human is using a device. They work for browsers, APIs called by browsers, and APIs called within apps. We call these new tokens Private Access Tokens (PATs). This morning, <a href="https://developer.apple.com/wwdc22/10077">Apple announced that PATs will be incorporated</a> into iOS 16, iPad 16, and macOS 13, and we expect additional vendors to announce support in the near future.</p>
	<p>Cloudflare has already incorporated PATs into our <a href="https://blog.cloudflare.com/end-cloudflare-captcha">Managed Challenge platform</a>, so any customer using this feature will automatically take advantage of this new technology to improve the browsing experience for supported devices.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/2t6bhh7vQcRRbOVZheNgPH/2f5d2f1dae1a2a7ae176fa3bc703ae6c/image2-4.png" alt="" class="kg-image" width="1277" height="627" loading="lazy">

	</figure>
	<div class="flex anchor relative">
		<h3 id="captchas-dont-work-in-mobile-environments-pats-remove-the-need-for-them">CAPTCHAs don’t work in mobile environments, PATs remove the need for them</h3>
		<a href="https://blog.cloudflare.com/#captchas-dont-work-in-mobile-environments-pats-remove-the-need-for-them" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>We’ve <a href="https://blog.cloudflare.com/end-cloudflare-captcha">written</a> <a href="https://blog.cloudflare.com/introducing-cryptographic-attestation-of-personhood">numerous</a> <a href="https://blog.cloudflare.com/moving-from-recaptcha-to-hcaptcha">times</a> about how CAPTCHAs are a terrible user experience. However, we haven’t discussed specifically how much worse the user experience is on a mobile device. CAPTCHA as a technology was built and optimized for a browser-based world. They are deployed via a widget or iframe that is generally one size fits all, leading to rendering issues, or the input window only being partially visible on a device. The smaller real estate on mobile screens inherently makes the technology less accessible and solving any CAPTCHA more difficult, and the need to render JavaScript and image files slows down image loads while consuming excess customer bandwidth.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/1nIPAH3gWctx5emjDD4Yp4/a9eff5f3c543c44b78ad62403e496f98/image5-2.png" alt="" class="kg-image" width="1800" height="1013" loading="lazy">

	</figure>
	<p>Usability aside, mobile environments present an additional challenge in that they are increasingly <a href="https://www.cloudflare.com/learning/security/api/what-is-an-api">API-driven</a>. CAPTCHAs simply cannot work in an API environment where JavaScript can’t be rendered, or a WebView can’t be called. So, mobile app developers often have no easy option for challenging a user when necessary. They sometimes resort to using a clunky SDK to embed a CAPTCHA directly into an app. This requires work to embed and customize the CAPTCHA, continued maintenance and monitoring, and results in higher abandonment rates. For these reasons, when our customers choose to show a CAPTCHA today, it's only shown on mobile 20% of the time.</p>
	<p>We recently posted about how we used our Managed Challenge platform to <a href="https://blog.cloudflare.com/end-cloudflare-captcha">reduce our CAPTCHA use by 91%</a>. But because the CAPTCHA experience is so much worse on mobile, we’ve been separately working on ways we can specifically reduce CAPTCHA use on mobile even further.</p>
	<div class="flex anchor relative">
		<h3 id="when-sites-cant-challenge-a-visitor-they-collect-more-data">When sites can’t challenge a visitor, they collect more data</h3>
		<a href="https://blog.cloudflare.com/#when-sites-cant-challenge-a-visitor-they-collect-more-data" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>So, you either can’t use CAPTCHA to protect an API, or the UX is too terrible to use on your mobile website. What options are left for confirming whether a visitor is real? A common one is to look at client-specific data, commonly known as fingerprinting.</p>
	<p>You could ask for device IMEI and security patch versions, look at screen sizes or fonts, check for the presence of APIs that indicate human behavior, like interactive touch screen events and compare those to expected outcomes for the stated client. However, all of this data collection is expensive and, ultimately, not respectful of the end user. As a company that deeply cares about privacy and helping make the Internet better, we want to use as little data as possible without compromising the security of the services we provide.</p>
	<p>Another alternative is to use system-level APIs that offer device validation checks. This includes <a href="https://developer.apple.com/documentation/devicecheck">DeviceCheck</a> on Apple platforms and <a href="https://developer.android.com/training/safetynet/attestation">SafetyNet</a> on Android. <a href="https://www.cloudflare.com/application-services">Application services</a> can use these client APIs with their own services to assert that the clients they’re communicating with are valid devices. However, adopting these APIs requires both application and server changes, and can be just as difficult to maintain as SDKs.</p>
	<div class="flex anchor relative">
		<h3 id="private-access-tokens-vastly-improve-privacy-by-validating-without-fingerprinting">Private Access Tokens vastly improve privacy by validating without fingerprinting</h3>
		<a href="https://blog.cloudflare.com/#private-access-tokens-vastly-improve-privacy-by-validating-without-fingerprinting" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>This is the most powerful aspect of PATs. By partnering with third parties like device manufacturers, who already have the data that would help us validate a device, we are able to abstract portions of the validation process, and confirm data <b><i>without actually collecting</i></b><i>, </i><b><i>touching, or storing that data ourselves</i></b>. Rather than interrogating a device directly, we ask the device vendor to do it for us.</p>
	<p>In a traditional website setup, using the most common CAPTCHA provider:</p>
	<ul>
		<li>
			<p>The website you visit knows the URL, your IP, and some additional user agent data.</p>
		</li>
		<li>
			<p>The CAPTCHA provider knows what website you visit, your IP, your device information, collects interaction data on the page, AND ties this data back to other sites where they have seen you. This builds a profile of your browsing activity across both sites and devices, plus how you personally interact with a page.</p>
		</li>
	</ul>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/2vnMi2aTbGheZegJ6jupiC/e05b9476de67de80d6459491c199bf11/Screen-Shot-2022-06-07-at-10.24.12-AM.png" alt="" class="kg-image" width="1822" height="802" loading="lazy">

	</figure>
	<p>When PATs are used, device data is isolated and explicitly NOT exchanged between the involved parties (the manufacturer and Cloudflare)</p>
	<ul>
		<li>
			<p>The website knows only your URL and IP, which it has to know to make a connection.</p>
		</li>
		<li>
			<p>The device manufacturer (attester) knows only the device data required to attest your device, but can't tell what website you visited, and doesn’t know your IP.</p>
		</li>
		<li>
			<p>Cloudflare knows the site you visited, but doesn’t know any of your device or interaction information.</p>
		</li>
	</ul>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/6vRC2wIaTHgP8zLJ8EJIO5/0a0713d2d922ccaaf0c3b87770e65b6b/image3-2.png" alt="" class="kg-image" width="1221" height="492" loading="lazy">

	</figure>
	<p>We don’t actually need or want the underlying data that’s being collected for this process, we just want to verify if a visitor is faking their device or user agent. Private Access Tokens allow us to capture that validation state directly, without needing any of the underlying data. They allow us to be more confident in the authenticity of important signals, without having to look at those signals directly ourselves.</p>
	<div class="flex anchor relative">
		<h3 id="how-private-access-tokens-compartmentalize-data">How Private Access Tokens compartmentalize data</h3>
		<a href="https://blog.cloudflare.com/#how-private-access-tokens-compartmentalize-data" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>With <a href="https://www.ietf.org/archive/id/draft-ietf-privacypass-auth-scheme-01.html#name-security-considerations">Private Access Tokens</a>, four parties agree to work in concert with a common framework to generate and exchange anonymous, unforgeable tokens. Without all four parties in the process, PATs won’t work.</p>
	<ol>
		<li>
			<p>An <b>Origin</b>. A website, application, or API that receives requests from a client. When a website receives a request to their origin, the origin must know to look for and request a token from the client making the request. For Cloudflare customers, Cloudflare acts as the origin (on behalf of customers) and handles the requesting and processing of tokens.</p>
		</li>
		<li>
			<p>A <b>Client</b>. Whatever tool the visitor is using to attempt to access the Origin. This will usually be a web browser or mobile application. In our example, let’s say the client is a <a href="https://developer.apple.com/wwdc22/10077">mobile Safari Browser</a>.</p>
		</li>
		<li>
			<p>An <b>Attester</b>. The Attester is who the client asks to prove something (i.e that a mobile device has a valid IMEI) before a token can be issued. In our example below, the Attester is Apple, the device vendor.</p>
		</li>
		<li>
			<p>An <b>Issuer</b>. The issuer is the only one in the process that actually generates, or issues, a token. The Attester makes an API call to whatever Issuer the Origin has chosen to trust, &nbsp;instructing the Issuer to produce a token. In our case, Cloudflare will also be the Issuer.</p>
		</li>
	</ol>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/4ho7MHd8tHAhHpStG8ItWQ/f4c83a87efb301d3e93bfbfd8c196d48/Screen-Shot-2022-06-07-at-2.01.38-PM.png" alt="" class="kg-image" width="1390" height="882" loading="lazy">

	</figure>
	<p>In the example above, a visitor opens the Safari browser on their iPhone and tries to visit example.com.</p>
	<ol>
		<li>
			<p>Since Example uses Cloudflare to host their Origin, Cloudflare will ask the browser for a token.</p>
		</li>
		<li>
			<p>Safari supports PATs, so it will make an API call to Apple’s Attester, asking them to attest.</p>
		</li>
		<li>
			<p>The Apple attester will check various device components, confirm they are valid, and then make an API call to the Cloudflare Issuer (since Cloudflare acting as an Origin chooses to use the Cloudflare Issuer).</p>
		</li>
		<li>
			<p>The Cloudflare Issuer generates a token, sends it to the browser, which in turn sends it to the origin.</p>
		</li>
		<li>
			<p>Cloudflare then receives the token, and uses it to determine that we don’t need to show this user a CAPTCHA.</p>
		</li>
	</ol>
	<p>This probably sounds a bit complicated, but the best part is that <b><i>the website took no action</i></b> in this process. Asking for a token, validation, token generation, passing, all takes place behind the scenes by third parties that are invisible to both the user and the website. By working together, Apple and Cloudflare have just made this request more secure, reduced the data passed back and forth, and prevented a user from having to see a CAPTCHA. And we’ve done it by both collecting and exchanging less user data than we would have in the past.</p>
	<div class="flex anchor relative">
		<h3 id="most-customers-wont-have-to-do-anything-to-utilize-private-access-tokens">Most customers won’t have to do anything to utilize Private Access Tokens</h3>
		<a href="https://blog.cloudflare.com/#most-customers-wont-have-to-do-anything-to-utilize-private-access-tokens" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>To take advantage of PATs, all you have to do is choose Managed Challenge rather than Legacy CAPTCHA as a response option in a Firewall rule. More than 65% of Cloudflare customers are already doing this. Our Managed Challenge platform will automatically ask every request for a token, and when the client is compatible with Private Access Tokens, we’ll receive one. Any of your visitors using an iOS or macOS device will automatically start seeing fewer CAPTCHAs once they’ve upgraded their OS.</p>
	<p>This is just step one for us. We are actively working to get other clients and device makers utilizing the PAT framework as well. Any time a new client begins utilizing the PAT framework, traffic coming to your site from that client will automatically start asking for tokens, and your visitors will automatically see fewer CAPTCHAs.</p>
	<p>We will be incorporating PATs into other security products very soon. Stay tuned for some announcements in the near future.</p>
</div>