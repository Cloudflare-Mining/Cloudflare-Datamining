{
	"initialReadingTime": "5",
	"locale": "en-us",
	"localesAvailable": [
		"zh-cn"
	],
	"post": {
		"authors": [
			{
				"name": "Omer Yoachimik",
				"slug": "omer",
				"bio": "Product Manager / Cloudflare's DDoS Protection Service",
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/6TXRnB1v4ZHGiL3nRlvRTZ/946efe152cca5f55320466c0d3208fc1/omer.png",
				"location": "London",
				"website": null,
				"twitter": "@OmerYoahimik",
				"facebook": null
			}
		],
		"excerpt": "On July 3, Cloudflare’s global DDoS protection system, Gatebot, automatically detected and mitigated a UDP-based DDoS attack that peaked at 654 Gbps. The attack was part of a ten-day multi-vector DDoS campaign targeting a Magic Transit customer and was mitigated without any human intervention.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/6SYhHA9eMPIJcEVqPmJYJX/ad4a142537073b4491d778d21b37f522/moobot-vs-gatebot-cloudflare-automatically-blocks-botnet-ddos-attack-topping-at-654-gbps.png",
		"featured": false,
		"html": "<p>On July 3, Cloudflare’s global DDoS protection system, <a href=\"/meet-gatebot-a-bot-that-allows-us-to-sleep/\">Gatebot</a>, automatically detected and mitigated a <a href=\"https://www.cloudflare.com/learning/ddos/udp-flood-ddos-attack/\">UDP-based DDoS attack</a> that peaked at 654 Gbps. The attack was part of a ten-day multi-vector DDoS campaign targeting a <a href=\"https://www.cloudflare.com/magic-transit/\">Magic Transit</a> customer and was mitigated without any human intervention. The DDoS campaign is believed to have been generated by Moobot, a <a href=\"/inside-mirai-the-infamous-iot-botnet-a-retrospective-analysis/\">Mirai</a>-based botnet. No downtime, service degradation, or false positives were reported by the customer.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/5tZOVVWcnoNircFk2dzvgB/d0ea73849c6243b147c5a30b1dd70935/image7-3.png\" alt=\"\" class=\"kg-image\" width=\"1926\" height=\"1122\" loading=\"lazy\"/>\n            \n            </figure><p><b>Moobot Targets 654 Gbps towards a Magic Transit Customer</b></p><p>Over those ten days, our systems automatically detected and mitigated over 5,000 DDoS attacks against this one customer, mainly UDP floods, SYN floods, ACK floods, and GRE floods. The largest DDoS attack was a UDP flood and lasted a mere 2 minutes. This attack targeted only one IP address but hit multiple ports. The attack originated from 18,705 unique IP addresses, each believed to be a Moobot-infected IoT device.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/1SBAfKZG8YJHkfEBJnZyHV/efa76419bb510dd766e1eb04e5dfb6de/image2-3.png\" alt=\"\" class=\"kg-image\" width=\"1999\" height=\"964\" loading=\"lazy\"/>\n            \n            </figure><p><b>Attack Distribution by Country - From 100 countries</b></p><p>The attack was observed in Cloudflare’s data centers in 100 countries around the world. Approximately 89% of the attack traffic originated from just 10 countries with the US leading at 41%, followed by South Korea and Japan in second place (12% each), and India in third (10%). What this likely means is that the malware has infected at least 18,705 devices in 100 countries around the world.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/4L3iXSkvCp4kDRwUkyjr3d/84e8cd8f3f07fda833e3d6652662c85b/image5-4.png\" alt=\"\" class=\"kg-image\" width=\"1281\" height=\"873\" loading=\"lazy\"/>\n            \n            </figure><p><b>Attack Distribution by Country - Top 10</b></p><h2>Moobot - Self Propagating Malware</h2><p>‘Moobot’ sounds like a cute name, but there’s nothing cute about it. According to <a href=\"https://blog.netlab.360.com/ddos-botnet-moobot-en/\">Netlab 360</a>, Moobot is the codename of a self-propagating Mirai-based <a href=\"https://www.cloudflare.com/learning/ddos/glossary/malware/\">malware</a> first discovered in 2019. It infects IoT (Internet of Things) devices using remotely exploitable vulnerabilities or weak default passwords. IoT is a term used to describe smart devices such as security hubs and cameras, smart TVs, smart speakers, smart lights, sensors, and even refrigerators that are connected to the Internet.</p><p>Once a device is infected by Moobot, control of the device is transferred to the operator of the command and control (C2) server, who can issue commands remotely such as attacking a target and locating additional vulnerable IoT devices to infect (self-propagation).</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/7YKDGZ9yqbvb1TuYFqqYM/9bb149ae40e01e090be438560cd0b5bb/image9.gif\" alt=\"\" class=\"kg-image\" width=\"1999\" height=\"1049\" loading=\"lazy\"/>\n            \n            </figure><p>Moobot is a Mirai-based botnet, and has <a href=\"/inside-mirai-the-infamous-iot-botnet-a-retrospective-analysis/\">similar capabilities (modules) as Mirai</a>:</p><ol><li><p><b>Self-propagation</b> - The self-propagation module is in charge of the botnet’s growth. After an IoT device is infected, it randomly scans the Internet for open telnet ports and reports back to the C2 server. Once the C2 server gains knowledge of open telnet ports around the world, it tries to leverage known vulnerabilities or brute force its way into the IoT devices with common or default credentials.</p></li></ol>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/7ve4CTJV9L3BAVMbNMfo0a/1cda48845ce7e92715c812c9d1eca888/image6-3.png\" alt=\"\" class=\"kg-image\" width=\"1255\" height=\"808\" loading=\"lazy\"/>\n            \n            </figure><p>Self-propagation</p><p>2. <b>Synchronized attacks</b> - The C2 server orchestrates a coordinated flood of packets or HTTP requests with the goal of creating a denial of service event for the target&#39;s website or service.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/43xBoL19Y8IoRYqMdCmGio/3855066dd1d67dbe4eaec1532b2f9b8b/image3-7.png\" alt=\"\" class=\"kg-image\" width=\"1256\" height=\"670\" loading=\"lazy\"/>\n            \n            </figure><p>Synchronized attacks</p><p>The botnet operator may use multiple C2 servers in various locations around the world in order to reduce the risk of exposure. Infected devices may be assigned to different C2 servers varying by region and module; one server for self-propagation and another for launching attacks. Thus if a C2 server is compromised and taken down by law enforcement authorities, only parts of the botnet are deactivated.</p><h2>Why this attack was not successful</h2><p>This is the second large scale attack in the past few months that we observed on Cloudflare&#39;s network. The previous one peaked at <a href=\"/mitigating-a-754-million-pps-ddos-attack-automatically/\">754M packets per second</a> and attempted to take down our routers with a high packet rate. Despite the high packet rate, the 754Mpps attack peaked at a <i>mere</i> 253 Gbps.</p><p>As opposed to the high packet rate attack, this attack was a high bit rate attack, peaking at 654 Gbps. Due to the high bit rates of this attack, it seems as though the attacker tried (and failed) to cause a denial of service event by saturating our Internet link capacity. So let’s explore why this attack was not successful.</p><h3>Avoiding link saturation &amp; keeping appliances running</h3><p>Cloudflare’s global <a href=\"https://www.cloudflare.com/network/\">network</a> capacity is over 42 Tbps and growing. Our network spans more than 200 cities in over 100 countries, including 17 cities in mainland China. It interconnects with over 8,800 networks globally, including major ISPs, cloud services, and enterprises. This level of interconnectivity along with the use of <a href=\"https://www.cloudflare.com/learning/cdn/glossary/anycast-network/\">Anycast</a> ensures that our network can easily absorb even the largest attacks.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/2kvrwYIA87fmnWCTKdl7Wi/df4c3aa85d6b3b8e5808a64e2bbb3e42/image4-7.png\" alt=\"\" class=\"kg-image\" width=\"1907\" height=\"1161\" loading=\"lazy\"/>\n            \n            </figure><p>The Cloudflare Network</p><p>After traffic arrives at an edge data center, it is then load-balanced efficiently using our own Layer 4 load-balancer that we built, <a href=\"/unimog-cloudflares-edge-load-balancer/\">Unimog</a>, which uses our appliances&#39; health and other metrics to load-balance traffic intelligently within a data center to avoid overwhelming any single server.</p><p>Besides the use of Anycast for inter-data center load balancing and Unimog for intra-data center load balancing, we also utilize various forms of traffic engineering in order to deal with sudden changes in traffic loads across our network. We utilize both automatic and manual traffic engineering methods that can be employed by our 24/7/365 Site Reliability Engineering (SRE) team.</p><p>These combined factors significantly reduce the likelihood of a denial of service event due to link saturation or appliances being overwhelmed -- and as seen in this attack, no link saturation occurred.</p><!--kg-card-begin: html--><h2 id=\"ddos-detect-mitigate\">Detecting & Mitigating DDoS attacks</h2><!--kg-card-end: html--><p>Once traffic arrives at our edge, it encounters our three software-defined <a href=\"https://www.cloudflare.com/ddos/\">DDoS protection</a> systems:</p><ol><li><p><a href=\"/meet-gatebot-a-bot-that-allows-us-to-sleep/\">Gatebot</a> - Cloudflare’s centralized DDoS protection systems for detecting and mitigating globally distributed volumetric DDoS attacks. Gatebot runs in our network’s core data center. It receives samples from every one of our edge data centers, analyzes them, and automatically sends mitigation instructions when attacks are detected. Gatebot is also synchronized to each of our customers’ web servers to identify its health and triggers mitigation accordingly.</p></li><li><p><a href=\"/rolling-with-the-punches-shifting-attack-tactics-dropping-packets-faster-cheaper-at-the-edge/\">dosd</a> (denial of service daemon) - Cloudflare’s decentralized DDoS protection systems. dosd runs autonomously in each server in every Cloudflare data center around the world, analyzing traffic and applying local mitigation rules when needed. Besides being able to detect and mitigate attacks at super-fast speeds, dosd significantly improves our network resilience by delegating the detection and mitigation capabilities to the edge.</p></li><li><p><a href=\"/announcing-flowtrackd/\">flowtrackd</a> (flow tracking daemon) - Cloudflare’s TCP state tracking machine for detecting and mitigating the most randomized and sophisticated TCP-based DDoS attacks in unidirectional routing topologies (such as the case for <a href=\"https://www.cloudflare.com/magic-transit/\">Magic Transit</a>). flowtrackd is able to identify the state of a TCP connection and then drops, challenges, or rate-limits packets that don’t belong to a legitimate connection.</p></li></ol>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/78iByRWxPrVk9LKN9jJede/e5d57c7fa43a6ffd25e5cff2b33a8176/image1-9.png\" alt=\"\" class=\"kg-image\" width=\"1999\" height=\"1197\" loading=\"lazy\"/>\n            \n            </figure><p>Cloudflare DDoS Protection Lifecycle</p><p>The three DDoS protection systems collect traffic samples in order to detect DDoS attacks. The types of traffic data that they sample include:</p><ol><li><p><b>Packet fields</b> such as the source IP, source port, destination IP, destination port, protocol, TCP flags, sequence number, options, and packet rate.</p></li><li><p><b>HTTP request metadata</b> such as HTTP headers, user agent, query-string, path, host, HTTP method, HTTP version, TLS cipher version, and request rate.</p></li><li><p><b>HTTP response metrics</b> such as error codes returned by customers’ origin servers and their rates.</p></li></ol><p>Our systems then crunch these sample data points together to form a real-time view of our network’s security posture and our customer’s origin server health. They look for attack patterns and traffic anomalies. When found, a mitigation rule with a dynamically crafted attack signature is generated in real-time. Rules are propagated to the most optimal place for cost-effective mitigation. For example, an L7 HTTP flood might be dropped at L4 to reduce the CPU consumption.</p><p>Rules that are generated by dosd and flowtrackd are propagated within a single data center for rapid mitigation. Gatebot’s rules are propagated to all of the edge data centers which then take priority over dosd’s rules for an even and optimal mitigation. Even if the attack is detected in a subset of edge data centers, Gatebot propagates the mitigation instructions to all of Cloudflare’s edge data centers -- effectively sharing the threat intelligence across our network as a form of proactive protection.</p><p>In the case of this attack, in each edge data center, dosd generated rules to mitigate the attack promptly. Then as Gatebot received and analyzed samples from the edge, it determined that this was a globally distributed attack. Gatebot propagated unified mitigation instructions to the edge, which prepared each and every one of our 200+ data centers to tackle the attack as the attack traffic may shift to a different data center due to Anycast or traffic engineering.</p><h3>No inflated bills</h3><p>DDoS attacks obviously pose the risk of an outage and service disruption. But there is another risk to consider -- the cost of mitigation. During these ten days, more than 65 Terabytes of attack traffic were generated by the botnet. However, as part of Cloudflare’s <a href=\"/unmetered-mitigation/\">unmetered DDoS protection</a> guarantee, Cloudflare mitigated and absorbed the attack traffic without billing the customer. The customer doesn&#39;t need to submit a retroactive credit request. Attack traffic is automatically excluded from our billing system. We eliminated the financial risk.</p>",
		"id": "4LiHZDtLcYX0cts6SvjaUj",
		"localeList": {
			"name": "Moobot vs. Gatebot: Cloudflare Automatically Blocks Botnet DDoS Attack Topping At 654 Gbps Config",
			"enUS": "English for Locale",
			"zhCN": "Translated for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "On July 3, Cloudflare’s global DDoS protection system, Gatebot, automatically detected and mitigated a UDP-based DDoS attack that peaked at 654 Gbps.",
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2020-09-16T12:00:00.000+01:00",
		"slug": "moobot-vs-gatebot-cloudflare-automatically-blocks-botnet-ddos-attack-topping-at-654-gbps",
		"tags": [
			{
				"id": "64g1G2mvZyb6PjJsisO09T",
				"name": "DDoS",
				"slug": "ddos"
			},
			{
				"id": "6p334JmCmVYR5iL5Mnohds",
				"name": "Mirai",
				"slug": "mirai"
			},
			{
				"id": "20aygsbIPHZLC5RP5yjrxL",
				"name": "Gatebot",
				"slug": "gatebot"
			},
			{
				"id": "7qTIAO0WLKVKPVrj8q1vpD",
				"name": "Magic Transit",
				"slug": "magic-transit"
			},
			{
				"id": "4l3WDYLk6bXCyaRc9pRzXa",
				"name": "Bots",
				"slug": "bots"
			},
			{
				"id": "5kIxDMJCg3PXQxVINDL0Cw",
				"name": "Attacks",
				"slug": "attacks"
			}
		],
		"title": "Moobot vs. Gatebot: Cloudflare Automatically Blocks Botnet DDoS Attack Topping At 654 Gbps",
		"updated_at": "2024-08-27T01:58:47.441Z",
		"url": "https://blog.cloudflare.com/moobot-vs-gatebot-cloudflare-automatically-blocks-botnet-ddos-attack-topping-at-654-gbps"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}