{
	"DELETE /accounts/{account_id}/pcaps/ownership/{ownership_id}": {
		"description": "Deletes buckets added to the packet captures API.",
		"operationId": "magic-pcap-collection-delete-buckets-for-full-packet-captures",
		"parameters": [
			{
				"in": "path",
				"name": "ownership_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			},
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"responses": {
			"204": {
				"description": "Delete buckets for full packet captures response"
			},
			"default": {
				"content": {
					"application/json": {}
				},
				"description": "Delete buckets for full packet captures response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "Delete buckets for full packet captures",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"GET /accounts/{account_id}/pcaps": {
		"description": "Lists all packet capture requests for an account.",
		"operationId": "magic-pcap-collection-list-packet-capture-requests",
		"parameters": [
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"responses": {
			"200": {
				"content": {
					"application/json": {
						"schema": {
							"allOf": [
								{
									"allOf": [
										{
											"properties": {
												"errors": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"messages": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"items": {},
															"type": "array"
														},
														{
															"type": "string"
														}
													]
												},
												"success": {
													"description": "Whether the API call was successful",
													"enum": [
														true
													],
													"example": true,
													"type": "boolean"
												}
											},
											"required": [
												"success",
												"errors",
												"messages",
												"result"
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"items": {},
													"nullable": true,
													"type": "array"
												},
												"result_info": {
													"properties": {
														"count": {
															"description": "Total number of results for the requested service",
															"example": 1,
															"type": "number"
														},
														"page": {
															"description": "Current page within paginated list of results",
															"example": 1,
															"type": "number"
														},
														"per_page": {
															"description": "Number of results per page of results",
															"example": 20,
															"type": "number"
														},
														"total_count": {
															"description": "Total results available without any search parameters",
															"example": 2000,
															"type": "number"
														}
													},
													"type": "object"
												}
											}
										}
									],
									"type": "object"
								},
								{
									"properties": {
										"result": {
											"items": {
												"anyOf": [
													{
														"properties": {
															"filter_v1": {
																"description": "The packet capture filter. When this field is empty, all packets are captured.",
																"properties": {
																	"destination_address": {
																		"description": "The destination IP address of the packet.",
																		"example": "1.2.3.4",
																		"type": "string",
																		"x-auditable": true
																	},
																	"destination_port": {
																		"description": "The destination port of the packet.",
																		"example": 80,
																		"type": "number",
																		"x-auditable": true
																	},
																	"protocol": {
																		"description": "The protocol number of the packet.",
																		"example": 6,
																		"type": "number",
																		"x-auditable": true
																	},
																	"source_address": {
																		"description": "The source IP address of the packet.",
																		"example": "1.2.3.4",
																		"type": "string",
																		"x-auditable": true
																	},
																	"source_port": {
																		"description": "The source port of the packet.",
																		"example": 123,
																		"type": "number",
																		"x-auditable": true
																	}
																},
																"type": "object"
															},
															"id": {
																"description": "The ID for the packet capture.",
																"example": "66802ca5668e47a2b82c2e6746e45037",
																"maxLength": 32,
																"minLength": 32,
																"type": "string",
																"x-auditable": true
															},
															"offset_time": {
																"description": "The RFC 3339 offset timestamp from which to query backwards for packets. Must be within the last 24h. When this field is empty, defaults to time of request.",
																"example": "2020-01-01T08:00:00Z",
																"format": "date-time",
																"type": "string",
																"x-auditable": true
															},
															"status": {
																"description": "The status of the packet capture request.",
																"enum": [
																	"unknown",
																	"success",
																	"pending",
																	"running",
																	"conversion_pending",
																	"conversion_running",
																	"complete",
																	"failed"
																],
																"example": "success",
																"type": "string"
															},
															"submitted": {
																"description": "The RFC 3339 timestamp when the packet capture was created.",
																"example": "2020-01-01T08:00:00Z",
																"type": "string"
															},
															"system": {
																"description": "The system used to collect packet captures.",
																"enum": [
																	"magic-transit"
																],
																"example": "magic-transit",
																"type": "string",
																"x-auditable": true
															},
															"time_limit": {
																"description": "The packet capture duration in seconds.",
																"example": 300,
																"maximum": 300,
																"minimum": 1,
																"type": "number",
																"x-auditable": true
															},
															"type": {
																"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																"enum": [
																	"simple",
																	"full"
																],
																"example": "simple",
																"type": "string",
																"x-auditable": true
															}
														},
														"type": "object"
													},
													{
														"properties": {
															"byte_limit": {
																"description": "The maximum number of bytes to capture. This field only applies to `full` packet captures.",
																"example": 500000,
																"maximum": 1000000000,
																"minimum": 1,
																"type": "number",
																"x-auditable": true
															},
															"colo_name": {
																"description": "The name of the data center used for the packet capture. This can be a specific colo (ord02) or a multi-colo name (ORD). This field only applies to `full` packet captures.",
																"example": "ord02",
																"type": "string",
																"x-auditable": true
															},
															"destination_conf": {
																"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
																"example": "s3://pcaps-bucket?region=us-east-1",
																"type": "string"
															},
															"error_message": {
																"description": "An error message that describes why the packet capture failed. This field only applies to `full` packet captures.",
																"example": "No packets matched the filter in the time limit given. Please modify the filter or try again.",
																"type": "string"
															},
															"filter_v1": {
																"description": "The packet capture filter. When this field is empty, all packets are captured.",
																"properties": {
																	"destination_address": {
																		"description": "The destination IP address of the packet.",
																		"example": "1.2.3.4",
																		"type": "string",
																		"x-auditable": true
																	},
																	"destination_port": {
																		"description": "The destination port of the packet.",
																		"example": 80,
																		"type": "number",
																		"x-auditable": true
																	},
																	"protocol": {
																		"description": "The protocol number of the packet.",
																		"example": 6,
																		"type": "number",
																		"x-auditable": true
																	},
																	"source_address": {
																		"description": "The source IP address of the packet.",
																		"example": "1.2.3.4",
																		"type": "string",
																		"x-auditable": true
																	},
																	"source_port": {
																		"description": "The source port of the packet.",
																		"example": 123,
																		"type": "number",
																		"x-auditable": true
																	}
																},
																"type": "object"
															},
															"id": {
																"description": "The ID for the packet capture.",
																"example": "66802ca5668e47a2b82c2e6746e45037",
																"maxLength": 32,
																"minLength": 32,
																"type": "string",
																"x-auditable": true
															},
															"packets_captured": {
																"description": "The number of packets captured.",
																"type": "integer"
															},
															"status": {
																"description": "The status of the packet capture request.",
																"enum": [
																	"unknown",
																	"success",
																	"pending",
																	"running",
																	"conversion_pending",
																	"conversion_running",
																	"complete",
																	"failed"
																],
																"example": "success",
																"type": "string"
															},
															"stop_requested": {
																"description": "The RFC 3339 timestamp when stopping the packet capture was requested. This field only applies to `full` packet captures.",
																"format": "date-time",
																"type": "string"
															},
															"submitted": {
																"description": "The RFC 3339 timestamp when the packet capture was created.",
																"example": "2020-01-01T08:00:00Z",
																"type": "string"
															},
															"system": {
																"description": "The system used to collect packet captures.",
																"enum": [
																	"magic-transit"
																],
																"example": "magic-transit",
																"type": "string",
																"x-auditable": true
															},
															"time_limit": {
																"description": "The packet capture duration in seconds.",
																"example": 86400,
																"maximum": 86400,
																"minimum": 1,
																"type": "number",
																"x-auditable": true
															},
															"type": {
																"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																"enum": [
																	"simple",
																	"full"
																],
																"example": "simple",
																"type": "string",
																"x-auditable": true
															}
														},
														"type": "object"
													}
												]
											},
											"type": "array"
										}
									}
								}
							]
						}
					}
				},
				"description": "List packet capture requests response"
			},
			"default": {
				"content": {
					"application/json": {
						"schema": {
							"oneOf": [
								{
									"allOf": [
										{
											"allOf": [
												{
													"properties": {
														"errors": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"messages": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"result": {
															"anyOf": [
																{
																	"type": "object"
																},
																{
																	"items": {},
																	"type": "array"
																},
																{
																	"type": "string"
																}
															]
														},
														"success": {
															"description": "Whether the API call was successful",
															"enum": [
																true
															],
															"example": true,
															"type": "boolean"
														}
													},
													"required": [
														"success",
														"errors",
														"messages",
														"result"
													],
													"type": "object"
												},
												{
													"properties": {
														"result": {
															"items": {},
															"nullable": true,
															"type": "array"
														},
														"result_info": {
															"properties": {
																"count": {
																	"description": "Total number of results for the requested service",
																	"example": 1,
																	"type": "number"
																},
																"page": {
																	"description": "Current page within paginated list of results",
																	"example": 1,
																	"type": "number"
																},
																"per_page": {
																	"description": "Number of results per page of results",
																	"example": 20,
																	"type": "number"
																},
																"total_count": {
																	"description": "Total results available without any search parameters",
																	"example": 2000,
																	"type": "number"
																}
															},
															"type": "object"
														}
													}
												}
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"items": {
														"anyOf": [
															{
																"properties": {
																	"filter_v1": {
																		"description": "The packet capture filter. When this field is empty, all packets are captured.",
																		"properties": {
																			"destination_address": {
																				"description": "The destination IP address of the packet.",
																				"example": "1.2.3.4",
																				"type": "string",
																				"x-auditable": true
																			},
																			"destination_port": {
																				"description": "The destination port of the packet.",
																				"example": 80,
																				"type": "number",
																				"x-auditable": true
																			},
																			"protocol": {
																				"description": "The protocol number of the packet.",
																				"example": 6,
																				"type": "number",
																				"x-auditable": true
																			},
																			"source_address": {
																				"description": "The source IP address of the packet.",
																				"example": "1.2.3.4",
																				"type": "string",
																				"x-auditable": true
																			},
																			"source_port": {
																				"description": "The source port of the packet.",
																				"example": 123,
																				"type": "number",
																				"x-auditable": true
																			}
																		},
																		"type": "object"
																	},
																	"id": {
																		"description": "The ID for the packet capture.",
																		"example": "66802ca5668e47a2b82c2e6746e45037",
																		"maxLength": 32,
																		"minLength": 32,
																		"type": "string",
																		"x-auditable": true
																	},
																	"offset_time": {
																		"description": "The RFC 3339 offset timestamp from which to query backwards for packets. Must be within the last 24h. When this field is empty, defaults to time of request.",
																		"example": "2020-01-01T08:00:00Z",
																		"format": "date-time",
																		"type": "string",
																		"x-auditable": true
																	},
																	"status": {
																		"description": "The status of the packet capture request.",
																		"enum": [
																			"unknown",
																			"success",
																			"pending",
																			"running",
																			"conversion_pending",
																			"conversion_running",
																			"complete",
																			"failed"
																		],
																		"example": "success",
																		"type": "string"
																	},
																	"submitted": {
																		"description": "The RFC 3339 timestamp when the packet capture was created.",
																		"example": "2020-01-01T08:00:00Z",
																		"type": "string"
																	},
																	"system": {
																		"description": "The system used to collect packet captures.",
																		"enum": [
																			"magic-transit"
																		],
																		"example": "magic-transit",
																		"type": "string",
																		"x-auditable": true
																	},
																	"time_limit": {
																		"description": "The packet capture duration in seconds.",
																		"example": 300,
																		"maximum": 300,
																		"minimum": 1,
																		"type": "number",
																		"x-auditable": true
																	},
																	"type": {
																		"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																		"enum": [
																			"simple",
																			"full"
																		],
																		"example": "simple",
																		"type": "string",
																		"x-auditable": true
																	}
																},
																"type": "object"
															},
															{
																"properties": {
																	"byte_limit": {
																		"description": "The maximum number of bytes to capture. This field only applies to `full` packet captures.",
																		"example": 500000,
																		"maximum": 1000000000,
																		"minimum": 1,
																		"type": "number",
																		"x-auditable": true
																	},
																	"colo_name": {
																		"description": "The name of the data center used for the packet capture. This can be a specific colo (ord02) or a multi-colo name (ORD). This field only applies to `full` packet captures.",
																		"example": "ord02",
																		"type": "string",
																		"x-auditable": true
																	},
																	"destination_conf": {
																		"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
																		"example": "s3://pcaps-bucket?region=us-east-1",
																		"type": "string"
																	},
																	"error_message": {
																		"description": "An error message that describes why the packet capture failed. This field only applies to `full` packet captures.",
																		"example": "No packets matched the filter in the time limit given. Please modify the filter or try again.",
																		"type": "string"
																	},
																	"filter_v1": {
																		"description": "The packet capture filter. When this field is empty, all packets are captured.",
																		"properties": {
																			"destination_address": {
																				"description": "The destination IP address of the packet.",
																				"example": "1.2.3.4",
																				"type": "string",
																				"x-auditable": true
																			},
																			"destination_port": {
																				"description": "The destination port of the packet.",
																				"example": 80,
																				"type": "number",
																				"x-auditable": true
																			},
																			"protocol": {
																				"description": "The protocol number of the packet.",
																				"example": 6,
																				"type": "number",
																				"x-auditable": true
																			},
																			"source_address": {
																				"description": "The source IP address of the packet.",
																				"example": "1.2.3.4",
																				"type": "string",
																				"x-auditable": true
																			},
																			"source_port": {
																				"description": "The source port of the packet.",
																				"example": 123,
																				"type": "number",
																				"x-auditable": true
																			}
																		},
																		"type": "object"
																	},
																	"id": {
																		"description": "The ID for the packet capture.",
																		"example": "66802ca5668e47a2b82c2e6746e45037",
																		"maxLength": 32,
																		"minLength": 32,
																		"type": "string",
																		"x-auditable": true
																	},
																	"packets_captured": {
																		"description": "The number of packets captured.",
																		"type": "integer"
																	},
																	"status": {
																		"description": "The status of the packet capture request.",
																		"enum": [
																			"unknown",
																			"success",
																			"pending",
																			"running",
																			"conversion_pending",
																			"conversion_running",
																			"complete",
																			"failed"
																		],
																		"example": "success",
																		"type": "string"
																	},
																	"stop_requested": {
																		"description": "The RFC 3339 timestamp when stopping the packet capture was requested. This field only applies to `full` packet captures.",
																		"format": "date-time",
																		"type": "string"
																	},
																	"submitted": {
																		"description": "The RFC 3339 timestamp when the packet capture was created.",
																		"example": "2020-01-01T08:00:00Z",
																		"type": "string"
																	},
																	"system": {
																		"description": "The system used to collect packet captures.",
																		"enum": [
																			"magic-transit"
																		],
																		"example": "magic-transit",
																		"type": "string",
																		"x-auditable": true
																	},
																	"time_limit": {
																		"description": "The packet capture duration in seconds.",
																		"example": 86400,
																		"maximum": 86400,
																		"minimum": 1,
																		"type": "number",
																		"x-auditable": true
																	},
																	"type": {
																		"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																		"enum": [
																			"simple",
																			"full"
																		],
																		"example": "simple",
																		"type": "string",
																		"x-auditable": true
																	}
																},
																"type": "object"
															}
														]
													},
													"type": "array"
												}
											}
										}
									]
								},
								{
									"properties": {
										"errors": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": [
												{
													"code": 7003,
													"message": "No route for the URI"
												}
											],
											"minLength": 1
										},
										"messages": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": []
										},
										"result": {
											"enum": [
												null
											],
											"nullable": true,
											"type": "object"
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												false
											],
											"example": false,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								}
							]
						}
					}
				},
				"description": "List packet capture requests response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "List packet capture requests",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API",
			"Magic Firewall Packet Captures - Read PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"GET /accounts/{account_id}/pcaps/{pcap_id}": {
		"description": "Get information for a PCAP request by id.",
		"operationId": "magic-pcap-collection-get-pcap-request",
		"parameters": [
			{
				"in": "path",
				"name": "pcap_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			},
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"responses": {
			"200": {
				"content": {
					"application/json": {
						"schema": {
							"allOf": [
								{
									"allOf": [
										{
											"properties": {
												"errors": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"messages": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"items": {},
															"type": "array"
														},
														{
															"type": "string"
														}
													]
												},
												"success": {
													"description": "Whether the API call was successful",
													"enum": [
														true
													],
													"example": true,
													"type": "boolean"
												}
											},
											"required": [
												"success",
												"errors",
												"messages",
												"result"
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"type": "string"
														}
													]
												}
											}
										}
									],
									"type": "object"
								},
								{
									"properties": {
										"result": {
											"anyOf": [
												{
													"properties": {
														"filter_v1": {
															"description": "The packet capture filter. When this field is empty, all packets are captured.",
															"properties": {
																"destination_address": {
																	"description": "The destination IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"destination_port": {
																	"description": "The destination port of the packet.",
																	"example": 80,
																	"type": "number",
																	"x-auditable": true
																},
																"protocol": {
																	"description": "The protocol number of the packet.",
																	"example": 6,
																	"type": "number",
																	"x-auditable": true
																},
																"source_address": {
																	"description": "The source IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"source_port": {
																	"description": "The source port of the packet.",
																	"example": 123,
																	"type": "number",
																	"x-auditable": true
																}
															},
															"type": "object"
														},
														"id": {
															"description": "The ID for the packet capture.",
															"example": "66802ca5668e47a2b82c2e6746e45037",
															"maxLength": 32,
															"minLength": 32,
															"type": "string",
															"x-auditable": true
														},
														"offset_time": {
															"description": "The RFC 3339 offset timestamp from which to query backwards for packets. Must be within the last 24h. When this field is empty, defaults to time of request.",
															"example": "2020-01-01T08:00:00Z",
															"format": "date-time",
															"type": "string",
															"x-auditable": true
														},
														"status": {
															"description": "The status of the packet capture request.",
															"enum": [
																"unknown",
																"success",
																"pending",
																"running",
																"conversion_pending",
																"conversion_running",
																"complete",
																"failed"
															],
															"example": "success",
															"type": "string"
														},
														"submitted": {
															"description": "The RFC 3339 timestamp when the packet capture was created.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														},
														"system": {
															"description": "The system used to collect packet captures.",
															"enum": [
																"magic-transit"
															],
															"example": "magic-transit",
															"type": "string",
															"x-auditable": true
														},
														"time_limit": {
															"description": "The packet capture duration in seconds.",
															"example": 300,
															"maximum": 300,
															"minimum": 1,
															"type": "number",
															"x-auditable": true
														},
														"type": {
															"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
															"enum": [
																"simple",
																"full"
															],
															"example": "simple",
															"type": "string",
															"x-auditable": true
														}
													},
													"type": "object"
												},
												{
													"properties": {
														"byte_limit": {
															"description": "The maximum number of bytes to capture. This field only applies to `full` packet captures.",
															"example": 500000,
															"maximum": 1000000000,
															"minimum": 1,
															"type": "number",
															"x-auditable": true
														},
														"colo_name": {
															"description": "The name of the data center used for the packet capture. This can be a specific colo (ord02) or a multi-colo name (ORD). This field only applies to `full` packet captures.",
															"example": "ord02",
															"type": "string",
															"x-auditable": true
														},
														"destination_conf": {
															"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
															"example": "s3://pcaps-bucket?region=us-east-1",
															"type": "string"
														},
														"error_message": {
															"description": "An error message that describes why the packet capture failed. This field only applies to `full` packet captures.",
															"example": "No packets matched the filter in the time limit given. Please modify the filter or try again.",
															"type": "string"
														},
														"filter_v1": {
															"description": "The packet capture filter. When this field is empty, all packets are captured.",
															"properties": {
																"destination_address": {
																	"description": "The destination IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"destination_port": {
																	"description": "The destination port of the packet.",
																	"example": 80,
																	"type": "number",
																	"x-auditable": true
																},
																"protocol": {
																	"description": "The protocol number of the packet.",
																	"example": 6,
																	"type": "number",
																	"x-auditable": true
																},
																"source_address": {
																	"description": "The source IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"source_port": {
																	"description": "The source port of the packet.",
																	"example": 123,
																	"type": "number",
																	"x-auditable": true
																}
															},
															"type": "object"
														},
														"id": {
															"description": "The ID for the packet capture.",
															"example": "66802ca5668e47a2b82c2e6746e45037",
															"maxLength": 32,
															"minLength": 32,
															"type": "string",
															"x-auditable": true
														},
														"packets_captured": {
															"description": "The number of packets captured.",
															"type": "integer"
														},
														"status": {
															"description": "The status of the packet capture request.",
															"enum": [
																"unknown",
																"success",
																"pending",
																"running",
																"conversion_pending",
																"conversion_running",
																"complete",
																"failed"
															],
															"example": "success",
															"type": "string"
														},
														"stop_requested": {
															"description": "The RFC 3339 timestamp when stopping the packet capture was requested. This field only applies to `full` packet captures.",
															"format": "date-time",
															"type": "string"
														},
														"submitted": {
															"description": "The RFC 3339 timestamp when the packet capture was created.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														},
														"system": {
															"description": "The system used to collect packet captures.",
															"enum": [
																"magic-transit"
															],
															"example": "magic-transit",
															"type": "string",
															"x-auditable": true
														},
														"time_limit": {
															"description": "The packet capture duration in seconds.",
															"example": 86400,
															"maximum": 86400,
															"minimum": 1,
															"type": "number",
															"x-auditable": true
														},
														"type": {
															"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
															"enum": [
																"simple",
																"full"
															],
															"example": "simple",
															"type": "string",
															"x-auditable": true
														}
													},
													"type": "object"
												}
											]
										}
									}
								}
							]
						}
					}
				},
				"description": "Get PCAP request response"
			},
			"default": {
				"content": {
					"application/json": {
						"schema": {
							"oneOf": [
								{
									"allOf": [
										{
											"allOf": [
												{
													"properties": {
														"errors": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"messages": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"result": {
															"anyOf": [
																{
																	"type": "object"
																},
																{
																	"items": {},
																	"type": "array"
																},
																{
																	"type": "string"
																}
															]
														},
														"success": {
															"description": "Whether the API call was successful",
															"enum": [
																true
															],
															"example": true,
															"type": "boolean"
														}
													},
													"required": [
														"success",
														"errors",
														"messages",
														"result"
													],
													"type": "object"
												},
												{
													"properties": {
														"result": {
															"anyOf": [
																{
																	"type": "object"
																},
																{
																	"type": "string"
																}
															]
														}
													}
												}
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"anyOf": [
														{
															"properties": {
																"filter_v1": {
																	"description": "The packet capture filter. When this field is empty, all packets are captured.",
																	"properties": {
																		"destination_address": {
																			"description": "The destination IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"destination_port": {
																			"description": "The destination port of the packet.",
																			"example": 80,
																			"type": "number",
																			"x-auditable": true
																		},
																		"protocol": {
																			"description": "The protocol number of the packet.",
																			"example": 6,
																			"type": "number",
																			"x-auditable": true
																		},
																		"source_address": {
																			"description": "The source IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"source_port": {
																			"description": "The source port of the packet.",
																			"example": 123,
																			"type": "number",
																			"x-auditable": true
																		}
																	},
																	"type": "object"
																},
																"id": {
																	"description": "The ID for the packet capture.",
																	"example": "66802ca5668e47a2b82c2e6746e45037",
																	"maxLength": 32,
																	"minLength": 32,
																	"type": "string",
																	"x-auditable": true
																},
																"offset_time": {
																	"description": "The RFC 3339 offset timestamp from which to query backwards for packets. Must be within the last 24h. When this field is empty, defaults to time of request.",
																	"example": "2020-01-01T08:00:00Z",
																	"format": "date-time",
																	"type": "string",
																	"x-auditable": true
																},
																"status": {
																	"description": "The status of the packet capture request.",
																	"enum": [
																		"unknown",
																		"success",
																		"pending",
																		"running",
																		"conversion_pending",
																		"conversion_running",
																		"complete",
																		"failed"
																	],
																	"example": "success",
																	"type": "string"
																},
																"submitted": {
																	"description": "The RFC 3339 timestamp when the packet capture was created.",
																	"example": "2020-01-01T08:00:00Z",
																	"type": "string"
																},
																"system": {
																	"description": "The system used to collect packet captures.",
																	"enum": [
																		"magic-transit"
																	],
																	"example": "magic-transit",
																	"type": "string",
																	"x-auditable": true
																},
																"time_limit": {
																	"description": "The packet capture duration in seconds.",
																	"example": 300,
																	"maximum": 300,
																	"minimum": 1,
																	"type": "number",
																	"x-auditable": true
																},
																"type": {
																	"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																	"enum": [
																		"simple",
																		"full"
																	],
																	"example": "simple",
																	"type": "string",
																	"x-auditable": true
																}
															},
															"type": "object"
														},
														{
															"properties": {
																"byte_limit": {
																	"description": "The maximum number of bytes to capture. This field only applies to `full` packet captures.",
																	"example": 500000,
																	"maximum": 1000000000,
																	"minimum": 1,
																	"type": "number",
																	"x-auditable": true
																},
																"colo_name": {
																	"description": "The name of the data center used for the packet capture. This can be a specific colo (ord02) or a multi-colo name (ORD). This field only applies to `full` packet captures.",
																	"example": "ord02",
																	"type": "string",
																	"x-auditable": true
																},
																"destination_conf": {
																	"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
																	"example": "s3://pcaps-bucket?region=us-east-1",
																	"type": "string"
																},
																"error_message": {
																	"description": "An error message that describes why the packet capture failed. This field only applies to `full` packet captures.",
																	"example": "No packets matched the filter in the time limit given. Please modify the filter or try again.",
																	"type": "string"
																},
																"filter_v1": {
																	"description": "The packet capture filter. When this field is empty, all packets are captured.",
																	"properties": {
																		"destination_address": {
																			"description": "The destination IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"destination_port": {
																			"description": "The destination port of the packet.",
																			"example": 80,
																			"type": "number",
																			"x-auditable": true
																		},
																		"protocol": {
																			"description": "The protocol number of the packet.",
																			"example": 6,
																			"type": "number",
																			"x-auditable": true
																		},
																		"source_address": {
																			"description": "The source IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"source_port": {
																			"description": "The source port of the packet.",
																			"example": 123,
																			"type": "number",
																			"x-auditable": true
																		}
																	},
																	"type": "object"
																},
																"id": {
																	"description": "The ID for the packet capture.",
																	"example": "66802ca5668e47a2b82c2e6746e45037",
																	"maxLength": 32,
																	"minLength": 32,
																	"type": "string",
																	"x-auditable": true
																},
																"packets_captured": {
																	"description": "The number of packets captured.",
																	"type": "integer"
																},
																"status": {
																	"description": "The status of the packet capture request.",
																	"enum": [
																		"unknown",
																		"success",
																		"pending",
																		"running",
																		"conversion_pending",
																		"conversion_running",
																		"complete",
																		"failed"
																	],
																	"example": "success",
																	"type": "string"
																},
																"stop_requested": {
																	"description": "The RFC 3339 timestamp when stopping the packet capture was requested. This field only applies to `full` packet captures.",
																	"format": "date-time",
																	"type": "string"
																},
																"submitted": {
																	"description": "The RFC 3339 timestamp when the packet capture was created.",
																	"example": "2020-01-01T08:00:00Z",
																	"type": "string"
																},
																"system": {
																	"description": "The system used to collect packet captures.",
																	"enum": [
																		"magic-transit"
																	],
																	"example": "magic-transit",
																	"type": "string",
																	"x-auditable": true
																},
																"time_limit": {
																	"description": "The packet capture duration in seconds.",
																	"example": 86400,
																	"maximum": 86400,
																	"minimum": 1,
																	"type": "number",
																	"x-auditable": true
																},
																"type": {
																	"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																	"enum": [
																		"simple",
																		"full"
																	],
																	"example": "simple",
																	"type": "string",
																	"x-auditable": true
																}
															},
															"type": "object"
														}
													]
												}
											}
										}
									]
								},
								{
									"properties": {
										"errors": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": [
												{
													"code": 7003,
													"message": "No route for the URI"
												}
											],
											"minLength": 1
										},
										"messages": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": []
										},
										"result": {
											"enum": [
												null
											],
											"nullable": true,
											"type": "object"
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												false
											],
											"example": false,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								}
							]
						}
					}
				},
				"description": "Get PCAP request response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "Get PCAP request",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API",
			"Magic Firewall Packet Captures - Read PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"GET /accounts/{account_id}/pcaps/{pcap_id}/download": {
		"description": "Download PCAP information into a file. Response is a binary PCAP file.",
		"operationId": "magic-pcap-collection-download-simple-pcap",
		"parameters": [
			{
				"in": "path",
				"name": "pcap_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			},
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"responses": {
			"200": {
				"content": {
					"application/vnd.tcpdump.pcap": {}
				},
				"description": "Download Simple PCAP response"
			},
			"default": {
				"content": {
					"application/json": {}
				},
				"description": "Download Simple PCAP response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "Download Simple PCAP",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API",
			"Magic Firewall Packet Captures - Read PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"GET /accounts/{account_id}/pcaps/ownership": {
		"description": "List all buckets configured for use with PCAPs API.",
		"operationId": "magic-pcap-collection-list-pca-ps-bucket-ownership",
		"parameters": [
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"responses": {
			"200": {
				"content": {
					"application/json": {
						"schema": {
							"allOf": [
								{
									"allOf": [
										{
											"properties": {
												"errors": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"messages": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"items": {},
															"type": "array"
														},
														{
															"type": "string"
														}
													]
												},
												"success": {
													"description": "Whether the API call was successful",
													"enum": [
														true
													],
													"example": true,
													"type": "boolean"
												}
											},
											"required": [
												"success",
												"errors",
												"messages",
												"result"
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"items": {},
													"nullable": true,
													"type": "array"
												},
												"result_info": {
													"properties": {
														"count": {
															"description": "Total number of results for the requested service",
															"example": 1,
															"type": "number"
														},
														"page": {
															"description": "Current page within paginated list of results",
															"example": 1,
															"type": "number"
														},
														"per_page": {
															"description": "Number of results per page of results",
															"example": 20,
															"type": "number"
														},
														"total_count": {
															"description": "Total results available without any search parameters",
															"example": 2000,
															"type": "number"
														}
													},
													"type": "object"
												}
											}
										}
									],
									"type": "object"
								},
								{
									"properties": {
										"result": {
											"items": {
												"properties": {
													"destination_conf": {
														"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
														"example": "s3://pcaps-bucket?region=us-east-1",
														"type": "string"
													},
													"filename": {
														"description": "The ownership challenge filename stored in the bucket.",
														"example": "ownership-challenge-9883874ecac311ec8475433579a6bf5f.txt",
														"type": "string"
													},
													"id": {
														"description": "The bucket ID associated with the packet captures API.",
														"example": "9883874ecac311ec8475433579a6bf5f",
														"maxLength": 32,
														"minLength": 32,
														"type": "string"
													},
													"status": {
														"description": "The status of the ownership challenge. Can be pending, success or failed.",
														"enum": [
															"pending",
															"success",
															"failed"
														],
														"example": "success",
														"type": "string"
													},
													"submitted": {
														"description": "The RFC 3339 timestamp when the bucket was added to packet captures API.",
														"example": "2020-01-01T08:00:00Z",
														"type": "string"
													},
													"validated": {
														"description": "The RFC 3339 timestamp when the bucket was validated.",
														"example": "2020-01-01T08:00:00Z",
														"type": "string"
													}
												},
												"required": [
													"id",
													"status",
													"submitted",
													"destination_conf",
													"filename"
												],
												"type": "object"
											},
											"nullable": true,
											"type": "array"
										}
									}
								}
							]
						}
					}
				},
				"description": "List PCAPs Bucket Ownership response"
			},
			"default": {
				"content": {
					"application/json": {
						"schema": {
							"oneOf": [
								{
									"allOf": [
										{
											"allOf": [
												{
													"properties": {
														"errors": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"messages": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"result": {
															"anyOf": [
																{
																	"type": "object"
																},
																{
																	"items": {},
																	"type": "array"
																},
																{
																	"type": "string"
																}
															]
														},
														"success": {
															"description": "Whether the API call was successful",
															"enum": [
																true
															],
															"example": true,
															"type": "boolean"
														}
													},
													"required": [
														"success",
														"errors",
														"messages",
														"result"
													],
													"type": "object"
												},
												{
													"properties": {
														"result": {
															"items": {},
															"nullable": true,
															"type": "array"
														},
														"result_info": {
															"properties": {
																"count": {
																	"description": "Total number of results for the requested service",
																	"example": 1,
																	"type": "number"
																},
																"page": {
																	"description": "Current page within paginated list of results",
																	"example": 1,
																	"type": "number"
																},
																"per_page": {
																	"description": "Number of results per page of results",
																	"example": 20,
																	"type": "number"
																},
																"total_count": {
																	"description": "Total results available without any search parameters",
																	"example": 2000,
																	"type": "number"
																}
															},
															"type": "object"
														}
													}
												}
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"items": {
														"properties": {
															"destination_conf": {
																"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
																"example": "s3://pcaps-bucket?region=us-east-1",
																"type": "string"
															},
															"filename": {
																"description": "The ownership challenge filename stored in the bucket.",
																"example": "ownership-challenge-9883874ecac311ec8475433579a6bf5f.txt",
																"type": "string"
															},
															"id": {
																"description": "The bucket ID associated with the packet captures API.",
																"example": "9883874ecac311ec8475433579a6bf5f",
																"maxLength": 32,
																"minLength": 32,
																"type": "string"
															},
															"status": {
																"description": "The status of the ownership challenge. Can be pending, success or failed.",
																"enum": [
																	"pending",
																	"success",
																	"failed"
																],
																"example": "success",
																"type": "string"
															},
															"submitted": {
																"description": "The RFC 3339 timestamp when the bucket was added to packet captures API.",
																"example": "2020-01-01T08:00:00Z",
																"type": "string"
															},
															"validated": {
																"description": "The RFC 3339 timestamp when the bucket was validated.",
																"example": "2020-01-01T08:00:00Z",
																"type": "string"
															}
														},
														"required": [
															"id",
															"status",
															"submitted",
															"destination_conf",
															"filename"
														],
														"type": "object"
													},
													"nullable": true,
													"type": "array"
												}
											}
										}
									]
								},
								{
									"properties": {
										"errors": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": [
												{
													"code": 7003,
													"message": "No route for the URI"
												}
											],
											"minLength": 1
										},
										"messages": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": []
										},
										"result": {
											"enum": [
												null
											],
											"nullable": true,
											"type": "object"
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												false
											],
											"example": false,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								}
							]
						}
					}
				},
				"description": "List PCAPs Bucket Ownership response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "List PCAPs Bucket Ownership",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API",
			"Magic Firewall Packet Captures - Read PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"POST /accounts/{account_id}/pcaps": {
		"description": "Create new PCAP request for account.",
		"operationId": "magic-pcap-collection-create-pcap-request",
		"parameters": [
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"requestBody": {
			"content": {
				"application/json": {
					"schema": {
						"anyOf": [
							{
								"properties": {
									"filter_v1": {
										"description": "The packet capture filter. When this field is empty, all packets are captured.",
										"properties": {
											"destination_address": {
												"description": "The destination IP address of the packet.",
												"example": "1.2.3.4",
												"type": "string",
												"x-auditable": true
											},
											"destination_port": {
												"description": "The destination port of the packet.",
												"example": 80,
												"type": "number",
												"x-auditable": true
											},
											"protocol": {
												"description": "The protocol number of the packet.",
												"example": 6,
												"type": "number",
												"x-auditable": true
											},
											"source_address": {
												"description": "The source IP address of the packet.",
												"example": "1.2.3.4",
												"type": "string",
												"x-auditable": true
											},
											"source_port": {
												"description": "The source port of the packet.",
												"example": 123,
												"type": "number",
												"x-auditable": true
											}
										},
										"type": "object"
									},
									"offset_time": {
										"description": "The RFC 3339 offset timestamp from which to query backwards for packets. Must be within the last 24h. When this field is empty, defaults to time of request.",
										"example": "2020-01-01T08:00:00Z",
										"format": "date-time",
										"type": "string",
										"x-auditable": true
									},
									"packet_limit": {
										"description": "The limit of packets contained in a packet capture.",
										"example": 10000,
										"maximum": 10000,
										"minimum": 1,
										"type": "number",
										"x-auditable": true
									},
									"system": {
										"description": "The system used to collect packet captures.",
										"enum": [
											"magic-transit"
										],
										"example": "magic-transit",
										"type": "string",
										"x-auditable": true
									},
									"time_limit": {
										"description": "The packet capture duration in seconds.",
										"example": 300,
										"maximum": 300,
										"minimum": 1,
										"type": "number",
										"x-auditable": true
									},
									"type": {
										"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
										"enum": [
											"simple",
											"full"
										],
										"example": "simple",
										"type": "string",
										"x-auditable": true
									}
								},
								"required": [
									"time_limit",
									"packet_limit",
									"type",
									"system"
								],
								"type": "object"
							},
							{
								"properties": {
									"byte_limit": {
										"description": "The maximum number of bytes to capture. This field only applies to `full` packet captures.",
										"example": 500000,
										"maximum": 1000000000,
										"minimum": 1,
										"type": "number",
										"x-auditable": true
									},
									"colo_name": {
										"description": "The name of the data center used for the packet capture. This can be a specific colo (ord02) or a multi-colo name (ORD). This field only applies to `full` packet captures.",
										"example": "ord02",
										"type": "string",
										"x-auditable": true
									},
									"destination_conf": {
										"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
										"example": "s3://pcaps-bucket?region=us-east-1",
										"type": "string"
									},
									"filter_v1": {
										"description": "The packet capture filter. When this field is empty, all packets are captured.",
										"properties": {
											"destination_address": {
												"description": "The destination IP address of the packet.",
												"example": "1.2.3.4",
												"type": "string",
												"x-auditable": true
											},
											"destination_port": {
												"description": "The destination port of the packet.",
												"example": 80,
												"type": "number",
												"x-auditable": true
											},
											"protocol": {
												"description": "The protocol number of the packet.",
												"example": 6,
												"type": "number",
												"x-auditable": true
											},
											"source_address": {
												"description": "The source IP address of the packet.",
												"example": "1.2.3.4",
												"type": "string",
												"x-auditable": true
											},
											"source_port": {
												"description": "The source port of the packet.",
												"example": 123,
												"type": "number",
												"x-auditable": true
											}
										},
										"type": "object"
									},
									"packet_limit": {
										"description": "The limit of packets contained in a packet capture.",
										"example": 10000,
										"maximum": 10000,
										"minimum": 1,
										"type": "number",
										"x-auditable": true
									},
									"system": {
										"description": "The system used to collect packet captures.",
										"enum": [
											"magic-transit"
										],
										"example": "magic-transit",
										"type": "string",
										"x-auditable": true
									},
									"time_limit": {
										"description": "The packet capture duration in seconds.",
										"example": 86400,
										"maximum": 86400,
										"minimum": 1,
										"type": "number",
										"x-auditable": true
									},
									"type": {
										"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
										"enum": [
											"simple",
											"full"
										],
										"example": "simple",
										"type": "string",
										"x-auditable": true
									}
								},
								"required": [
									"time_limit",
									"type",
									"system",
									"colo_name",
									"destination_conf"
								],
								"type": "object"
							}
						]
					}
				}
			},
			"required": true
		},
		"responses": {
			"200": {
				"content": {
					"application/json": {
						"schema": {
							"allOf": [
								{
									"allOf": [
										{
											"properties": {
												"errors": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"messages": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"items": {},
															"type": "array"
														},
														{
															"type": "string"
														}
													]
												},
												"success": {
													"description": "Whether the API call was successful",
													"enum": [
														true
													],
													"example": true,
													"type": "boolean"
												}
											},
											"required": [
												"success",
												"errors",
												"messages",
												"result"
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"type": "string"
														}
													]
												}
											}
										}
									],
									"type": "object"
								},
								{
									"properties": {
										"result": {
											"anyOf": [
												{
													"properties": {
														"filter_v1": {
															"description": "The packet capture filter. When this field is empty, all packets are captured.",
															"properties": {
																"destination_address": {
																	"description": "The destination IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"destination_port": {
																	"description": "The destination port of the packet.",
																	"example": 80,
																	"type": "number",
																	"x-auditable": true
																},
																"protocol": {
																	"description": "The protocol number of the packet.",
																	"example": 6,
																	"type": "number",
																	"x-auditable": true
																},
																"source_address": {
																	"description": "The source IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"source_port": {
																	"description": "The source port of the packet.",
																	"example": 123,
																	"type": "number",
																	"x-auditable": true
																}
															},
															"type": "object"
														},
														"id": {
															"description": "The ID for the packet capture.",
															"example": "66802ca5668e47a2b82c2e6746e45037",
															"maxLength": 32,
															"minLength": 32,
															"type": "string",
															"x-auditable": true
														},
														"offset_time": {
															"description": "The RFC 3339 offset timestamp from which to query backwards for packets. Must be within the last 24h. When this field is empty, defaults to time of request.",
															"example": "2020-01-01T08:00:00Z",
															"format": "date-time",
															"type": "string",
															"x-auditable": true
														},
														"status": {
															"description": "The status of the packet capture request.",
															"enum": [
																"unknown",
																"success",
																"pending",
																"running",
																"conversion_pending",
																"conversion_running",
																"complete",
																"failed"
															],
															"example": "success",
															"type": "string"
														},
														"submitted": {
															"description": "The RFC 3339 timestamp when the packet capture was created.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														},
														"system": {
															"description": "The system used to collect packet captures.",
															"enum": [
																"magic-transit"
															],
															"example": "magic-transit",
															"type": "string",
															"x-auditable": true
														},
														"time_limit": {
															"description": "The packet capture duration in seconds.",
															"example": 300,
															"maximum": 300,
															"minimum": 1,
															"type": "number",
															"x-auditable": true
														},
														"type": {
															"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
															"enum": [
																"simple",
																"full"
															],
															"example": "simple",
															"type": "string",
															"x-auditable": true
														}
													},
													"type": "object"
												},
												{
													"properties": {
														"byte_limit": {
															"description": "The maximum number of bytes to capture. This field only applies to `full` packet captures.",
															"example": 500000,
															"maximum": 1000000000,
															"minimum": 1,
															"type": "number",
															"x-auditable": true
														},
														"colo_name": {
															"description": "The name of the data center used for the packet capture. This can be a specific colo (ord02) or a multi-colo name (ORD). This field only applies to `full` packet captures.",
															"example": "ord02",
															"type": "string",
															"x-auditable": true
														},
														"destination_conf": {
															"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
															"example": "s3://pcaps-bucket?region=us-east-1",
															"type": "string"
														},
														"error_message": {
															"description": "An error message that describes why the packet capture failed. This field only applies to `full` packet captures.",
															"example": "No packets matched the filter in the time limit given. Please modify the filter or try again.",
															"type": "string"
														},
														"filter_v1": {
															"description": "The packet capture filter. When this field is empty, all packets are captured.",
															"properties": {
																"destination_address": {
																	"description": "The destination IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"destination_port": {
																	"description": "The destination port of the packet.",
																	"example": 80,
																	"type": "number",
																	"x-auditable": true
																},
																"protocol": {
																	"description": "The protocol number of the packet.",
																	"example": 6,
																	"type": "number",
																	"x-auditable": true
																},
																"source_address": {
																	"description": "The source IP address of the packet.",
																	"example": "1.2.3.4",
																	"type": "string",
																	"x-auditable": true
																},
																"source_port": {
																	"description": "The source port of the packet.",
																	"example": 123,
																	"type": "number",
																	"x-auditable": true
																}
															},
															"type": "object"
														},
														"id": {
															"description": "The ID for the packet capture.",
															"example": "66802ca5668e47a2b82c2e6746e45037",
															"maxLength": 32,
															"minLength": 32,
															"type": "string",
															"x-auditable": true
														},
														"packets_captured": {
															"description": "The number of packets captured.",
															"type": "integer"
														},
														"status": {
															"description": "The status of the packet capture request.",
															"enum": [
																"unknown",
																"success",
																"pending",
																"running",
																"conversion_pending",
																"conversion_running",
																"complete",
																"failed"
															],
															"example": "success",
															"type": "string"
														},
														"stop_requested": {
															"description": "The RFC 3339 timestamp when stopping the packet capture was requested. This field only applies to `full` packet captures.",
															"format": "date-time",
															"type": "string"
														},
														"submitted": {
															"description": "The RFC 3339 timestamp when the packet capture was created.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														},
														"system": {
															"description": "The system used to collect packet captures.",
															"enum": [
																"magic-transit"
															],
															"example": "magic-transit",
															"type": "string",
															"x-auditable": true
														},
														"time_limit": {
															"description": "The packet capture duration in seconds.",
															"example": 86400,
															"maximum": 86400,
															"minimum": 1,
															"type": "number",
															"x-auditable": true
														},
														"type": {
															"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
															"enum": [
																"simple",
																"full"
															],
															"example": "simple",
															"type": "string",
															"x-auditable": true
														}
													},
													"type": "object"
												}
											]
										}
									}
								}
							]
						}
					}
				},
				"description": "Create PCAP request response"
			},
			"default": {
				"content": {
					"application/json": {
						"schema": {
							"oneOf": [
								{
									"allOf": [
										{
											"allOf": [
												{
													"properties": {
														"errors": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"messages": {
															"example": [],
															"items": {
																"properties": {
																	"code": {
																		"minimum": 1000,
																		"type": "integer"
																	},
																	"message": {
																		"type": "string"
																	}
																},
																"required": [
																	"code",
																	"message"
																],
																"type": "object",
																"uniqueItems": true
															},
															"type": "array"
														},
														"result": {
															"anyOf": [
																{
																	"type": "object"
																},
																{
																	"items": {},
																	"type": "array"
																},
																{
																	"type": "string"
																}
															]
														},
														"success": {
															"description": "Whether the API call was successful",
															"enum": [
																true
															],
															"example": true,
															"type": "boolean"
														}
													},
													"required": [
														"success",
														"errors",
														"messages",
														"result"
													],
													"type": "object"
												},
												{
													"properties": {
														"result": {
															"anyOf": [
																{
																	"type": "object"
																},
																{
																	"type": "string"
																}
															]
														}
													}
												}
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"anyOf": [
														{
															"properties": {
																"filter_v1": {
																	"description": "The packet capture filter. When this field is empty, all packets are captured.",
																	"properties": {
																		"destination_address": {
																			"description": "The destination IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"destination_port": {
																			"description": "The destination port of the packet.",
																			"example": 80,
																			"type": "number",
																			"x-auditable": true
																		},
																		"protocol": {
																			"description": "The protocol number of the packet.",
																			"example": 6,
																			"type": "number",
																			"x-auditable": true
																		},
																		"source_address": {
																			"description": "The source IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"source_port": {
																			"description": "The source port of the packet.",
																			"example": 123,
																			"type": "number",
																			"x-auditable": true
																		}
																	},
																	"type": "object"
																},
																"id": {
																	"description": "The ID for the packet capture.",
																	"example": "66802ca5668e47a2b82c2e6746e45037",
																	"maxLength": 32,
																	"minLength": 32,
																	"type": "string",
																	"x-auditable": true
																},
																"offset_time": {
																	"description": "The RFC 3339 offset timestamp from which to query backwards for packets. Must be within the last 24h. When this field is empty, defaults to time of request.",
																	"example": "2020-01-01T08:00:00Z",
																	"format": "date-time",
																	"type": "string",
																	"x-auditable": true
																},
																"status": {
																	"description": "The status of the packet capture request.",
																	"enum": [
																		"unknown",
																		"success",
																		"pending",
																		"running",
																		"conversion_pending",
																		"conversion_running",
																		"complete",
																		"failed"
																	],
																	"example": "success",
																	"type": "string"
																},
																"submitted": {
																	"description": "The RFC 3339 timestamp when the packet capture was created.",
																	"example": "2020-01-01T08:00:00Z",
																	"type": "string"
																},
																"system": {
																	"description": "The system used to collect packet captures.",
																	"enum": [
																		"magic-transit"
																	],
																	"example": "magic-transit",
																	"type": "string",
																	"x-auditable": true
																},
																"time_limit": {
																	"description": "The packet capture duration in seconds.",
																	"example": 300,
																	"maximum": 300,
																	"minimum": 1,
																	"type": "number",
																	"x-auditable": true
																},
																"type": {
																	"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																	"enum": [
																		"simple",
																		"full"
																	],
																	"example": "simple",
																	"type": "string",
																	"x-auditable": true
																}
															},
															"type": "object"
														},
														{
															"properties": {
																"byte_limit": {
																	"description": "The maximum number of bytes to capture. This field only applies to `full` packet captures.",
																	"example": 500000,
																	"maximum": 1000000000,
																	"minimum": 1,
																	"type": "number",
																	"x-auditable": true
																},
																"colo_name": {
																	"description": "The name of the data center used for the packet capture. This can be a specific colo (ord02) or a multi-colo name (ORD). This field only applies to `full` packet captures.",
																	"example": "ord02",
																	"type": "string",
																	"x-auditable": true
																},
																"destination_conf": {
																	"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
																	"example": "s3://pcaps-bucket?region=us-east-1",
																	"type": "string"
																},
																"error_message": {
																	"description": "An error message that describes why the packet capture failed. This field only applies to `full` packet captures.",
																	"example": "No packets matched the filter in the time limit given. Please modify the filter or try again.",
																	"type": "string"
																},
																"filter_v1": {
																	"description": "The packet capture filter. When this field is empty, all packets are captured.",
																	"properties": {
																		"destination_address": {
																			"description": "The destination IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"destination_port": {
																			"description": "The destination port of the packet.",
																			"example": 80,
																			"type": "number",
																			"x-auditable": true
																		},
																		"protocol": {
																			"description": "The protocol number of the packet.",
																			"example": 6,
																			"type": "number",
																			"x-auditable": true
																		},
																		"source_address": {
																			"description": "The source IP address of the packet.",
																			"example": "1.2.3.4",
																			"type": "string",
																			"x-auditable": true
																		},
																		"source_port": {
																			"description": "The source port of the packet.",
																			"example": 123,
																			"type": "number",
																			"x-auditable": true
																		}
																	},
																	"type": "object"
																},
																"id": {
																	"description": "The ID for the packet capture.",
																	"example": "66802ca5668e47a2b82c2e6746e45037",
																	"maxLength": 32,
																	"minLength": 32,
																	"type": "string",
																	"x-auditable": true
																},
																"packets_captured": {
																	"description": "The number of packets captured.",
																	"type": "integer"
																},
																"status": {
																	"description": "The status of the packet capture request.",
																	"enum": [
																		"unknown",
																		"success",
																		"pending",
																		"running",
																		"conversion_pending",
																		"conversion_running",
																		"complete",
																		"failed"
																	],
																	"example": "success",
																	"type": "string"
																},
																"stop_requested": {
																	"description": "The RFC 3339 timestamp when stopping the packet capture was requested. This field only applies to `full` packet captures.",
																	"format": "date-time",
																	"type": "string"
																},
																"submitted": {
																	"description": "The RFC 3339 timestamp when the packet capture was created.",
																	"example": "2020-01-01T08:00:00Z",
																	"type": "string"
																},
																"system": {
																	"description": "The system used to collect packet captures.",
																	"enum": [
																		"magic-transit"
																	],
																	"example": "magic-transit",
																	"type": "string",
																	"x-auditable": true
																},
																"time_limit": {
																	"description": "The packet capture duration in seconds.",
																	"example": 86400,
																	"maximum": 86400,
																	"minimum": 1,
																	"type": "number",
																	"x-auditable": true
																},
																"type": {
																	"description": "The type of packet capture. `Simple` captures sampled packets, and `full` captures entire payloads and non-sampled packets.",
																	"enum": [
																		"simple",
																		"full"
																	],
																	"example": "simple",
																	"type": "string",
																	"x-auditable": true
																}
															},
															"type": "object"
														}
													]
												}
											}
										}
									]
								},
								{
									"properties": {
										"errors": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": [
												{
													"code": 7003,
													"message": "No route for the URI"
												}
											],
											"minLength": 1
										},
										"messages": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": []
										},
										"result": {
											"enum": [
												null
											],
											"nullable": true,
											"type": "object"
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												false
											],
											"example": false,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								}
							]
						}
					}
				},
				"description": "Create PCAP request response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "Create PCAP request",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"POST /accounts/{account_id}/pcaps/ownership": {
		"description": "Adds an AWS or GCP bucket to use with full packet captures.",
		"operationId": "magic-pcap-collection-add-buckets-for-full-packet-captures",
		"parameters": [
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"requestBody": {
			"content": {
				"application/json": {
					"schema": {
						"properties": {
							"destination_conf": {
								"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
								"example": "s3://pcaps-bucket?region=us-east-1",
								"type": "string"
							}
						},
						"required": [
							"destination_conf"
						],
						"type": "object"
					}
				}
			},
			"required": true
		},
		"responses": {
			"200": {
				"content": {
					"application/json": {
						"schema": {
							"allOf": [
								{
									"properties": {
										"errors": {
											"example": [],
											"items": {
												"properties": {
													"code": {
														"minimum": 1000,
														"type": "integer"
													},
													"message": {
														"type": "string"
													}
												},
												"required": [
													"code",
													"message"
												],
												"type": "object",
												"uniqueItems": true
											},
											"type": "array"
										},
										"messages": {
											"example": [],
											"items": {
												"properties": {
													"code": {
														"minimum": 1000,
														"type": "integer"
													},
													"message": {
														"type": "string"
													}
												},
												"required": [
													"code",
													"message"
												],
												"type": "object",
												"uniqueItems": true
											},
											"type": "array"
										},
										"result": {
											"anyOf": [
												{
													"type": "object"
												},
												{
													"items": {},
													"type": "array"
												},
												{
													"type": "string"
												}
											]
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												true
											],
											"example": true,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								},
								{
									"properties": {
										"result": {
											"properties": {
												"destination_conf": {
													"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
													"example": "s3://pcaps-bucket?region=us-east-1",
													"type": "string"
												},
												"filename": {
													"description": "The ownership challenge filename stored in the bucket.",
													"example": "ownership-challenge-9883874ecac311ec8475433579a6bf5f.txt",
													"type": "string"
												},
												"id": {
													"description": "The bucket ID associated with the packet captures API.",
													"example": "9883874ecac311ec8475433579a6bf5f",
													"maxLength": 32,
													"minLength": 32,
													"type": "string"
												},
												"status": {
													"description": "The status of the ownership challenge. Can be pending, success or failed.",
													"enum": [
														"pending",
														"success",
														"failed"
													],
													"example": "success",
													"type": "string"
												},
												"submitted": {
													"description": "The RFC 3339 timestamp when the bucket was added to packet captures API.",
													"example": "2020-01-01T08:00:00Z",
													"type": "string"
												},
												"validated": {
													"description": "The RFC 3339 timestamp when the bucket was validated.",
													"example": "2020-01-01T08:00:00Z",
													"type": "string"
												}
											},
											"required": [
												"id",
												"status",
												"submitted",
												"destination_conf",
												"filename"
											],
											"type": "object"
										}
									}
								}
							]
						}
					}
				},
				"description": "Add buckets for full packet captures response"
			},
			"default": {
				"content": {
					"application/json": {
						"schema": {
							"oneOf": [
								{
									"allOf": [
										{
											"properties": {
												"errors": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"messages": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"items": {},
															"type": "array"
														},
														{
															"type": "string"
														}
													]
												},
												"success": {
													"description": "Whether the API call was successful",
													"enum": [
														true
													],
													"example": true,
													"type": "boolean"
												}
											},
											"required": [
												"success",
												"errors",
												"messages",
												"result"
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"properties": {
														"destination_conf": {
															"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
															"example": "s3://pcaps-bucket?region=us-east-1",
															"type": "string"
														},
														"filename": {
															"description": "The ownership challenge filename stored in the bucket.",
															"example": "ownership-challenge-9883874ecac311ec8475433579a6bf5f.txt",
															"type": "string"
														},
														"id": {
															"description": "The bucket ID associated with the packet captures API.",
															"example": "9883874ecac311ec8475433579a6bf5f",
															"maxLength": 32,
															"minLength": 32,
															"type": "string"
														},
														"status": {
															"description": "The status of the ownership challenge. Can be pending, success or failed.",
															"enum": [
																"pending",
																"success",
																"failed"
															],
															"example": "success",
															"type": "string"
														},
														"submitted": {
															"description": "The RFC 3339 timestamp when the bucket was added to packet captures API.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														},
														"validated": {
															"description": "The RFC 3339 timestamp when the bucket was validated.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														}
													},
													"required": [
														"id",
														"status",
														"submitted",
														"destination_conf",
														"filename"
													],
													"type": "object"
												}
											}
										}
									]
								},
								{
									"properties": {
										"errors": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": [
												{
													"code": 7003,
													"message": "No route for the URI"
												}
											],
											"minLength": 1
										},
										"messages": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": []
										},
										"result": {
											"enum": [
												null
											],
											"nullable": true,
											"type": "object"
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												false
											],
											"example": false,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								}
							]
						}
					}
				},
				"description": "Add buckets for full packet captures response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "Add buckets for full packet captures",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"POST /accounts/{account_id}/pcaps/ownership/validate": {
		"description": "Validates buckets added to the packet captures API.",
		"operationId": "magic-pcap-collection-validate-buckets-for-full-packet-captures",
		"parameters": [
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"requestBody": {
			"content": {
				"application/json": {
					"schema": {
						"properties": {
							"destination_conf": {
								"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
								"example": "s3://pcaps-bucket?region=us-east-1",
								"type": "string"
							},
							"ownership_challenge": {
								"description": "The ownership challenge filename stored in the bucket.",
								"example": "ownership-challenge-9883874ecac311ec8475433579a6bf5f.txt",
								"type": "string"
							}
						},
						"required": [
							"destination_conf",
							"ownership_challenge"
						],
						"type": "object"
					}
				}
			},
			"required": true
		},
		"responses": {
			"200": {
				"content": {
					"application/json": {
						"schema": {
							"allOf": [
								{
									"properties": {
										"errors": {
											"example": [],
											"items": {
												"properties": {
													"code": {
														"minimum": 1000,
														"type": "integer"
													},
													"message": {
														"type": "string"
													}
												},
												"required": [
													"code",
													"message"
												],
												"type": "object",
												"uniqueItems": true
											},
											"type": "array"
										},
										"messages": {
											"example": [],
											"items": {
												"properties": {
													"code": {
														"minimum": 1000,
														"type": "integer"
													},
													"message": {
														"type": "string"
													}
												},
												"required": [
													"code",
													"message"
												],
												"type": "object",
												"uniqueItems": true
											},
											"type": "array"
										},
										"result": {
											"anyOf": [
												{
													"type": "object"
												},
												{
													"items": {},
													"type": "array"
												},
												{
													"type": "string"
												}
											]
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												true
											],
											"example": true,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								},
								{
									"properties": {
										"result": {
											"properties": {
												"destination_conf": {
													"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
													"example": "s3://pcaps-bucket?region=us-east-1",
													"type": "string"
												},
												"filename": {
													"description": "The ownership challenge filename stored in the bucket.",
													"example": "ownership-challenge-9883874ecac311ec8475433579a6bf5f.txt",
													"type": "string"
												},
												"id": {
													"description": "The bucket ID associated with the packet captures API.",
													"example": "9883874ecac311ec8475433579a6bf5f",
													"maxLength": 32,
													"minLength": 32,
													"type": "string"
												},
												"status": {
													"description": "The status of the ownership challenge. Can be pending, success or failed.",
													"enum": [
														"pending",
														"success",
														"failed"
													],
													"example": "success",
													"type": "string"
												},
												"submitted": {
													"description": "The RFC 3339 timestamp when the bucket was added to packet captures API.",
													"example": "2020-01-01T08:00:00Z",
													"type": "string"
												},
												"validated": {
													"description": "The RFC 3339 timestamp when the bucket was validated.",
													"example": "2020-01-01T08:00:00Z",
													"type": "string"
												}
											},
											"required": [
												"id",
												"status",
												"submitted",
												"destination_conf",
												"filename"
											],
											"type": "object"
										}
									}
								}
							]
						}
					}
				},
				"description": "Validate buckets for full packet captures response"
			},
			"default": {
				"content": {
					"application/json": {
						"schema": {
							"oneOf": [
								{
									"allOf": [
										{
											"properties": {
												"errors": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"messages": {
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												},
												"result": {
													"anyOf": [
														{
															"type": "object"
														},
														{
															"items": {},
															"type": "array"
														},
														{
															"type": "string"
														}
													]
												},
												"success": {
													"description": "Whether the API call was successful",
													"enum": [
														true
													],
													"example": true,
													"type": "boolean"
												}
											},
											"required": [
												"success",
												"errors",
												"messages",
												"result"
											],
											"type": "object"
										},
										{
											"properties": {
												"result": {
													"properties": {
														"destination_conf": {
															"description": "The full URI for the bucket. This field only applies to `full` packet captures.",
															"example": "s3://pcaps-bucket?region=us-east-1",
															"type": "string"
														},
														"filename": {
															"description": "The ownership challenge filename stored in the bucket.",
															"example": "ownership-challenge-9883874ecac311ec8475433579a6bf5f.txt",
															"type": "string"
														},
														"id": {
															"description": "The bucket ID associated with the packet captures API.",
															"example": "9883874ecac311ec8475433579a6bf5f",
															"maxLength": 32,
															"minLength": 32,
															"type": "string"
														},
														"status": {
															"description": "The status of the ownership challenge. Can be pending, success or failed.",
															"enum": [
																"pending",
																"success",
																"failed"
															],
															"example": "success",
															"type": "string"
														},
														"submitted": {
															"description": "The RFC 3339 timestamp when the bucket was added to packet captures API.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														},
														"validated": {
															"description": "The RFC 3339 timestamp when the bucket was validated.",
															"example": "2020-01-01T08:00:00Z",
															"type": "string"
														}
													},
													"required": [
														"id",
														"status",
														"submitted",
														"destination_conf",
														"filename"
													],
													"type": "object"
												}
											}
										}
									]
								},
								{
									"properties": {
										"errors": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": [
												{
													"code": 7003,
													"message": "No route for the URI"
												}
											],
											"minLength": 1
										},
										"messages": {
											"allOf": [
												{
													"example": [],
													"items": {
														"properties": {
															"code": {
																"minimum": 1000,
																"type": "integer"
															},
															"message": {
																"type": "string"
															}
														},
														"required": [
															"code",
															"message"
														],
														"type": "object",
														"uniqueItems": true
													},
													"type": "array"
												}
											],
											"example": []
										},
										"result": {
											"enum": [
												null
											],
											"nullable": true,
											"type": "object"
										},
										"success": {
											"description": "Whether the API call was successful",
											"enum": [
												false
											],
											"example": false,
											"type": "boolean"
										}
									},
									"required": [
										"success",
										"errors",
										"messages",
										"result"
									],
									"type": "object"
								}
							]
						}
					}
				},
				"description": "Validate buckets for full packet captures response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "Validate buckets for full packet captures",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	},
	"PUT /accounts/{account_id}/pcaps/{pcap_id}/stop": {
		"description": "Stop full PCAP",
		"operationId": "magic-pcap-collection-stop-full-pcap",
		"parameters": [
			{
				"in": "path",
				"name": "pcap_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			},
			{
				"in": "path",
				"name": "account_id",
				"required": true,
				"schema": {
					"description": "Identifier",
					"example": "023e105f4ecef8ad9ca31a8372d0c353",
					"maxLength": 32,
					"readOnly": true,
					"type": "string"
				}
			}
		],
		"responses": {
			"204": {
				"description": "Stop full PCAP response"
			},
			"default": {
				"content": {
					"application/json": {
						"schema": {
							"properties": {
								"errors": {
									"allOf": [
										{
											"example": [],
											"items": {
												"properties": {
													"code": {
														"minimum": 1000,
														"type": "integer"
													},
													"message": {
														"type": "string"
													}
												},
												"required": [
													"code",
													"message"
												],
												"type": "object",
												"uniqueItems": true
											},
											"type": "array"
										}
									],
									"example": [
										{
											"code": 7003,
											"message": "No route for the URI"
										}
									],
									"minLength": 1
								},
								"messages": {
									"allOf": [
										{
											"example": [],
											"items": {
												"properties": {
													"code": {
														"minimum": 1000,
														"type": "integer"
													},
													"message": {
														"type": "string"
													}
												},
												"required": [
													"code",
													"message"
												],
												"type": "object",
												"uniqueItems": true
											},
											"type": "array"
										}
									],
									"example": []
								},
								"result": {
									"enum": [
										null
									],
									"nullable": true,
									"type": "object"
								},
								"success": {
									"description": "Whether the API call was successful",
									"enum": [
										false
									],
									"example": false,
									"type": "boolean"
								}
							},
							"required": [
								"success",
								"errors",
								"messages",
								"result"
							],
							"type": "object"
						}
					}
				},
				"description": "Stop full PCAP response failure"
			}
		},
		"security": [
			{
				"api_email": [],
				"api_key": []
			}
		],
		"summary": "Stop full PCAP",
		"tags": [
			"Magic PCAP collection"
		],
		"x-api-token-group": [
			"Magic Firewall Packet Captures - Write PCAPs API"
		],
		"x-cfPlanAvailability": {
			"business": false,
			"enterprise": true,
			"free": false,
			"pro": false
		}
	}
}